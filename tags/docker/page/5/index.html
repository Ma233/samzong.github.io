<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">5 篇博文 含有标签「Docker」 | samzong</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://samzong.me/tags/docker/page/5"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" property="og:title" content="5 篇博文 含有标签「Docker」 | samzong"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://samzong.me/tags/docker/page/5"><link data-rh="true" rel="alternate" href="https://samzong.me/tags/docker/page/5" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://samzong.me/en/tags/docker/page/5" hreflang="en"><link data-rh="true" rel="alternate" href="https://samzong.me/tags/docker/page/5" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="samzong RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="samzong Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="samzong JSON Feed"><link rel="stylesheet" href="/assets/css/styles.94db4b8a.css">
<script src="/assets/js/runtime~main.ca39bb6c.js" defer="defer"></script>
<script src="/assets/js/main.9244a3ed.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="https://schema.org/Blog"><header class="margin-bottom--xl"><h1>5 篇博文 含有标签「Docker」</h1><a href="/tags">查看所有标签</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="1. 安装 CentOS 7.x"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2016/08/02/HowTo-Use-Docker-create-a-Tomcat-Project">HowTo Use Docker create a Tomcat Project</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-08-02T15:44:20.000Z" itemprop="datePublished">2016年8月2日</time></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-安装-centos-7x">1. 安装 CentOS 7.x<a href="#1-安装-centos-7x" class="hash-link" aria-label="1. 安装 CentOS 7.x的直接链接" title="1. 安装 CentOS 7.x的直接链接">​</a></h2>
<p>略。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-安装-docker">2. 安装 docker<a href="#2-安装-docker" class="hash-link" aria-label="2. 安装 docker的直接链接" title="2. 安装 docker的直接链接">​</a></h2>
<p>详见： <a href="https://samzong.me/2016/07/07/HowTo-Install-Docker-on-CentOS-6-x/" target="_blank" rel="noopener noreferrer">How to Install Docker on CentOS 6.x</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-基础-docker-命令">3. 基础 docker 命令<a href="#3-基础-docker-命令" class="hash-link" aria-label="3. 基础 docker 命令的直接链接" title="3. 基础 docker 命令的直接链接">​</a></h2>
<p>获取 centos6 docker 镜像</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@docker ~ </span><span class="token function" style="color:rgb(80, 250, 123)">docker</span><span class="token plain"> pull centos6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Using default tag: latest</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">latest: Pulling from library/centos:centos6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">43db9dbdcb30: Downloading </span><span class="token number">41.14</span><span class="token plain"> MB/49.33 MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">43db9dbdcb30: Pull complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2dc64e8f8d4f: Pull complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">670a583e1b50: Pull complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">183b0bfcd10e: Pull complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Digest: sha256:c6674c44c6439673bf56536c1a15916639c47ea04c3d6296c5df938add67b54b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Status: Downloaded newer image </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> centso:centos6</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看当前服务器上的 docker 镜像</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos6-visionet    latest              aeed37612ecb        </span><span class="token number">6</span><span class="token plain"> hours ago         </span><span class="token number">1.916</span><span class="token plain"> GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6             a3c09d36ab4a        </span><span class="token number">2</span><span class="token plain"> days ago          </span><span class="token number">194.6</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">registry            latest              c6c14b3960bd        </span><span class="token number">3</span><span class="token plain"> days ago          </span><span class="token number">33.28</span><span class="token plain"> MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查找 docker 镜像</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker search centos:centos6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                                     DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">imagine10255/centos6-lnmp-php56          centos6-lnmp-php56                              </span><span class="token number">10</span><span class="token plain">                   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lemonbar/centos6-ssh                     Installed openssh-server on centos6, defau</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.   </span><span class="token number">7</span><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sergeyzh/centos6-nginx                                                                   </span><span class="token number">2</span><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">guyton/centos6                           From official centos6 container with full </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.   </span><span class="token number">2</span><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">paijp/centos6-apache-php-sqlite2         php5.3.3 with sqlite2 and apache on CentOS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.   </span><span class="token number">1</span><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">edrans/centos6                                                                           </span><span class="token number">1</span><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mohri1219/centos6.7-ruby2.2.2-mysql5.6   centos6.7-ruby2.2.2-mysql5.6                    </span><span class="token number">1</span><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>删除 centos6 docker 镜像</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker rmi IMAGES_NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker rmi centos:centos6</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>报错如下</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Error response from daemon: conflict: unable to remove repository reference </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;centos&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">must force</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> - container 705a30cbc002 is using its referenced image 42118e3df429</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这是因为之间的运行的进程没有清楚导致该 images 正在使用中，使用一下命令查看占有的进程</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker ps -a ＃ 查看所有的docker进程</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CONTAINER ID        IMAGE               COMMAND               CREATED             STATUS                     PORTS               NAMES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">705a30cbc002        centos:centos6              </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/bash&quot;</span><span class="token plain">           </span><span class="token number">6</span><span class="token plain"> minutes ago       Exited </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">6</span><span class="token plain"> minutes ago                       centos6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker rm 705a30cbc002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">705a30cbc002</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker rmi centos:centos6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Untagged: centos:centos6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Deleted: sha256:42118e3df429f09ca581a9deb3df274601930e428e452f7e4e9f1833c56a100a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Deleted: sha256:d72d0199021776e77ac14a764a3decd156e9f6f18b37e25b867b0f1ca42fb3d9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Deleted: sha256:fb178c6cea1453d089ce033b96eba0efdb42274138e042517ea2d5ea7bb51665</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Deleted: sha256:8945af30572845a904adce2aeaf73402c842d86e99e8f10688b25cb27834110b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Deleted: sha256:ea9f151abb7e06353e73172dad421235611d4f6d0560ec95db26e0dc240642c1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-运行一个-docker-镜像">4. 运行一个 docker 镜像<a href="#4-运行一个-docker-镜像" class="hash-link" aria-label="4. 运行一个 docker 镜像的直接链接" title="4. 运行一个 docker 镜像的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="进入交互式程序">进入交互式程序<a href="#进入交互式程序" class="hash-link" aria-label="进入交互式程序的直接链接" title="进入交互式程序的直接链接">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker run  -it centos:centos6 /bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@c1d190f95562 /</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># cat /etc/redhat-release</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CentOS release </span><span class="token number">6.8</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Final</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Install openssh-server and httpd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@d8c122dbe09d:/</span><span class="token comment" style="color:rgb(98, 114, 164)"># yum install -y openssh-sever httpd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@d8c122dbe09d:/</span><span class="token comment" style="color:rgb(98, 114, 164)"># exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 注意当你执行 exit，从容器之中退出时，容器也会随着关闭，这时如果还继续执行上条命令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 你会发现之前所有的操作都被还原，因为相对于 docker，又是新开了一个进程</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 在 exit 退出之后，使用一下命令查看上次提交，然后 commit 修改，便可保存之前的修改</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker ps -l</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker commit c1d190f95562 centos:centos6-httpd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sha256:77eb12e36c7bbe9ef874555b1873019022b5258740aa731627e2cd6fa749c325</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6-httpd       77eb12e36c7b        </span><span class="token number">3</span><span class="token plain"> seconds ago       </span><span class="token number">290.3</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos6-visionet    latest              aeed37612ecb        </span><span class="token number">6</span><span class="token plain"> hours ago         </span><span class="token number">1.916</span><span class="token plain"> GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6             a3c09d36ab4a        </span><span class="token number">2</span><span class="token plain"> days ago          </span><span class="token number">194.6</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">registry            latest              c6c14b3960bd        </span><span class="token number">3</span><span class="token plain"> days ago          </span><span class="token number">33.28</span><span class="token plain"> MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-编辑-dockerfile">5. 编辑 Dockerfile<a href="#5-编辑-dockerfile" class="hash-link" aria-label="5. 编辑 Dockerfile的直接链接" title="5. 编辑 Dockerfile的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># dockfile 的第一行一定是 FROM，指定了父镜像</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM centos:centos6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># RUN 指的是运行的命令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN yum </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-y</span><span class="token plain"> epel-release</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN yum </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-y</span><span class="token plain"> bash-completion</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN yum </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-y</span><span class="token plain"> openssh-server openssh-client </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s/UsePAM yes/UsePAM no/g&#x27;</span><span class="token plain"> /etc/ssh/sshd_config</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 增加一个用户，并赋予 sudo 权限</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token function" style="color:rgb(80, 250, 123)">useradd</span><span class="token plain"> visionet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;visionet:visionet&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> chpasswd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;visionet   ALL=(ALL)       ALL&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> /etc/sudoers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">＃ 注意，如果没有执行一下两个命令，sshd 是无法远程登陆的</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN ssh-keygen </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-t</span><span class="token plain"> dsa </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> /etc/ssh/ssh_host_dsa_key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN ssh-keygen </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-t</span><span class="token plain"> rsa </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> /etc/ssh/ssh_host_rsa_key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">＃ EXPOSE </span><span class="token number">22</span><span class="token plain">，将 </span><span class="token number">22</span><span class="token plain"> 端口暴露出来，方便 </span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> 远程连接</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> /var/run/sshd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EXPOSE </span><span class="token number">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">＃ CMD 为系统内部执行命令</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CMD </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/usr/sbin/sshd&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-D&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-生成自定义-docker-镜像">6. 生成自定义 docker 镜像<a href="#6-生成自定义-docker-镜像" class="hash-link" aria-label="6. 生成自定义 docker 镜像的直接链接" title="6. 生成自定义 docker 镜像的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># build 编译镜像</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker build -f dockerfile3 -t centos:centos6-ssh .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sending build context to Docker daemon </span><span class="token number">44.54</span><span class="token plain"> kB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">1</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> FROM centos:centos6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> a3c09d36ab4a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">2</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN yum </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-y</span><span class="token plain"> epel-release</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> 04d81f280a63</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">3</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN yum </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-y</span><span class="token plain"> bash-completion</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> 5ca26894dc9d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">4</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN yum </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-y</span><span class="token plain"> openssh-server openssh-client </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> 42278450311e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">5</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s/UsePAM yes/UsePAM no/g&#x27;</span><span class="token plain"> /etc/ssh/sshd_config</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> db35bef562a2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">6</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN </span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> dc9f2b82e198</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">7</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN </span><span class="token function" style="color:rgb(80, 250, 123)">useradd</span><span class="token plain"> visionet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> 06c574a51755</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">8</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;visionet:visionet&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> chpasswd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> 03412f053d04</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">9</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;visionet   ALL=(ALL)       ALL&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> /etc/sudoers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> bf8476812a62</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">10</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN ssh-keygen </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-t</span><span class="token plain"> dsa </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> /etc/ssh/ssh_host_dsa_key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> 2314cce75171</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">11</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN ssh-keygen </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-t</span><span class="token plain"> rsa </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> /etc/ssh/ssh_host_rsa_key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> 99304cd9ac15</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">12</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> RUN </span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> /var/run/sshd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> f87283751553</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">13</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> EXPOSE </span><span class="token number">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> 56c41202dcb9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Step </span><span class="token number">14</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> CMD /usr/sbin/sshd </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-D</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ---</span><span class="token operator">&gt;</span><span class="token plain"> d6dccb483fa6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Successfully built d6dccb483fa6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6-ssh         d6dccb483fa6        </span><span class="token number">2</span><span class="token plain"> minutes ago         </span><span class="token number">363</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6-httpd       77eb12e36c7b        </span><span class="token number">6</span><span class="token plain"> minutes ago       </span><span class="token number">290.3</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos6-visionet    latest              aeed37612ecb        </span><span class="token number">6</span><span class="token plain"> hours ago         </span><span class="token number">1.916</span><span class="token plain"> GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6             a3c09d36ab4a        </span><span class="token number">2</span><span class="token plain"> days ago          </span><span class="token number">194.6</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">registry            latest              c6c14b3960bd        </span><span class="token number">3</span><span class="token plain"> days ago          </span><span class="token number">33.28</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 后台运行 docker 容器，并指定 nat 端口转发</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker run -d -p 2222:22 -P --name=sshd centos:centos6-ssh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">b4211f7a304d9e34b72b510230be2c7a76b276886b488f08f3e12896a4d3c172</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-ssh-登陆到-docker-容器内部署项目环境">7. ssh 登陆到 docker 容器内，部署项目环境<a href="#7-ssh-登陆到-docker-容器内部署项目环境" class="hash-link" aria-label="7. ssh 登陆到 docker 容器内，部署项目环境的直接链接" title="7. ssh 登陆到 docker 容器内，部署项目环境的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># inspect 查看 docker 容器 IP 地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker inspect sshd | grep IPAddress</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ssh visionet@172.17.0.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">visionet@172.17.0.2&#x27;s password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">visionet@b4211f7a304d ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">$</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Install mysql</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Install tomcat server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">visionet@b4211f7a304d ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker stop sshd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sshd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker ps -l</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CONTAINER ID        IMAGE                COMMAND               CREATED             STATUS                       PORTS               NAMES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">b4211f7a304d        centos:centos6-ssh   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/usr/sbin/sshd -D&quot;</span><span class="token plain">   </span><span class="token number">6</span><span class="token plain"> minutes ago       Exited </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">255</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"> seconds ago                       sshd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker commit b4211f7a304d centos:centos6-tomcat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sha256:b4f114d5484822d9a3ddf1100b76b460985ba5e5d31e936570e8d7dbd8df282c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@docker ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6-tomcat      b4f114d54848        </span><span class="token number">4</span><span class="token plain"> seconds ago       </span><span class="token number">363.1</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6-httpd       77eb12e36c7b        </span><span class="token number">15</span><span class="token plain"> minutes ago      </span><span class="token number">290.3</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos6-visionet    latest              aeed37612ecb        </span><span class="token number">7</span><span class="token plain"> hours ago         </span><span class="token number">1.916</span><span class="token plain"> GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6-ssh         d6dccb483fa6        </span><span class="token number">9</span><span class="token plain"> hours ago         </span><span class="token number">363</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos              centos6             a3c09d36ab4a        </span><span class="token number">2</span><span class="token plain"> days ago          </span><span class="token number">194.6</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">registry            latest              c6c14b3960bd        </span><span class="token number">3</span><span class="token plain"> days ago          </span><span class="token number">33.28</span><span class="token plain"> MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-推送-centos-到私有-docker-仓库">8. 推送 centos<!-- -->:centos6-tomcat<!-- --> 到私有 docker 仓库<a href="#8-推送-centos-到私有-docker-仓库" class="hash-link" aria-label="8-推送-centos-到私有-docker-仓库的直接链接" title="8-推送-centos-到私有-docker-仓库的直接链接">​</a></h2>
<blockquote>
<p>docker push</p>
</blockquote></div><footer class="row docusaurus-mt-lg"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/docker">Docker</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="博文列表分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/tags/docker/page/4"><div class="pagination-nav__label">较新的博文</div></a></nav></main></div></div></div></div>
</body>
</html>