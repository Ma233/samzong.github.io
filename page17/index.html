
<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Blog">
  <head>
    <meta charset="utf-8">
	<link rel="manifest" href="/static/pwa/manifest.json">
	<title> Home | 船长的课记 </title>
    
		
    <meta name="author" content="船长">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="theme-color" content="#2196F3">
	<meta name="google-site-verification" content="puZt0ZyqB-t67BYdYAgLUyIPBeismG68J0dmEc01QeY" />

	
    <script>
		if ('serviceWorker' in navigator) {
			window.addEventListener('load', function () {
				navigator.serviceWorker
										.register('/sw.js')
										.then(function(registration) {
											console.log("Successfully registered service worker", registration.scope);
										}).catch(function(err) {
											console.log("Service worker registration failed: ", err);
										});
				//navigator.serviceWorker.ready always resolve
				navigator.serviceWorker.ready.then(function (registration) {
					console.log('Service worker successfully registered on scope', registration.scope);
				});
			});
		}
    </script>
	<script type="text/javascript" src="/assets/themes/evjekylltheme/jquery-3.6.0.slim.min.js"></script>

	<link href="/assets/themes/evjekylltheme/google-code-prettify/desert.css" type="text/css" rel="stylesheet" />

    <!-- Le styles -->
    <link href="/assets/themes/evjekylltheme/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/evjekylltheme/css/style.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/images/favicon.ico">

    <!-- atom & rss feed -->
    <link href="" type="application/atom+xml" rel="alternate" title="Jekyll auto generate ATOM Feed">
    <link href="" type="application/atom+xml" rel="alternate" title="Site ATOM Feed">
    <link href="" type="application/rss+xml" rel="alternate" title="Site RSS Feed">
	<link rel="stylesheet" href="/assets/themes/evjekylltheme/font-awesome-4.4.0/css/font-awesome.min.css">
	<!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-W2LDG64');</script> -->
		<!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8529425670069509"
						crossorigin="anonymous"></script> -->
	<!-- <script async src="https://cdn.splitbee.io/sb.js"></script> -->
  </head>

  <body>
	<!-- <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2LDG64"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> -->
    <div class="navbar navbar-default navbar-fixed-top">
				<div class="container">
          <div class="row mobilepadding">
					<!-- <a class="navbar-brand" href="/">船长的课记</a> -->
					<a class="navbar-brand" href="/">SAMZONG</a>
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse" id="mNavbar">
  					<ul class="nav navbar-nav">
  						
  						
  						


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/friends.html">Friends</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



						  <li class="dropdown">
							  <a class="dropdown-toggle" data-toggle="dropdown" href="#">Other</a>
							  <ul class="dropdown-menu">
									<li><a href="/about.html">About</a></li>
									<li><a href="https://yuque.com/samzong/note" target="_blank">船长的课记</a></li>
									<li><a href="https://yuque.com/samzong/ap" target="_blank">果粉日记</a></li>
									<li><a href="https://yuque.com/samzong/code" target="_blank">Code Snippet</a></li>
									<li><a href="https://www.yuque.com/samzong/mcx" target="_blank">集</a></li>
									<li><a href="https://www.yuque.com/zooka" target="_blank">藏金阁</a></li>
								</ul>
						  </li>
  					</ul>
  					<form id="search-form" class="navbar-form navbar-right" role="search">
  						<div class="form-group">
  						<input type="text" class="form-control input-sm" placeholder="Search's Bad" id="query">
  						</div>
  					</form>
  					<div class="nav-icon">
  						<a href="/feed.xml"><i class="fa fa-rss fa-2x"></i></a>
  					</div>
          </div>
				</div>
      </div>
    </div>

    <div class="container">
			<div class="row mobilepadding">
        <div class="row">
					<div class="col-md-12">
						<div class="searchresult">
						</div>
						<div id="search-loader" class="img-wrap">
						</div>
					</div>
        </div>
				<meta itemprop="image" content="https://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com/uPic/telegram-cloud-photo-size-4-5971176114485308439-x.jpg">
<div class="row">
  <div class="col-xs-12 col-md-8">
    
    
    <h1><a class="title" href="/post/2017/01/Docker-Hub-%E5%9B%BD%E5%86%85%E5%8A%A0%E9%80%9F.html">Docker Hub 国内加速</a></h1>
    <div class="post_at_index">
      <p>因为 Docker Hub 没有在国内部署站点或者增加了国内的 CDN，这导致国内的开发者在使用 docker pull 获取 images 的时候速度非常的慢，甚至于因为网络的原因会失败。</p>

<p>但是 Docker Hub 有着非常丰富的镜像资源，所以我这一直是个问题困扰着我，一次偶然机会发现了<a href="https://www.daocloud.io">DaoCloud</a>提供了国内镜像加速服务，并且提供的 Docker Hub Mirror 详细的文档。</p>

<h4 id="1-注册-daocloud-账号">1. 注册 DaoCloud 账号</h4>

<p>首先，你需要到一 DaoCloud 账号，注册很方便，点击地址：<a href="https://account.daocloud.io/signup">signup</a>
<img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/o6wh3.jpg" alt="image" /></p>

<h4 id="2-登录到你的-daocloud-账号内然后入下图操作">2. 登录到你的 DaoCloud 账号内，然后入下图操作</h4>

<p><img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/n9mt7.jpg" alt="image" /></p>

<h4 id="3-查看你的-daocloud-加速器地址">3. 查看你的 DaoCloud 加速器地址</h4>

<p><a href="https://www.daocloud.io/mirror#accelerator-doc">链接</a></p>

<p>选择你相对应平台的的加速器设置
<img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/4wuea.jpg" alt="image" /></p>

      
    </div>
    <br/>
    <div>
      <cite>2017-01-07</cite> <i class="icon-tag"></i>
      <a href="/tags.html#DockerHub">DockerHub</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/HowTo-Mount-OSS-Bucket-On-ECS.html">HowTo Mount OSS Bucket On ECS</a></h1>
    <div class="post_at_index">
      <blockquote>
  <p>From <a href="https://github.com/aliyun/ossfs">阿里云官方 Github</a>
Demo: CentOS 6.8 on ECS</p>
</blockquote>

<p>ossfs 是通过磁盘挂载的形式，将 oss 存储挂载到 linux、类 unix 等操作系统，而且不仅仅可以挂载阿里云内的 ECS 上，理论上所有网络能到达 oss 的都可以挂载，但还是要以实际问题为准。</p>

<h2 id="1download--install">1.Download &amp; Install</h2>

<p><a href="https://github.com/aliyun/ossfs/releases">官方版本发布页面</a>，请根据你的系统类型进行选择，我这演示的环境是 CentOS 6.8；ossfs 目前最新的版本是 v1.79.9，您可以根据自己当时版本进行选择，建议选择最新版本。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 请先将包上传到服务器上</span>
 <span class="nb">sudo </span>yum localinstall ossfs_1.79.9_centos6.5_x86_64.rpm
</code></pre></div></div>

<blockquote>
  <p>注意使用 localinstall，因为在安装过程，yum 可以很好的解决依赖关系，会节省我们很多时间</p>
</blockquote>

<h2 id="2-oss--bucket">2. OSS &amp; Bucket</h2>

<p>需要获取以下信息，在后面我们都会用到的：</p>

<ul>
  <li>
    <p>Bucket 名称
<img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-0.jpg" alt="image" /></p>
  </li>
  <li>
    <p>Access Key ID</p>
  </li>
  <li>
    <p>Access Key Secret</p>

    <p><img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0256A9CB-A0FA-43BC-82AF-4DE17D4852B6.png" alt="image" />
<img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-2.jpg" alt="image" /></p>
  </li>
  <li>
    <p>Location，这需要注意点，不要加上 Bucket 的名字，区域对应表如下，注意你的 Bucket 所在区域：</p>
  </li>
</ul>

<div><table><thead><tr><th style="color:green">Region 中文名称</th><th style="text-align:left;color: green;">Region 英文表示</th><th style="text-align:left;color: green;">外网 Endpoint</th><th style="text-align:left;color: green;">ECS 访问的内网 Endpoint</th></tr></thead><tbody><tr><td>华东 1</td><td style="text-align:left">oss-cn-hangzhou</td><td style="text-align:left">oss-cn-hangzhou.aliyuncs.com</td><td style="text-align:left">oss-cn-hangzhou-internal.aliyuncs.com</td></tr><tr><td>华东 2</td><td style="text-align:left">oss-cn-shanghai</td><td style="text-align:left">oss-cn-shanghai.aliyuncs.com</td><td style="text-align:left">oss-cn-shanghai-internal.aliyuncs.com</td></tr><tr><td>华北 1</td><td style="text-align:left">oss-cn-qingdao</td><td style="text-align:left">oss-cn-qingdao.aliyuncs.com</td><td style="text-align:left">oss-cn-qingdao-internal.aliyuncs.com</td></tr><tr><td>华北 2</td><td style="text-align:left">oss-cn-beijing</td><td style="text-align:left">oss-cn-beijing.aliyuncs.com</td><td style="text-align:left">oss-cn-beijing-internal.aliyuncs.com</td></tr><tr><td>华南 1</td><td style="text-align:left">oss-cn-shenzhen</td><td style="text-align:left">oss-cn-shenzhen.aliyuncs.com</td><td style="text-align:left">oss-cn-shenzhen-internal.aliyuncs.com</td></tr><tr><td>香港数据中心</td><td style="text-align:left">oss-cn-hongkong</td><td style="text-align:left">oss-cn-hongkong.aliyuncs.com</td><td style="text-align:left">oss-cn-hongkong-internal.aliyuncs.com</td></tr><tr><td>美国硅谷数据中心</td><td style="text-align:left">oss-us-west-1</td><td style="text-align:left">oss-us-west-1.aliyuncs.com</td><td style="text-align:left">oss-us-west-1-internal.aliyuncs.com</td></tr><tr><td>美国弗吉尼亚数据中心</td><td style="text-align:left">oss-us-east-1</td><td style="text-align:left">oss-us-east-1.aliyuncs.com</td><td style="text-align:left">oss-us-east-1-internal.aliyuncs.com</td></tr><tr><td>亚太（新加坡）数据中心</td><td style="text-align:left">oss-ap-southeast-1</td><td style="text-align:left">oss-ap-southeast-1.aliyuncs.com</td><td style="text-align:left">oss-ap-southeast-1-internal.aliyuncs.com</td></tr><tr><td>亚太东北 1（日本）数据中心</td><td style="text-align:left">oss-ap-northeast-1</td><td style="text-align:left">oss-ap-northeast-1.aliyuncs.com</td><td style="text-align:left">oss-ap-northeast-1-internal.aliyuncs.com</td></tr></tbody></table></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 设置bucket/access key/id的信息，将其存放在/etc/passwd-ossfs 文件中</span>
<span class="c"># 注意这个文件的权限必须正确设置，建议设为 640</span>

<span class="nb">sudo echo </span>my-bucket:my-access-key-id:my-access-key-secret <span class="o">&gt;</span> /etc/passwd-ossfs
<span class="nb">sudo chmod </span>640 /etc/passwd-ossfs

</code></pre></div></div>

<h2 id="3-mount--uasge">3. Mount &amp; Uasge</h2>

<p>将 oss bucket mount 到指定目录：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 我碰到安装后找不到 ossfs 命令，查看下因为 ossfs 没有 x 权限，目录路径为/usr/local/bin，如果您也碰到这个问题，可以增加 x 权限后再测试</span>
<span class="nb">sudo </span>ossfs my-bucket /mnt/ossdir <span class="nt">-ourl</span><span class="o">=</span>http://oss-location.aliyuncs.com

<span class="c"># 如果使用 ossfs 的机器是阿里云 ECS，可以使用内网域名来避免流量收费和 提高速度</span>

<span class="nb">sudo </span>ossfs my-bucket /tmp/ossfs <span class="nt">-ourl</span><span class="o">=</span>&lt;http://oss-location-internal.aliyuncs.com&gt;

</code></pre></div></div>

<p>磁盘空间达到上百 T：
<img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0B78E099-5488-4839-AE48-09A074E7415D.png" alt="image" /></p>

<p>umount：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 注意用户身份</span>

umount /tmp/ossfs <span class="c"># root user</span>
<span class="nb">sudo </span>fusermount <span class="nt">-u</span> /tmp/ossfs <span class="c"># non-root user</span>

</code></pre></div></div>

<h2 id="4-debug--faq">4. Debug &amp; FAQ</h2>

<p>当遇到错误的时候，可以试着打开 Debug 日志信息，然后分析问题原因：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 使用 -o dbglevel=debug -f -d 参数打印日志信息</span>

<span class="nb">sudo </span>ossfs my-bucket /tmp/ossfs <span class="nt">-ourl</span><span class="o">=</span>&lt;http://oss-location-internal.aliyuncs.com&gt; <span class="nt">-o</span> <span class="nv">dbglevel</span><span class="o">=</span>debug <span class="nt">-f</span> <span class="nt">-d</span> <span class="o">&gt;</span> /mnt/ossfs.log 2&gt;&amp;1

</code></pre></div></div>

<p>更多的问题，请移步查看<a href="https://github.com/aliyun/ossfs/wiki/FAQ">官方的 FAQ 文档</a>。</p>

<h2 id="5-about">5. About</h2>

<p>ossfs 提供的功能和性能和本地文件系统相比，具有一些局限性。具体包括：</p>

<ul>
  <li>随机或者追加写文件会导致整个文件的重写。</li>
  <li>元数据操作，例如 list directory，性能较差，因为需要远程访问 oss 服务器。</li>
  <li>文件/文件夹的rename操作不是原子的。</li>
  <li>多个客户端挂载同一个 oss bucket 时，依赖用户自行协调各个客户端的行为。例如避免多个客户端写同一个文件等等。</li>
  <li>不支持 hard link。</li>
  <li>不适合用在高并发读/写的场景，这样会让系统的load升高</li>
</ul>

<blockquote>
  <p>另外，ossfs 的稳定性很大一部分依赖于网络环境，建议的使用场景更多是作为临时数据迁移或定期备份，虽然 ossfs 挂载到系统中会有着几百 TB 的空间，但是稳定性并不高。</p>
</blockquote>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-20</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Aliyun">Aliyun</a>
      , 
      <a href="/tags.html#CentOS">CentOS</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/%E4%B8%8A%E6%B5%B7%E5%A4%A9%E5%86%B7%E4%BA%86.html">上海天冷了</a></h1>
    <div class="post_at_index">
      <p>上海天冷了啊！上海天冷了啊啊！！上海天冷了啊啊！！！</p>

<p>重要的事情说三遍，这是一个好习惯，有了冬天的感觉，早上起床的时候有感觉，下班路上有感觉，现在坐在键盘前打字也很有感觉；前几天在微博上写了几句话：如今算是最好的季节，褪去夏日的燥热与汗渍，又不像冬日那么干冷凛冽，穿的衣服也是刚刚好，单条牛仔裤加个风衣或冲锋衣既藏住身上的赘肉，又不失潇洒，正是装逼好时节，而最最好的是这个季节的女子，美丽更胜其它季节。朋友嘲笑说其实想看黑丝，哈哈！谁知才过几天，就感受到了那种“干冷凛冽”。但是，我喜欢这种感觉，就像我喜欢这座城市，我说我喜欢冬天，自小就喜欢，我说我喜欢这座城市，就像自小就喜欢；我说不出来为什么喜欢，就像很多说不出来为什么喜欢，就像有些人，就像有些事，就像有些讨厌，人终是要顺了自己的心意，不然不会开心，但是要懂事，不懂事就不可爱了。</p>

<!-- more -->

<p>最近一直比较忙，弄得心烦意乱。</p>

<p>生活上，最近外公有生病，母亲十分挂念，原本外公外婆年岁已高且身体不好，家里几位舅父却又不有作为，也令母亲十分苦恼，本来她身体也有不好，我却不能帮上她一二，内心也是颇为着急挂念，只能尽力安慰。说起外公外婆，也是难过不已，近两年，因些事每年都要回去两三趟，而又匆忙，故无多时间陪陪他们，外婆已多年卧病在床，起居生活全有外公照顾，我一次尝试想搀扶外婆起床，是异常艰难，可外公 80 多岁老人一扶就是 8 年多。有时，自己也想，若是自己到了这般年纪，该如何处置，想想也难过不已，想二位老人，到了这个年纪，早已不在乎吃穿用度如何如何，多年孤苦在家，更想要的子女多多陪伴，所以每次母亲打电话回去都哭泣不止；最怕“子欲养而亲不待”的事，我也劝说母亲有空就多多回老家陪陪，而母亲却担心我的婚娶生活，更令我难过不已，暗恨自己无用；昨今两日，父母又相继回老家，也希望外公身体早日恢复。</p>

<p>工作上，自从去年与领导夸下豪言便一直不敢懈怠，但实际做下来的确是要比想象中困难许多，本来自己就不是聪明，这段时间做项目需求，改了许多稿总算通过，开心，感叹领导是好性格，如此耐心指导我；而前段时间，这个项目好几处也是几近失控，和其他公司的人沟通协调处理等一团糟，还好如今都渐回正轨；第一项目还未做完，就打退堂鼓，幸亏领导的指导，同事的帮助，当然还有我的好妹妹，每次感觉扛不住的找她聊聊发发牢骚，都能耐心听并给我加油打气。感谢这些人，当然也感谢自己，总有各种办法给自己恢复元气，今早，用思维导图把最近的烦心事要做的事全部写出来，然后一条一条的分析处理，最后恢复了好心情，又一如既往的工作生活。</p>

<p>又 23 点过半了，要抓紧早睡了，调整正常作息才能更充沛的工作生活，记录走出了这一段不好的日子，恢复元气的自己，但是不能懈怠，毕竟“革命尚未成功，同志仍需努力”。</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-17</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Zero">Zero</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/%E5%91%8A%E5%88%AB.html">告别</a></h1>
    <div class="post_at_index">
      <p>你们一起看过很多风景</p>

<p>走过很多路</p>

<p>因为小事争吵</p>

<p>为了让对方委曲求全过</p>

<p>你们花光了所有力气</p>

<p>竟还是没有逃过分开的命运</p>

<p>于是从此以后</p>

<p>你走那条路都会想起当时的嬉笑怒骂</p>

<p>你经过街角的那间咖啡馆会记得甜得发腻的糖霜</p>

<p>可是人啊</p>

<p>总要学会告别</p>

<p>无论如何</p>

<p>我们的生命中</p>

<p>都逃脱不了</p>

<p>永无休止的告别</p>

<p><img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/pk6qu.JPG" alt="img" /></p>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-17</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Zero">Zero</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/%E8%A1%80%E6%88%98%E9%92%A2%E9%94%AF%E5%B2%AD.html">血战钢锯岭</a></h1>
    <div class="post_at_index">
      <p>历史才是最好的教科书，我们从一段又一段历史中汲取经验和教训，尽量让人生走得不去更加艰难，而这毫无疑问战争是最好的老师，最残酷的史实，人类从千百的历史中依然没能学会和平，战争，让这个世界变得满目疮痍。</p>

<p>今天去看了《血战钢锯岭》，有多久没有感动到流下眼泪，很好，前半段在讲述道斯如何与军队抗争，坚守自己的信仰，信仰是个好东西，但愿你我都有。后半段战争的场面极其的血腥暴力，电影尚是如此，真实又怎样想象，人生从来没有 NG，因为真实，才最有力量；我们都喜欢甜美的故事，我也为了道斯的爱情而感动，也因战争的残酷而愤怒。</p>

<p><img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/gjt1b.jpg" alt="道斯和妻子吻别" />
<img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/w4nzi.jpg" alt="道斯冒着枪林弹雨拯救受伤的士兵" /></p>

<p>这是我最喜欢的电影了，最让我感动的话是在军事法庭上道斯说：世界已经分崩离析，我要把它拼成原来的样子。看到这里心都碎了，这个世界上总有些人，哪怕与所有人为敌，所有人不信任，经受磨难羞辱，也坚持自己的信仰，这才是英雄；放下枪的人才是勇敢，他教会我们，我们应该成为怎样的人，不能忘记历史带给我们的伤痛，不能忘记而不是去恨，珍惜美好生活，不要战争。</p>

<p>在这段时期，同样想起的是南京大屠杀，同样是二战时期日军留下的暴行，他们是魔鬼，他们终将会受到应有的惩罚；首先，我们都不能忘记，这是我们的伤痛，真实的历史远比想象的更加残酷，哪些被迫害的人，哪些南京大屠杀纪念馆的人名册，这些人是多么的绝望啊，数以千万计的道斯奋战的美好世界，怎能让战争败类去迫害，我不喜欢战争，任何一个国家。</p>

<p>同样的选择给我，我会选择拿起枪，鲁迅先生说过：学医是救不了中国的，我终于不是道斯，看到咫尺近前的战友被日本人用刺刀刺死，却选择不拿起枪，我做不到；实际上，我也是一个有信仰的人，我的信仰的是我在乎的人，我愿意为了他们奋不顾身直到死亡，因为，他们是我的逆鳞啊！</p>

<p>小时候，常听老人家说，要忆苦思甜，实际上应该是要铭记战争带给我们的伤痛，要铭记那段时期，勇敢的坚持的信仰，更加重要的是珍惜现在的美好。</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-11</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Zero">Zero</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/HowTo-Install-Python3-on-CentOS-6-x.html">HowTo Install Python3 on CentOS 6.x</a></h1>
    <div class="post_at_index">
      <p>接触过 Python2.x 与 Python3.x 的应该知道，它们二者的区别也是蛮大的，而随着 Python3.x 的盛行，越来越多的应用运行与 Python3.x 的环境之上，但是我们的 CentOS 的系列，目前都默认安装时 Python2.x（CentOS 7.x 也是），所以不得不我们需要自己行动手安装 Python 3.x 的环境。</p>

<p>Mirosoft 平台与 Mac 平台，不在考虑范围，他们都有相应的软件包与图形化安装工具，可以很好的解决这个问题，所以今天我们的环境是在 CentOS 6.x 系列上进行。</p>

<blockquote>
  <p>Demo : CentOS 6.8</p>
</blockquote>

<h2 id="method-1-build--install-from-source-file">Method 1. Build &amp; Install From Source-File</h2>

<ul>
  <li>Python3.x 源码文件下载，请选择适合的版本。 <a href="https://www.python.org/ftp/python/">下载页面</a></li>
  <li>我这里使用版本 Python 3.5</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>cent@demo ~]<span class="nv">$ </span>wget https://www.python.org/ftp/python/3.5.0/Python-3.5.0.tgz
</code></pre></div></div>

<p>安装系统基本工具：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># yum-utils</span>
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> yum-utils

<span class="c"># 构建python 编译环境</span>
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">sudo </span>yum-builddep python
</code></pre></div></div>

<p>开始编译 &amp; 安装</p>

<p>并且源码安装的同时，会将 pip3 与 setuptools 一同安装。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">tar </span>xf Python-3.5.0.tgz
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">cd </span>Python-3.5.0
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span>./configure
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span>make
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">sudo </span>make <span class="nb">install</span>
</code></pre></div></div>

<p>检查版本</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>cent@demo ~]<span class="nv">$ </span>python3 <span class="nt">-V</span>
Python 3.5.0

<span class="c"># 如果希望系统默认为Python3</span>
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">alias </span><span class="nv">python</span><span class="o">=</span><span class="s1">'usr/bin/python3.5'</span>
</code></pre></div></div>

<h2 id="method-2-install-from-epel-repos">Method 2. Install From EPEL repos</h2>

<p>也许有的同学会说，编译安装，那是上古时期的做法了，yum 在线安装才是王道，当然这种说法也有可取之处，所以接下来讲下如何使用 yum 安装，需要注意的是 yum 安装是需要时间测试和增加到相应的源仓库，一般会稍慢于源码安装的方式，这里采用 EPEL 源，这是一个非常棒的第三方源仓库，之前的文章中也多次提到，这里就不做过多描述，请看下面的命令：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> epel-release
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> python34

<span class="c"># 因为yum安装时没能同时安装pip与setuptools，所以我们要手动安装，这里采用拿第三方包解决问题</span>

<span class="o">[</span>cent@demo ~]<span class="nv">$ </span>curl <span class="nt">-O</span> https://bootstrap.pypa.io/get-pip.py
<span class="o">[</span>cent@demo ~]<span class="nv">$ </span><span class="nb">sudo </span>python3 get-pip.py

<span class="o">[</span>cent@demo ~]<span class="nv">$ </span> python3 <span class="nt">-V</span>
Python 3.4.3
</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-08</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Python">Python</a>
      , 
      <a href="/tags.html#CentOS">CentOS</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/HowTo-Reset-MySQL-Root-Password.html">HowTo Reset MySQL Root Password</a></h1>
    <div class="post_at_index">
      <h4 id="1-处理的状态">1. 处理的状态</h4>

<p>首先确认服务器出于安全的状态，也就是没有人能够任意地连接 MySQL 数据库。
因为在重新设置 MySQL 的 root 密码的期间，MySQL 数据库完全出于没有密码保护的
状态下，其他的用户也可以任意地登录和修改 MySQL 的信息。可以采用将 MySQL 对
外的端口封闭，并且停止 Apache 以及所有的用户进程的方法实现服务器的准安全
状态。最安全的状态是到服务器的 Console 上面操作，并且拔掉网线。</p>

<h4 id="2-重置密码">2. 重置密码</h4>

<p>修改 mysql 配置文件，增加 skip-grant-tables</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@demo ~]# vim /etc/my.cnf
<span class="o">[</span>mysqld]
skip-grant-tables
</code></pre></div></div>

<p>重启 mysqld</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@demo ~]# service mysqld restart
Stopping mysqld:                                           <span class="o">[</span>  OK  <span class="o">]</span>
Starting mysqld:                                           <span class="o">[</span>  OK  <span class="o">]</span>
</code></pre></div></div>

<p>登录 mysql，并修改 root 密码。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@demo ~]# mysql <span class="nt">-u</span> root
Welcome to the MySQL monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span><span class="nb">.</span>
Your MySQL connection <span class="nb">id </span>is 3
Server version: 5.5.53 MySQL Community Server <span class="o">(</span>GPL<span class="o">)</span>

Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2016, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="s1">'help;'</span> or <span class="s1">'\h'</span> <span class="k">for </span>help. Type <span class="s1">'\c'</span> to clear the current input statement.

mysql&gt; use mysql
Reading table information <span class="k">for </span>completion of table and column names
You can turn off this feature to get a quicker startup with <span class="nt">-A</span>

Database changed
mysql&gt; update user <span class="nb">set </span><span class="nv">password</span><span class="o">=</span>password<span class="o">(</span><span class="s1">'new-pass'</span><span class="o">)</span> where <span class="nv">user</span><span class="o">=</span><span class="s1">'root'</span><span class="p">;</span>
Query OK, 5 rows affected <span class="o">(</span>0.00 sec<span class="o">)</span>
Rows matched: 5  Changed: 5  Warnings: 0
</code></pre></div></div>

<p>配置文件去除 skip-grant-tables，并重启服务器。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@demo ~]# vim /etc/my.cnf
<span class="o">[</span>root@demo ~]# service mysqld restart
</code></pre></div></div>

<p>使用新密码登录到 mysql</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@demo ~]# mysql <span class="nt">-h</span> localhost <span class="nt">-u</span> root <span class="nt">-p</span>
</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-04</cite> <i class="icon-tag"></i>
      <a href="/tags.html#MySQL">MySQL</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/Tomcat-2-%E5%88%A9%E7%94%A8JDK%E8%87%AA%E8%BA%ABkeytool%E5%AE%9E%E7%8E%B0HTTPS.html">Tomcat 利用 JDK 自身 keytool 实现 HTTPS</a></h1>
    <div class="post_at_index">
      <p>因为一个偶然机会，想把自己的 webserver 通过 https 加密访问，这里就采用 JDK 自带的 keytool 工具实现，tomcat 官方也推荐这种方式，英文好的同学走这里：<a href="https://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html">官方配置</a></p>

<blockquote>
  <p>demo: CentOS 6.6 &amp; Tomcat 7 &amp; JDK 1.7</p>
</blockquote>

<h2 id="生成-keystore">生成 keystore</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test conf]# keytool <span class="nt">-genkey</span> <span class="nt">-v</span> <span class="nt">-alias</span> tomcat <span class="nt">-keyalg</span> RSA <span class="nt">-keystore</span> mykeystore
Enter keystore password:              <span class="c">#设置密码</span>
Re-enter new password:                <span class="c">#重复一次</span>
What is your first and last name?
  <span class="o">[</span>Unknown]:  Alex Lu                <span class="c">#随便填</span>
What is the name of your organizational unit?
  <span class="o">[</span>Unknown]:  visionet                <span class="c">#随便填</span>
What is the name of your organization?
  <span class="o">[</span>Unknown]:  visionet                <span class="c">#随便填</span>
What is the name of your City or Locality?
  <span class="o">[</span>Unknown]:  SH                <span class="c">#随便填</span>
What is the name of your State or Province?
  <span class="o">[</span>Unknown]:  SH                <span class="c">#随便填</span>
What is the two-letter country code <span class="k">for </span>this unit?
  <span class="o">[</span>Unknown]:  ZH                <span class="c">#随便填</span>
Is <span class="nv">CN</span><span class="o">=</span>Alex Lu, <span class="nv">OU</span><span class="o">=</span>visionet, <span class="nv">O</span><span class="o">=</span>visionet, <span class="nv">L</span><span class="o">=</span>SH, <span class="nv">ST</span><span class="o">=</span>SH, <span class="nv">C</span><span class="o">=</span>ZH correct?
  <span class="o">[</span>no]:  Y                    <span class="c">#这里要Y，确认前面信息。</span>

Generating 2,048 bit RSA key pair and self-signed certificate <span class="o">(</span>SHA256withRSA<span class="o">)</span> with a validity of 90 days
    <span class="k">for</span>: <span class="nv">CN</span><span class="o">=</span>Alex Lu, <span class="nv">OU</span><span class="o">=</span>visionet, <span class="nv">O</span><span class="o">=</span>visionet, <span class="nv">L</span><span class="o">=</span>SH, <span class="nv">ST</span><span class="o">=</span>SH, <span class="nv">C</span><span class="o">=</span>ZH
Enter key password <span class="k">for</span> &lt;tomcat&gt;
    <span class="o">(</span>RETURN <span class="k">if </span>same as keystore password<span class="o">)</span>:        <span class="c">#默认回车即可，不需要设置太多密码</span>
<span class="o">[</span>Storing mykeystore]
<span class="o">[</span>root@test conf]# <span class="nb">ls
</span>Catalina  catalina.policy  catalina.properties  context.xml  logging.properties  mykeystore  server.xml  tomcat-users.xml  web.xml
</code></pre></div></div>

<blockquote>
  <p>注意：-keystore 是用来指定 keystore 保存位置，如果不加参数默认保存的当前用户家目录为~/.keystore
       -validity 可以用来指定证书有效期，单位为天，缺省值为 90 天。</p>
</blockquote>

<h2 id="2-备份tomcatdirconfserverxml">2. 备份$tomcatdir/conf/server.xml</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> <span class="nv">$tomcatdir</span>/conf/server.xml <span class="nv">$tomcatdir</span>/conf/server.xml
</code></pre></div></div>

<h2 id="3-修改-serverxml">3. 修改 server.xml</h2>

<h3 id="a-注释以下tomcat-注释用---xxxx----如何也想保留-http-访问可以不注释">a. 注释以下：（tomcat 注释用：&lt;!-- XXXX --&gt; ）,如何也想保留 http 访问，可以不注释</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--
&lt;Connector executor="tomcatThreadPool"
                port="80" protocol="HTTP/1.1"
                connectionTimeout="20000"
                redirectPort="8443" /&gt;
--&gt;</span>
</code></pre></div></div>

<h3 id="b-取消下面注释">b. 取消下面注释</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Connector</span> <span class="na">port=</span><span class="s">"443"</span> <span class="na">protocol=</span><span class="s">"HTTP/1.1"</span> <span class="na">SSLEnabled=</span><span class="s">"true"</span>
                <span class="na">maxThreads=</span><span class="s">"150"</span> <span class="na">scheme=</span><span class="s">"https"</span> <span class="na">secure=</span><span class="s">"true"</span>
                <span class="na">clientAuth=</span><span class="s">"false"</span> <span class="na">sslProtocol=</span><span class="s">"TLS"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<h3 id="c-增加-keystorefile-和-keystorepass">c. 增加 keystoreFile 和 keystorePass</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Connector</span> <span class="na">port=</span><span class="s">"443"</span> <span class="na">protocol=</span><span class="s">"HTTP/1.1"</span> <span class="na">SSLEnabled=</span><span class="s">"true"</span>
               <span class="na">maxThreads=</span><span class="s">"150"</span> <span class="na">scheme=</span><span class="s">"https"</span> <span class="na">secure=</span><span class="s">"true"</span>
               <span class="na">clientAuth=</span><span class="s">"false"</span> <span class="na">sslProtocol=</span><span class="s">"TLS"</span>
               <span class="na">keystoreFile=</span><span class="s">"conf/mykeystore"</span> <span class="na">keystorePass=</span><span class="s">"123456"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<blockquote>
  <p>keystoreFile=跟 keystore 文件位置
keystorePass=跟当时 keytool 命令执行时输入的密码</p>
</blockquote>

<h2 id="4-重启-tomcat">4. 重启 tomcat</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test conf]# ../bin/catalina.sh stop <span class="o">&amp;&amp;</span> ../bin/catalina.sh start
Using CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44
Using CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44
Using CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp
Using JRE_HOME:        /home/pms/jdk1.7.0_65
Using CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar
Using CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44
Using CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44
Using CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp
Using JRE_HOME:        /home/pms/jdk1.7.0_65
Using CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar
<span class="o">[</span>root@test conf]# netstat <span class="nt">-ntlup</span> | <span class="nb">grep</span> <span class="nt">-e</span> <span class="s2">"80</span><span class="se">\|</span><span class="s2">443"</span>
tcp        0      0 0.0.0.0:80         0.0.0.0:<span class="k">*</span>          LISTEN      21960/java
tcp        0      0 0.0.0.0:443        0.0.0.0:<span class="k">*</span>          LISTEN      21960/java
tcp        0      0 127.0.0.1:8005     0.0.0.0:<span class="k">*</span>          LISTEN      21960/java
tcp        0      0 0.0.0.0:8009       0.0.0.0:<span class="k">*</span>          LISTEN      21960/java
<span class="o">[</span>root@test conf]#
</code></pre></div></div>

<p>OK !</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-03</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Tomcat">Tomcat</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/11/AWS-Use-s3cmd%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%A1%E7%90%86S3%E5%AD%98%E5%82%A8.html">AWS Use s3cmd 命令行管理 S3 存储</a></h1>
    <div class="post_at_index">
      <p>S3 是 AWS 公有云服务提供的云存储服务，提供海量数据存储服务，同时基于 AWS S3 提供的一系列网络服务接口，也有大量已经开发完成的工具供我们使用，以利用起 AWS 庞大的存储资源，这篇文章的目录选取了其中一个用 Linux 命令行工具<a href="http://s3tools.org">s3cmd</a>来管理 AWS S3 云存储其中的数据。</p>

<p>s3cmd 是非常优秀的 S3 命令行管理工具，用 python 编写，支持 python 2.6 &amp; 2.7，但是尚不支持 python3，但是目前绝大多数的 Linux 发行版默认都是 python2.x 系列。</p>

<blockquote>
  <p>Demo CentOS 6.x</p>
</blockquote>

<h2 id="install-s3cmd"><strong>Install s3cmd</strong></h2>

<h3 id="1-无论是-denbian-系还是-rehat-系列软件仓库内已经加入了-s3cmd">1. 无论是 Denbian 系还是 Rehat 系列，软件仓库内已经加入了 s3cmd</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1.1 Ubuntu &amp; Debian</span>
<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> s3cmd

<span class="c"># 1.2 RHEL &amp; CentOS</span>
<span class="nv">$ </span><span class="nb">sudo </span>yum <span class="nb">install </span>s3cmd
</code></pre></div></div>

<h3 id="2-如果您的系统比较特殊软件仓库内找不到-s3cmd还有-s3cmd-的-github-上去获取相关安装信息链接">2. 如果您的系统比较特殊，软件仓库内找不到 s3cmd，还有 s3cmd 的 Github 上去获取相关安装信息：<a href="https://github.com/s3tools/s3cmd">链接</a></h3>

<h2 id="configure-s3cmd"><strong>Configure s3cmd</strong></h2>

<h3 id="1-第一次运行-s3cmd-需要首先预配置相关-s3-信息">1. 第一次运行 s3cmd 需要首先预配置相关 s3 信息</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s3cmd <span class="nt">--configure</span>
</code></pre></div></div>

<p>它会问你一系列问题：</p>

<ul>
  <li>AWS S3 中 IAM 账户的 Access Key 以及 Secret Key (建议单独创建 IAM)</li>
  <li>对 AWS S3 双向传输的加密密码（自行设定不要忘记）</li>
  <li>为加密数据设定 GPG 程序的路径（默认即可）</li>
  <li>是否使用 https 协议（默认即可）</li>
  <li>如果不是 https 协议，需要设定名字和端口
配置完成之后，配置信息以普通文本保存在~/.s3cfg</li>
</ul>

<h3 id="2-china-与-global-的区别">2. China 与 Global 的区别</h3>

<p>笔者在第一次运行时，始终无法添加成功，报错信息如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ERROR: Test failed: 403 <span class="o">(</span>InvalidAccessKeyId<span class="o">)</span>: The AWS Accecc Key Id you provided does not exist <span class="k">in </span>our records.
</code></pre></div></div>

<p>起初以为是 Access Key 不对，在经过多次测试之后，才发现问题，这是因为 s3cmd 内置 s3 的 Domain 为 Global 的信息，而中国与 Global 是独立存在的所以查找不到我们的 Access Key。所以，如果你使用的 Global AWS 那么上面一步应该已经配置好了你的 s3cmd，如果你是 AWS China 的用户，那么你要做以下操作。</p>

<ul>
  <li>在 Retry configuration? [Y/n]选择“n”</li>
  <li>Save settings? [y/N] 选择“y”</li>
  <li>保存设置之后，编辑配置文件（~/.s3cfg ) 修改其中的如下字段，并将其中%(bucket)s 用您实际的某一个存储桶名字代替掉</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bucket_location <span class="o">=</span> %<span class="o">(</span>location<span class="o">)</span>
host_base <span class="o">=</span> s3.cn-north-1.amazonaws.com.cn
host_bucket <span class="o">=</span> %<span class="o">(</span>bucket<span class="o">)</span>s.s3.cn-north-1.amazonaws.com.cn
website_endpoint <span class="o">=</span> http://%<span class="o">(</span>bucket<span class="o">)</span>s.s3-website-%<span class="o">(</span>location<span class="o">)</span>s.amazonaws.com.cn/
</code></pre></div></div>

<p>例如，你的存储桶的名字为 s3chinatest: 地域为北京。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bucket_location <span class="o">=</span> cn-north-1
host_base <span class="o">=</span> s3.cn-north-1.amazonaws.com.cn
host_bucket <span class="o">=</span> s3chinatest.s3.cn-north-1.amazonaws.com.cn
website_endpoint <span class="o">=</span> http://s3chinatest.s3-website.amazonaws.com.cn/
</code></pre></div></div>

<h3 id="3-保存配置文件然后用命令测试一下确认-s3cmd-可以正常工作">3. 保存配置文件，然后用命令测试一下，确认 s3cmd 可以正常工作</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd <span class="nb">ls
</span>2016-11-18 22:30 s3://s3chinatest
2016-10-29 00:14 s3://bucket2
</code></pre></div></div>

<h2 id="s3cmd-的基本使用"><strong>s3cmd 的基本使用</strong></h2>

<h3 id="1-查看当前账户下所有现有的桶-bucket">1. 查看当前账户下所有现有的桶 (bucket)</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd <span class="nb">ls
</span>2016-11-18 22:30 s3://s3chinatest
2016-10-29 00:14 s3://bucket2
</code></pre></div></div>

<h3 id="2-创建新的-bucket">2. 创建新的 bucket</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd mb s3://s3chinatest2

Bucket ’s3://s3chinatest2/’ created
</code></pre></div></div>

<h3 id="3-上传文件到-bucket">3. 上传文件到 bucket</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd put file1.txt file2.txt file3.txt s3://s3chinatest2
upload: <span class="s1">'file1.txt'</span> -&gt; <span class="s1">'s3://s3chinatest2/file1.txt'</span>  <span class="o">[</span>1 of 3]
 2432 of 2432   100% <span class="k">in    </span>0s    43.27 kB/s  <span class="k">done
</span>upload: <span class="s1">'file2.txt'</span> -&gt; <span class="s1">'s3://s3chinatest2/file2.txt'</span>  <span class="o">[</span>2 of 3]
 2432 of 2432   100% <span class="k">in    </span>0s    59.83 kB/s  <span class="k">done
</span>upload: <span class="s1">'file3.txt'</span> -&gt; <span class="s1">'s3://s3chinatest2/file3.txt'</span>  <span class="o">[</span>3 of 3]
 2432 of 2432   100% <span class="k">in    </span>0s    58.93 kB/s  <span class="k">done</span>

 <span class="nv">$ </span>s3cmd <span class="nb">ls </span>s3://s3chinatest2
 2016-11-18 15:11      2432   s3://s3chinatest2/file1.txt
2016-11-18 15:11      2432   s3://s3chinatest2/file2.txt
2016-11-18 15:11      2432   s3://s3chinatest2/file3.txt
</code></pre></div></div>

<p>上传的文件默认访问权限为私有 (private)，只能用户自己可以访问，使用正确的访问和安全密码即可。
如果要上传公开访问权限的文件，需要添加 –acl-public 参数。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd put  <span class="nt">--acl-public</span> file4.txt s3://s3chinatest2
upload: <span class="s1">'file4.txt'</span> -&gt; <span class="s1">'s3://s3chinatest2/file1.txt'</span>  <span class="o">[</span>1 of 1]
 2432 of 2432   100% <span class="k">in    </span>0s    43.27 kB/s  <span class="k">done</span>
</code></pre></div></div>

<h3 id="4-下载-bucket-内的文件">4. 下载 bucket 内的文件</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd get s3://s3chinatest2/file1.txt
download: <span class="s1">'s3://s3chinatest2/file1.txt'</span> -&gt; <span class="s1">'./file1.txt'</span>  <span class="o">[</span>1 of 1]
 2432 of 2432   100% <span class="k">in    </span>0s    27.65 kB/s  <span class="k">done</span>

 <span class="c"># 支持 " * "匹配任意字符</span>
 <span class="nv">$ </span>s3cmd get s3://s3chinatest2/file<span class="k">*</span>.txt
download: <span class="s1">'s3://s3chinatest2/file1.txt'</span> -&gt; <span class="s1">'./file1.txt'</span>  <span class="o">[</span>1 of 3]
 2432 of 2432   100% <span class="k">in    </span>0s    48.11 kB/s  <span class="k">done
</span>download: <span class="s1">'s3://s3chinatest2/file2.txt'</span> -&gt; <span class="s1">'./file2.txt'</span>  <span class="o">[</span>2 of 3]
 2432 of 2432   100% <span class="k">in    </span>0s    84.76 kB/s  <span class="k">done
</span>download: <span class="s1">'s3://s3chinatest2/file3.txt'</span> -&gt; <span class="s1">'./file3.txt'</span>  <span class="o">[</span>3 of 3]
 2432 of 2432   100% <span class="k">in    </span>0s    75.28 kB/s  <span class="k">done</span>
</code></pre></div></div>

<blockquote>
  <p>注意若当前目录有相同文件时，可以使用–skip-existing 参数跳过这些文件。</p>
</blockquote>

<h3 id="5-删除-bucket-内的文件">5. 删除 bucket 内的文件</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># del 与 rm 都可以使用.</span>
<span class="nv">$ </span>s3cmd del s3://s3chinatest2/file1.txt
delete: <span class="s1">'s3://s3chinatest2/file1.txt'</span>
</code></pre></div></div>

<h3 id="6-获取当前-bucket-信息">6. 获取当前 bucket 信息</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># bucket的存储位置及访问权限设置</span>
s3cmd info s3://s3chinatest2
s3://s3chinatest2/ <span class="o">(</span>bucket<span class="o">)</span>:
   Location:  cn-north-1
   Payer:     BucketOwner
   Expiration Rule: none
   policy:    none
   cors:      none
   ACL:       2fe63da8137b85d9868d240869945287b285a58b5d7e07e21ac813b486dcabea: FULL_CONTROL
</code></pre></div></div>

<h3 id="7-上传文件到-bucket-时加密">7. 上传文件到 bucket 时加密</h3>

<p>当用 s3cmd 下载一个加密过的文件时，它会自动检测加密并在下载过程解密，因此下载和访问加密文件时，就像通常所做的一样</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd <span class="nt">-e</span> put t_result.java s3://s3chinatest2
upload: <span class="s1">'/tmp/tmpfile-S9lUXERAEUdnNaz5zHba'</span> -&gt; <span class="s1">'s3://s3chinatest2/t_result.java'</span>  <span class="o">[</span>1 of 1]
 3355 of 3355   100% <span class="k">in    </span>0s    39.25 kB/s  <span class="k">done</span>
</code></pre></div></div>

<h3 id="8-查看-bucket-使用情况">8. 查看 bucket 使用情况</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd <span class="nb">du </span>s3://s3chinatest2
8219     3 objects s3://s3chinatest2/
</code></pre></div></div>

<h3 id="9-删除一个-bucket">9. 删除一个 bucket</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>s3cmd rb s3://s3chinatest2
ERROR: S3 error: 409 <span class="o">(</span>BucketNotEmpty<span class="o">)</span>: The bucket you tried to delete is not empty
<span class="c"># 默认不能删除非空的bucket，所以要先清空存储桶内数据</span>

<span class="nv">$ </span>s3cmd <span class="nb">rm </span>s3://s3chinatest2/<span class="k">*</span>
delete: <span class="s1">'s3://s3chinatest2/file2.txt'</span>
delete: <span class="s1">'s3://s3chinatest2/file3.txt'</span>
delete: <span class="s1">'s3://s3chinatest2/t_result.java'</span>

<span class="nv">$ </span>s3cmd rb s3://s3chinatest2
Bucket <span class="s1">'s3://s3chinatest2/'</span> removed
</code></pre></div></div>

<h2 id="other"><em>Other</em></h2>

<ol>
  <li>关于 s3cmd 还有非常多的功能，这里只是列举简单的一部分，有兴趣的同学，可以使用 man s3cmd 查看详细的帮助文档。</li>
  <li>s3cmd 适用的场景主要利用脚本做 cron 任务，例如定时备份，然后推送到 s3，降低成本，持久保存。</li>
  <li>Windows 平台也支持 s3cmd 哦，有兴趣的同学可以去研究下。</li>
</ol>

      
    </div>
    <br/>
    <div>
      <cite>2016-11-30</cite> <i class="icon-tag"></i>
      <a href="/tags.html#AWS">AWS</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/11/Tomcat-1-java-lang-OutOfMemoryError.html">Tomcat java.lang.OutOfMemoryError</a></h1>
    <div class="post_at_index">
      <h3 id="1-什么是-permgen-space-">1. 什么是 <em>PermGen space</em> ?</h3>

<p>PermGen space 的全称是 Permanent Generation space，是指内存的永久保存区域，这块内存主要是被 JVM 存放 Class 和 Meta 信息的，Class 在被 Loader 时就会被放到 PermGen space 中，它和存放类实例 (Instance) 的 Heap 区域不同，GC(Garbage Collection) 不会在主程序运行期对 PermGen space 进行清理，所以如果你的应用中有很 CLASS 的话，就很可能出现 PermGen space 错误，这种错误常见在 web 服务器对 JSP 进行 pre compile 的时候。如果你的 WEB APP 下都用了大量的第三方 jar，其大小超过了 jvm 默认的大小 (4M) 那么就会产生此错误信息了。</p>

<h3 id="2-解决方法">2. 解决方法</h3>

<h4 id="21-手动设置-maxpermsize-大小">2.1 手动设置 MaxPermSize 大小</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 修改$TOMCAT_HOME/bin/catalina.sh，在“echo "Using CATALINA_BASE:   $CATALINA_BASE"”上面加入以下行：</span>
<span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">"-server -Xms256m -Xmx512m -XX:PermSize=64M -XX:MaxPermSize=128m"</span>
</code></pre></div></div>

<h3 id="3-java-heap-space">3. Java heap space</h3>

<h4 id="解释">解释</h4>

<p>Heap size 设置
JVM 堆的设置是指 java 程序运行过程中 JVM 可以调配使用的内存空间的设置.JVM 在启动的时候会自动设置 Heap size 的值，其初始空间 (即-Xms) 是物理内存的 1/64，最大空间 (-Xmx) 是物理内存的 1/4。可以利用 JVM 提供的-Xmn -Xms -Xmx 等选项可进行设置。Heap size 的大小是 Young Generation 和 Tenured Generaion 之和。</p>

<ul>
  <li>提示：在 JVM 中如果 98％的时间是用于 GC 且可用的 Heap size 不足 2％的时候将抛出此异常信息。</li>
  <li>提示：Heap Size 最大不要超过可用物理内存的 80％，一般的要将-Xms 和-Xmx 选项设置为相同，而-Xmn 为 1/4 的-Xmx 值。</li>
</ul>

<blockquote>
  <p>修改设置方法如 PermGen space</p>
</blockquote>

      
    </div>
    <br/>
    <div>
      <cite>2016-11-28</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Tomcat">Tomcat</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    

    <!-- Pagination links -->
    <nav>
      <ul class="pagination hidden-xs">
        
        
        <li>
          <a href="/page16">&laquo; Previous</a>
        </li>
        
        

        
        <li>
          <a href="/">1</a>
        </li>
        

        
          
            
            <li>
              <a href="/page2">2</a>
            </li>
            
            <li>
              <a href="/page3">3</a>
            </li>
            
            <li>
              <a href="/page4">4</a>
            </li>
            
            <li>
              <a href="/page5">5</a>
            </li>
            
            <li class="disabled"><span>...</span></li>
            <li class="active"><a>17</a></li>
          
          <li class="disabled"><span>...</span></li>
          <li><a href="/page25">25</a></li>
        

        
        

        
        <li>
          <a href="/page18">Next &raquo;</a>
        </li>
        
      </ul>
    </nav>
  </div>
  <div class="col-xs-12 col-md-4">
		<!-- <div>
			<a class="twitter-timeline" data-width="390" data-height="640" data-theme="light" href="https://twitter.com/samzong_lu?ref_src=twsrc%5Etfw">Tweets by SAMZONG</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
		</div> -->
    <div>
      <h2>传送门</h2>
      <ul>
        <li><a href="https://yuque.com/samzong">语雀-花园</a></li>
        <li><a href="https://github.com/samzong">Github</a></li>
      </ul>
    </div>
    <div class="categories">
      <h2>文章分类</h2>
      <ul class="tag_box">
        
        


  
     
    	
      <li><a href="/categories.html#故事汇">
    		故事汇 <span>23</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Linux">
    		Linux <span>22</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#前端">
    		前端 <span>5</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#数据库">
    		数据库 <span>30</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Git">
    		Git <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Mac">
    		Mac <span>18</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Tools">
    		Tools <span>7</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#OpenSource">
    		OpenSource <span>11</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Python">
    		Python <span>46</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#云平台">
    		云平台 <span>8</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#虚拟化">
    		虚拟化 <span>3</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Java">
    		Java <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Docker">
    		Docker <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Blog">
    		Blog <span>7</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#安全">
    		安全 <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#读书笔记">
    		读书笔记 <span>16</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#微服务">
    		微服务 <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Kubernetes">
    		Kubernetes <span>15</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#DaoCloud Enterprise">
    		DaoCloud Enterprise <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#春松客服">
    		春松客服 <span>1</span>
    	</a></li>
    
  



      </ul>
    </div>
    <div>
      <h2>最近文章</h2>
      <ul>
        
        <li>
          <a href="/post/2023/02/Ketbrains%E6%BF%80%E6%B4%BB%E6%9C%8D%E5%8A%A1%E5%99%A8.html">在线服务器激活 Ketbrains</a>
          Ketbrains 激活服务器


        </li>
        
        <li>
          <a href="/post/2022/12/raycast-01.html">Raycast 你的年度报告已到达</a>
          从 Alfred 切换到 Raycast 也就 2 个多月的时间；使用体验有着比较大的提升。


        </li>
        
        <li>
          <a href="/post/2022/12/Skoala-Install-Dce5.html">DCE5-Skoala 安装教程</a>
          使用之前的话


        </li>
        
        <li>
          <a href="/post/2022/12/dce50.html">保姆式安装 DCE5.0</a>
          前言


        </li>
        
        <li>
          <a href="/post/2022/11/cskefu-opensource-project.html">开源项目 - 春松客服</a>
          项目起源


        </li>
        
      </ul>
    </div>
  </div>
</div>

			</div>

		</div>

    <footer>
      <div class="container">
        <div class="row mobilepadding">
          			<hr>
      &copy; 2023 船长. Powered by <a href="http://jekyllrb.com" target="_blank" title="The simple, blog-aware, static site generator.">Jekyll</a>. Theme Creator <a href="https://github.com/einverne" target="_blank" title="Ein Verne's GitHub Repos">Ein Verne</a> . Host on <a href="https://github.com/samzong/samzong.me" target="_blank" title="Samzong's GitHub Repos">Github</a> .
      <br><br>
      </div>
    </div>
    </footer>

    




	<script async type="text/javascript" src="/assets/themes/evjekylltheme/bootstrap-3.3.5/js/bootstrap.min.js"></script>
	<script async type="text/javascript" src="/assets/themes/evjekylltheme/webcore.js"></script>

 </body>
</html>

