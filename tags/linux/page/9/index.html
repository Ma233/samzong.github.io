<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">9 posts tagged with &quot;Linux&quot; | samzong</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://samzong.me/tags/linux/page/9"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="9 posts tagged with &quot;Linux&quot; | samzong"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://samzong.me/tags/linux/page/9"><link data-rh="true" rel="alternate" href="https://samzong.me/tags/linux/page/9" hreflang="en"><link data-rh="true" rel="alternate" href="https://samzong.me/tags/linux/page/9" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="samzong RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="samzong Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="samzong JSON Feed"><link rel="stylesheet" href="/assets/css/styles.94db4b8a.css">
<script src="/assets/js/runtime~main.32fc6d5f.js" defer="defer"></script>
<script src="/assets/js/main.5385b353.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">ğŸ«µğŸ«µğŸ«µ  è­¦é’Ÿé•¿é¸£ï¼å°Šçºªå®ˆæ³•ï¼Œæ‹’ç»ç§‘å­¦ä¸Šç½‘ï¼Œæ‹’ç»ä¼ æ’­è¿æ³•ä¿¡æ¯ï¼›å¦‚æœ‰å‘ç°ï¼Œè¯·ç«‹å³æ‹¨æ‰“ 110 !  ğŸ«µğŸ«µğŸ«µ</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="https://schema.org/Blog"><header class="margin-bottom--xl"><h1>9 posts tagged with &quot;Linux&quot;</h1><a href="/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="ä» inode äº†è§£ Linux æ–‡ä»¶ç³»ç»Ÿ"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2016/03/18/li-jie-linux-de-ying-lian-jie-yu-ruan-lian-jie">ç†è§£ Linux çš„ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-03-18T14:52:13.000Z" itemprop="datePublished">March 18, 2016</time></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä»-inode-äº†è§£-linux-æ–‡ä»¶ç³»ç»Ÿ">ä» inode äº†è§£ Linux æ–‡ä»¶ç³»ç»Ÿ<a href="#ä»-inode-äº†è§£-linux-æ–‡ä»¶ç³»ç»Ÿ" class="hash-link" aria-label="Direct link to ä» inode äº†è§£ Linux æ–‡ä»¶ç³»ç»Ÿ" title="Direct link to ä» inode äº†è§£ Linux æ–‡ä»¶ç³»ç»Ÿ">â€‹</a></h2>
<p>ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥æ˜¯ Linux æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå…¶æ¶‰åŠæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç´¢å¼•èŠ‚ç‚¹ (index node åˆç§° inode)ï¼Œè€Œç´¢å¼•èŠ‚ç‚¹å¯¹è±¡æ˜¯ Linux è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ (VFS) çš„å››ä¸ªåŸºæœ¬æ¦‚å¿µä¹‹ä¸€ã€‚é€šè¿‡å‰–æç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„è”ç³»ä¸åŒºåˆ«ï¼Œæˆ‘ä»¬å¯æ›´å¥½çš„äº†è§£ Linux ä¸­ VFS è¿™ä¸€é€šç”¨æ–‡ä»¶æ¨¡å‹ã€‚å¹¶è®© Linux æ™®é€šç”¨æˆ·å’Œç³»ç»Ÿç®¡ç†å‘˜æ­£ç¡®ä½¿ç”¨ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥ï¼Œå¸®åŠ©æ–‡ä»¶ç³»ç»Ÿå¼€å‘è€…è·å– inode çš„ç›¸å…³çŸ¥è¯†ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux-çš„æ–‡ä»¶ç³»ç»Ÿä¸ç›®å½•">Linux çš„æ–‡ä»¶ç³»ç»Ÿä¸ç›®å½•<a href="#linux-çš„æ–‡ä»¶ç³»ç»Ÿä¸ç›®å½•" class="hash-link" aria-label="Direct link to Linux çš„æ–‡ä»¶ç³»ç»Ÿä¸ç›®å½•" title="Direct link to Linux çš„æ–‡ä»¶ç³»ç»Ÿä¸ç›®å½•">â€‹</a></h3>
<p>ç°ä»£æ“ä½œç³»ç»Ÿä¸ºè§£å†³ä¿¡æ¯èƒ½ç‹¬ç«‹äºè¿›ç¨‹ä¹‹å¤–è¢«é•¿æœŸå­˜å‚¨å¼•å…¥äº†æ–‡ä»¶ï¼Œæ–‡ä»¶ä½œä¸ºè¿›ç¨‹åˆ›å»ºä¿¡æ¯çš„é€»è¾‘å•å…ƒå¯è¢«å¤šä¸ªè¿›ç¨‹å¹¶å‘ä½¿ç”¨ã€‚åœ¨ UNIX ç³»ç»Ÿä¸­ï¼Œæ“ä½œç³»ç»Ÿä¸ºç£ç›˜ä¸Šçš„æ–‡æœ¬ä¸å›¾åƒã€é¼ æ ‡ä¸é”®ç›˜ç­‰è¾“å…¥è®¾å¤‡åŠç½‘ç»œäº¤äº’ç­‰ I/O æ“ä½œè®¾è®¡äº†ä¸€ç»„é€šç”¨ APIï¼Œä½¿ä»–ä»¬è¢«å¤„ç†æ—¶å‡å¯ç»Ÿä¸€ä½¿ç”¨å­—èŠ‚æµæ–¹å¼ã€‚æ¢è¨€ä¹‹ï¼ŒUNIX ç³»ç»Ÿä¸­é™¤è¿›ç¨‹ä¹‹å¤–çš„ä¸€åˆ‡çš†æ˜¯æ–‡ä»¶ï¼Œè€Œ Linux ä¿æŒäº†è¿™ä¸€ç‰¹æ€§ã€‚ä¸ºäº†ä¾¿äºæ–‡ä»¶çš„ç®¡ç†ï¼ŒLinux è¿˜å¼•å…¥äº†ç›®å½•ï¼ˆæœ‰æ—¶äº¦è¢«ç§°ä¸ºæ–‡ä»¶å¤¹ï¼‰è¿™ä¸€æ¦‚å¿µã€‚ç›®å½•ä½¿æ–‡ä»¶å¯è¢«åˆ†ç±»ç®¡ç†ï¼Œä¸”ç›®å½•çš„å¼•å…¥ä½¿ Linux çš„æ–‡ä»¶ç³»ç»Ÿå½¢æˆä¸€ä¸ªå±‚çº§ç»“æ„çš„ç›®å½•æ ‘ã€‚<code>æ¸…å• 1</code>. æ‰€ç¤ºçš„æ˜¯æ™®é€š Linux ç³»ç»Ÿçš„é¡¶å±‚ç›®å½•ç»“æ„ï¼Œå…¶ä¸­ /dev æ˜¯å­˜æ”¾äº†è®¾å¤‡ç›¸å…³æ–‡ä»¶çš„ç›®å½•ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-1-linux-ç³»ç»Ÿçš„é¡¶å±‚ç›®å½•ç»“æ„">æ¸…å• 1. Linux ç³»ç»Ÿçš„é¡¶å±‚ç›®å½•ç»“æ„<a href="#æ¸…å•-1-linux-ç³»ç»Ÿçš„é¡¶å±‚ç›®å½•ç»“æ„" class="hash-link" aria-label="Direct link to æ¸…å• 1. Linux ç³»ç»Ÿçš„é¡¶å±‚ç›®å½•ç»“æ„" title="Direct link to æ¸…å• 1. Linux ç³»ç»Ÿçš„é¡¶å±‚ç›®å½•ç»“æ„">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /              æ ¹ç›®å½•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ bin     å­˜æ”¾ç”¨æˆ·äºŒè¿›åˆ¶æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ boot    å­˜æ”¾å†…æ ¸å¼•å¯¼é…ç½®æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ dev     å­˜æ”¾è®¾å¤‡æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ etc     å­˜æ”¾ç³»ç»Ÿé…ç½®æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ home    ç”¨æˆ·ä¸»ç›®å½•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ lib     åŠ¨æ€å…±äº«åº“</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ lost+found  æ–‡ä»¶ç³»ç»Ÿæ¢å¤æ—¶çš„æ¢å¤æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ media   å¯å¸è½½å­˜å‚¨ä»‹è´¨æŒ‚è½½ç‚¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ mnt     æ–‡ä»¶ç³»ç»Ÿä¸´æ—¶æŒ‚è½½ç‚¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ opt     é™„åŠ çš„åº”ç”¨ç¨‹åºåŒ…</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ proc    ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ç›®å½•ï¼Œæä¾›å†…æ ¸ä¸è¿›ç¨‹ä¿¡æ¯</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ root    root ç”¨æˆ·ä¸»ç›®å½•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ sbin    å­˜æ”¾ç³»ç»ŸäºŒè¿›åˆ¶æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ srv     å­˜æ”¾æœåŠ¡ç›¸å…³æ•°æ®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ sys     sys è™šæ‹Ÿæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ tmp     å­˜æ”¾ä¸´æ—¶æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ usr     å­˜æ”¾ç”¨æˆ·åº”ç”¨ç¨‹åº</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â””â”€â”€ var     å­˜æ”¾é‚®ä»¶ã€ç³»ç»Ÿæ—¥å¿—ç­‰å˜åŒ–æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Linux å°†è®¾å¤‡å½“åšæ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œ<code>æ¸…å• 2</code>å±•ç¤ºäº†å¦‚ä½•æ‰“å¼€è®¾å¤‡æ–‡ä»¶ /dev/input/event5 å¹¶è¯»å–æ–‡ä»¶å†…å®¹ã€‚æ–‡ä»¶ event5 è¡¨ç¤ºä¸€ç§è¾“å…¥è®¾å¤‡ï¼Œå…¶å¯èƒ½æ˜¯é¼ æ ‡æˆ–é”®ç›˜ç­‰ã€‚æŸ¥çœ‹æ–‡ä»¶ /proc/bus/input/devices å¯çŸ¥ event5  å¯¹åº”è®¾å¤‡çš„ç±»å‹ã€‚è®¾å¤‡æ–‡ä»¶ /dev/input/event5 ä½¿ç”¨ read() ä»¥å­—ç¬¦æµçš„æ–¹å¼è¢«è¯»å–ã€‚ç»“æ„ä½“ input_event è¢«å®šä¹‰åœ¨å†…æ ¸å¤´æ–‡ä»¶ linux/input.h ä¸­ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-2--æ‰“å¼€å¹¶è¯»å–è®¾å¤‡æ–‡ä»¶">æ¸…å• 2.  æ‰“å¼€å¹¶è¯»å–è®¾å¤‡æ–‡ä»¶<a href="#æ¸…å•-2--æ‰“å¼€å¹¶è¯»å–è®¾å¤‡æ–‡ä»¶" class="hash-link" aria-label="Direct link to æ¸…å• 2.  æ‰“å¼€å¹¶è¯»å–è®¾å¤‡æ–‡ä»¶" title="Direct link to æ¸…å• 2.  æ‰“å¼€å¹¶è¯»å–è®¾å¤‡æ–‡ä»¶">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> int fd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> struct input_event ie</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> fd </span><span class="token operator">=</span><span class="token plain"> open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/dev/input/event5&quot;</span><span class="token plain">, O_RDONLY</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> read</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fd, </span><span class="token operator">&amp;</span><span class="token plain">ie, sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">struct input_event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">))</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;type = %d  code = %d  value = %d</span><span class="token string entity" style="color:rgb(255, 121, 198)">\n</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ie.type, ie.code, ie.value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> close</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„è”ç³»ä¸åŒºåˆ«">ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„è”ç³»ä¸åŒºåˆ«<a href="#ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„è”ç³»ä¸åŒºåˆ«" class="hash-link" aria-label="Direct link to ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„è”ç³»ä¸åŒºåˆ«" title="Direct link to ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„è”ç³»ä¸åŒºåˆ«">â€‹</a></h3>
<p>æˆ‘ä»¬çŸ¥é“æ–‡ä»¶éƒ½æœ‰æ–‡ä»¶åä¸æ•°æ®ï¼Œè¿™åœ¨ Linux ä¸Šè¢«åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šç”¨æˆ·æ•°æ® (user data) ä¸å…ƒæ•°æ® (metadata)ã€‚ç”¨æˆ·æ•°æ®ï¼Œå³æ–‡ä»¶æ•°æ®å— (data block)ï¼Œæ•°æ®å—æ˜¯è®°å½•æ–‡ä»¶çœŸå®å†…å®¹çš„åœ°æ–¹ï¼›è€Œå…ƒæ•°æ®åˆ™æ˜¯æ–‡ä»¶çš„é™„åŠ å±æ€§ï¼Œå¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ã€æ‰€æœ‰è€…ç­‰ä¿¡æ¯ã€‚åœ¨ Linux ä¸­ï¼Œå…ƒæ•°æ®ä¸­çš„ inode å·ï¼ˆinode æ˜¯æ–‡ä»¶å…ƒæ•°æ®çš„ä¸€éƒ¨åˆ†ä½†å…¶å¹¶ä¸åŒ…å«æ–‡ä»¶åï¼Œinode å·å³ç´¢å¼•èŠ‚ç‚¹å·ï¼‰æ‰æ˜¯æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†è€Œéæ–‡ä»¶åã€‚æ–‡ä»¶åä»…æ˜¯ä¸ºäº†æ–¹ä¾¿äººä»¬çš„è®°å¿†å’Œä½¿ç”¨ï¼Œç³»ç»Ÿæˆ–ç¨‹åºé€šè¿‡ inode å·å¯»æ‰¾æ­£ç¡®çš„æ–‡ä»¶æ•°æ®å—ã€‚<code>å›¾ 1.</code>å±•ç¤ºäº†ç¨‹åºé€šè¿‡æ–‡ä»¶åè·å–æ–‡ä»¶å†…å®¹çš„è¿‡ç¨‹ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å›¾-1-é€šè¿‡æ–‡ä»¶åæ‰“å¼€æ–‡ä»¶">å›¾ 1. é€šè¿‡æ–‡ä»¶åæ‰“å¼€æ–‡ä»¶<a href="#å›¾-1-é€šè¿‡æ–‡ä»¶åæ‰“å¼€æ–‡ä»¶" class="hash-link" aria-label="Direct link to å›¾ 1. é€šè¿‡æ–‡ä»¶åæ‰“å¼€æ–‡ä»¶" title="Direct link to å›¾ 1. é€šè¿‡æ–‡ä»¶åæ‰“å¼€æ–‡ä»¶">â€‹</a></h4>
<p><img loading="lazy" src="http://120.24.251.209/content/images/2016/03/image001.jpg" alt="image" class="img_ev3q"></p>
<p>åœ¨ Linux ç³»ç»Ÿä¸­æŸ¥çœ‹ inode å·å¯ä½¿ç”¨å‘½ä»¤ stat æˆ– ls -iï¼ˆè‹¥æ˜¯ AIX ç³»ç»Ÿï¼Œåˆ™ä½¿ç”¨å‘½ä»¤ istatï¼‰ã€‚<code>æ¸…å• 3.</code>ä¸­ä½¿ç”¨å‘½ä»¤ mv ç§»åŠ¨å¹¶é‡å‘½åæ–‡ä»¶ glibc-2.16.0.tar.xzï¼Œå…¶ç»“æœä¸å½±å“æ–‡ä»¶çš„ç”¨æˆ·æ•°æ®åŠ inode å·ï¼Œæ–‡ä»¶ç§»åŠ¨å‰å inode å·å‡ä¸ºï¼š2485677ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-3--ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶">æ¸…å• 3.  ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶<a href="#æ¸…å•-3--ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶" class="hash-link" aria-label="Direct link to æ¸…å• 3.  ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶" title="Direct link to æ¸…å• 3.  ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># stat /home/harris/source/glibc-2.16.0.tar.xz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  File: `/home/harris/source/glibc-2.16.0.tar.xz&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Size: </span><span class="token number">9990512</span><span class="token plain">     Blocks: </span><span class="token number">19520</span><span class="token plain">      IO Block: </span><span class="token number">4096</span><span class="token plain">   regular </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Device: 807h/2055d   Inode: </span><span class="token number">2485677</span><span class="token plain">     Links: </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Access: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">0600/-rw-------</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  Uid: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token number">1000</span><span class="token plain">/  harris</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">   Gid: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token number">1000</span><span class="token plain">/  harris</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// ç»ç½‘å‹æŒ‡å‡ºï¼Œä½¿ç”¨mvç§»åŠ¨æ—¶ä¸è·¨ç£ç›˜inodeå·ä¸å˜ï¼Œå¦‚æœè·¨ç£ç›˜inodeä¼šæ”¹å˜ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># mv /home/harris/source/glibc-2.16.0.tar.xz /home/harris/Desktop/glibc.tar.xz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># ls -i -F /home/harris/Desktop/glibc.tar.xz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">2485677</span><span class="token plain"> /home/harris/Desktop/glibc.tar.xz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸ºè§£å†³æ–‡ä»¶çš„å…±äº«ä½¿ç”¨ï¼ŒLinux ç³»ç»Ÿå¼•å…¥äº†ä¸¤ç§é“¾æ¥ï¼šç¡¬é“¾æ¥ (hard link) ä¸è½¯é“¾æ¥ï¼ˆåˆç§°ç¬¦å·é“¾æ¥ï¼Œå³ soft link æˆ– symbolic linkï¼‰ã€‚é“¾æ¥ä¸º Linux ç³»ç»Ÿè§£å†³äº†æ–‡ä»¶çš„å…±äº«ä½¿ç”¨ï¼Œè¿˜å¸¦æ¥äº†éšè—æ–‡ä»¶è·¯å¾„ã€å¢åŠ æƒé™å®‰å…¨åŠèŠ‚çœå­˜å‚¨ç­‰å¥½å¤„ã€‚è‹¥ä¸€ä¸ª inode å·å¯¹åº”å¤šä¸ªæ–‡ä»¶åï¼Œåˆ™ç§°è¿™äº›æ–‡ä»¶ä¸ºç¡¬é“¾æ¥ã€‚æ¢è¨€ä¹‹ï¼Œç¡¬é“¾æ¥å°±æ˜¯åŒä¸€ä¸ªæ–‡ä»¶ä½¿ç”¨äº†å¤šä¸ªåˆ«åï¼ˆè§ <code>å›¾ 2.</code>hard link å°±æ˜¯ file çš„ä¸€ä¸ªåˆ«åï¼Œä»–ä»¬æœ‰å…±åŒçš„ inodeï¼‰ã€‚ç¡¬é“¾æ¥å¯ç”±å‘½ä»¤ link æˆ– ln åˆ›å»ºã€‚å¦‚ä¸‹æ˜¯å¯¹æ–‡ä»¶ oldfile åˆ›å»ºç¡¬é“¾æ¥ã€‚</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> oldfile newfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ln</span><span class="token plain"> oldfile newfile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç”±äºç¡¬é“¾æ¥æ˜¯æœ‰ç€ç›¸åŒ inode å·ä»…æ–‡ä»¶åä¸åŒçš„æ–‡ä»¶ï¼Œå› æ­¤ç¡¬é“¾æ¥å­˜åœ¨ä»¥ä¸‹å‡ ç‚¹ç‰¹æ€§ï¼š</p>
<ul>
<li>æ–‡ä»¶æœ‰ç›¸åŒçš„ inode åŠ data blockï¼›</li>
<li>åªèƒ½å¯¹å·²å­˜åœ¨çš„æ–‡ä»¶è¿›è¡Œåˆ›å»ºï¼›</li>
<li>ä¸èƒ½äº¤å‰æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œç¡¬é“¾æ¥çš„åˆ›å»ºï¼›</li>
<li>ä¸èƒ½å¯¹ç›®å½•è¿›è¡Œåˆ›å»ºï¼Œåªå¯å¯¹æ–‡ä»¶åˆ›å»ºï¼›</li>
<li>åˆ é™¤ä¸€ä¸ªç¡¬é“¾æ¥æ–‡ä»¶å¹¶ä¸å½±å“å…¶ä»–æœ‰ç›¸åŒ inode å·çš„æ–‡ä»¶ã€‚</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-4--ç¡¬é“¾æ¥ç‰¹æ€§å±•ç¤º">æ¸…å• 4.  ç¡¬é“¾æ¥ç‰¹æ€§å±•ç¤º<a href="#æ¸…å•-4--ç¡¬é“¾æ¥ç‰¹æ€§å±•ç¤º" class="hash-link" aria-label="Direct link to æ¸…å• 4.  ç¡¬é“¾æ¥ç‰¹æ€§å±•ç¤º" title="Direct link to æ¸…å• 4.  ç¡¬é“¾æ¥ç‰¹æ€§å±•ç¤º">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ls -li</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> total </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // åªèƒ½å¯¹å·²å­˜åœ¨çš„æ–‡ä»¶åˆ›å»ºç¡¬è¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># link old.file hard.link</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> link: cannot create </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">hard.link&#x27; to </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token plain">old.file</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;: No such file or directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> # echo &quot;This is an original file&quot; &gt; old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> # cat old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> This is an original file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> # stat old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  File: `old.file&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Size: </span><span class="token number">25</span><span class="token plain">          Blocks: </span><span class="token number">8</span><span class="token plain">          IO Block: </span><span class="token number">4096</span><span class="token plain">   regular </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Device: 807h/2055d   Inode: </span><span class="token number">660650</span><span class="token plain">      Links: </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Access: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">0644/-rw-r--r--</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  Uid: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">    </span><span class="token number">0</span><span class="token plain">/    root</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">   Gid: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">    </span><span class="token number">0</span><span class="token plain">/    root</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // æ–‡ä»¶æœ‰ç›¸åŒçš„ inode å·ä»¥åŠ data block</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># link old.file hard.link | ls -li</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> total </span><span class="token number">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">660650</span><span class="token plain"> -rw-r--r-- </span><span class="token number">2</span><span class="token plain"> root root </span><span class="token number">25</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">17</span><span class="token plain">:44 hard.link</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">660650</span><span class="token plain"> -rw-r--r-- </span><span class="token number">2</span><span class="token plain"> root root </span><span class="token number">25</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">17</span><span class="token plain">:44 old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // ä¸èƒ½äº¤å‰æ–‡ä»¶ç³»ç»Ÿ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># ln /dev/input/event5 /root/bfile.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ln: failed to create hard </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">/root/bfile.txt&#x27; </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">=</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">&gt;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token plain">/dev/input/event5</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> Invalid cross-device link</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> // ä¸èƒ½å¯¹ç›®å½•è¿›è¡Œåˆ›å»ºç¡¬è¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> # mkdir -p old.dir/test</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> # ln old.dir/ hardlink.dir</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"> ln: `old.dir/&#x27;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> hard </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> not allowed </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># ls -iF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">660650</span><span class="token plain"> hard.link  </span><span class="token number">657948</span><span class="token plain"> old.dir/  </span><span class="token number">660650</span><span class="token plain"> old.file</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ–‡ä»¶ old.file ä¸ hard.link æœ‰ç€ç›¸åŒçš„ inode å·ï¼š660650 åŠæ–‡ä»¶æƒé™ï¼Œinode æ˜¯éšç€æ–‡ä»¶çš„å­˜åœ¨è€Œå­˜åœ¨ï¼Œå› æ­¤åªæœ‰å½“æ–‡ä»¶å­˜åœ¨æ—¶æ‰å¯åˆ›å»ºç¡¬é“¾æ¥ï¼Œå³å½“ inode å­˜åœ¨ä¸”é“¾æ¥è®¡æ•°å™¨ï¼ˆlink countï¼‰ä¸ä¸º 0 æ—¶ã€‚inode å·ä»…åœ¨å„æ–‡ä»¶ç³»ç»Ÿä¸‹æ˜¯å”¯ä¸€çš„ï¼Œå½“ Linux æŒ‚è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿåå°†å‡ºç° inode å·é‡å¤çš„ç°è±¡ï¼ˆå¦‚<code>æ¸…å• 5.</code>å±•ç¤ºäº†ä½¿ç”¨å‘½ä»¤ df æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€å„æ–‡ä»¶ç³»ç»Ÿ inode ä½¿ç”¨æƒ…å†µåŠæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-5--æŸ¥æ‰¾æœ‰ç›¸åŒ-inode-å·çš„æ–‡ä»¶">æ¸…å• 5.  æŸ¥æ‰¾æœ‰ç›¸åŒ inode å·çš„æ–‡ä»¶<a href="#æ¸…å•-5--æŸ¥æ‰¾æœ‰ç›¸åŒ-inode-å·çš„æ–‡ä»¶" class="hash-link" aria-label="Direct link to æ¸…å• 5.  æŸ¥æ‰¾æœ‰ç›¸åŒ inode å·çš„æ–‡ä»¶" title="Direct link to æ¸…å• 5.  æŸ¥æ‰¾æœ‰ç›¸åŒ inode å·çš„æ–‡ä»¶">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># df -i --print-type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Filesystem     Type       Inodes  IUsed    IFree IUse% Mounted on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /dev/sda7      ext4      </span><span class="token number">3147760</span><span class="token plain"> </span><span class="token number">283483</span><span class="token plain">  </span><span class="token number">2864277</span><span class="token plain">   </span><span class="token number">10</span><span class="token plain">% /</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> udev           devtmpfs   </span><span class="token number">496088</span><span class="token plain">    </span><span class="token number">553</span><span class="token plain">   </span><span class="token number">495535</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">% /dev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> tmpfs          tmpfs      </span><span class="token number">499006</span><span class="token plain">    </span><span class="token number">491</span><span class="token plain">   </span><span class="token number">498515</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">% /run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> none           tmpfs      </span><span class="token number">499006</span><span class="token plain">      </span><span class="token number">3</span><span class="token plain">   </span><span class="token number">499003</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">% /run/lock</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> none           tmpfs      </span><span class="token number">499006</span><span class="token plain">     </span><span class="token number">15</span><span class="token plain">   </span><span class="token number">498991</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">% /run/shm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /dev/sda6      fuseblk  </span><span class="token number">74383900</span><span class="token plain">   </span><span class="token number">4786</span><span class="token plain"> </span><span class="token number">74379114</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">% /media/DiskE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /dev/sda8      fuseblk  </span><span class="token number">29524592</span><span class="token plain">  </span><span class="token number">19939</span><span class="token plain"> </span><span class="token number">29504653</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">% /media/DiskF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># find / -inum 1114</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /media/DiskE/Pictures/t3.jpg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /media/DiskF/123.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /bin/sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒLinux ç³»ç»Ÿå­˜åœ¨ inode å·è¢«ç”¨å®Œä½†ç£ç›˜ç©ºé—´è¿˜æœ‰å‰©ä½™çš„æƒ…å†µã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª 5M å¤§å°çš„ ext4 ç±»å‹çš„ mo.img æ–‡ä»¶ï¼Œå¹¶å°†å…¶æŒ‚è½½è‡³ç›®å½• /mntã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª shell è„šæœ¬å°†æŒ‚è½½åœ¨ /mnt ä¸‹ ext4 æ–‡ä»¶ç³»ç»Ÿçš„ indoe è€—å°½ï¼ˆè§<code>æ¸…å• 6.</code>ï¼‰ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-6--æµ‹è¯•æ–‡ä»¶ç³»ç»Ÿ-inode-è€—å°½ä½†ä»æœ‰ç£ç›˜ç©ºé—´çš„æƒ…æ™¯">æ¸…å• 6.  æµ‹è¯•æ–‡ä»¶ç³»ç»Ÿ inode è€—å°½ä½†ä»æœ‰ç£ç›˜ç©ºé—´çš„æƒ…æ™¯<a href="#æ¸…å•-6--æµ‹è¯•æ–‡ä»¶ç³»ç»Ÿ-inode-è€—å°½ä½†ä»æœ‰ç£ç›˜ç©ºé—´çš„æƒ…æ™¯" class="hash-link" aria-label="Direct link to æ¸…å• 6.  æµ‹è¯•æ–‡ä»¶ç³»ç»Ÿ inode è€—å°½ä½†ä»æœ‰ç£ç›˜ç©ºé—´çš„æƒ…æ™¯" title="Direct link to æ¸…å• 6.  æµ‹è¯•æ–‡ä»¶ç³»ç»Ÿ inode è€—å°½ä½†ä»æœ‰ç£ç›˜ç©ºé—´çš„æƒ…æ™¯">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># dd if=/dev/zero of=mo.img bs=5120k count=1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ls -lh mo.img</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> -rw-r--r-- </span><span class="token number">1</span><span class="token plain"> root root </span><span class="token number">5</span><span class="token plain">.0M Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">17</span><span class="token plain">:54 mo.img</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># mkfs -t ext4  -F ./mo.img</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> OS type: Linux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Block </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">size</span><span class="token operator">=</span><span class="token number">1024</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">log</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Fragment </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">size</span><span class="token operator">=</span><span class="token number">1024</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">log</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">Stride</span><span class="token operator">=</span><span class="token number">0</span><span class="token plain"> blocks, Stripe </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">width</span><span class="token operator">=</span><span class="token number">0</span><span class="token plain"> blocks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">1280</span><span class="token plain"> inodes, </span><span class="token number">5120</span><span class="token plain"> blocks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">256</span><span class="token plain"> blocks </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5.00</span><span class="token plain">%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> reserved </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> the super user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Writing superblocks and filesystem accounting information: </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># mount -o loop ./mo.img /mnt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># cat /mnt/inode_test.sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">((</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">i </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable number" style="color:rgb(189, 147, 249);font-style:italic">1</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> i</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">++</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$?</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-eq</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This is file_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$i</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> file_</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exit</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ./inode_test.sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ./inode_test.sh: line </span><span class="token number">6</span><span class="token plain">: file_1269: No space left on device</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># df -iT /mnt/; du -sh /mnt/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Filesystem     Type Inodes IUsed IFree IUse% Mounted on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /dev/loop0     ext4   </span><span class="token number">1280</span><span class="token plain">  </span><span class="token number">1280</span><span class="token plain">     </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">100</span><span class="token plain">% /mnt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">1</span><span class="token plain">.3M   /mnt/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç¡¬é“¾æ¥ä¸èƒ½å¯¹ç›®å½•åˆ›å»ºæ˜¯å—é™äºæ–‡ä»¶ç³»ç»Ÿçš„è®¾è®¡ï¼ˆè§ <code>æ¸…å• 4.</code>å¯¹ç›®å½•åˆ›å»ºç¡¬é“¾æ¥å°†å¤±è´¥ï¼‰ã€‚ç° Linux æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•å‡éšè—äº†ä¸¤ä¸ªä¸ªç‰¹æ®Šçš„ç›®å½•ï¼šå½“å‰ç›®å½•ï¼ˆ.ï¼‰ä¸çˆ¶ç›®å½•ï¼ˆ..ï¼‰ã€‚æŸ¥çœ‹è¿™ä¸¤ä¸ªç‰¹æ®Šç›®å½•çš„ inode å·å¯çŸ¥å…¶å®è¿™ä¸¤ç›®å½•å°±æ˜¯ä¸¤ä¸ªç¡¬é“¾æ¥ï¼ˆæ³¨æ„ç›®å½• /mnt/lost+found/ çš„ inode å·ï¼‰ã€‚è‹¥ç³»ç»Ÿå…è®¸å¯¹ç›®å½•åˆ›å»ºç¡¬é“¾æ¥ï¼Œåˆ™ä¼šäº§ç”Ÿç›®å½•ç¯ã€‚</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ls -aliF /mnt/lost+found</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> total </span><span class="token number">44</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">11</span><span class="token plain"> drwx------ </span><span class="token number">2</span><span class="token plain"> root root </span><span class="token number">12288</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">17</span><span class="token plain">:54 ./</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> drwxr-xr-x </span><span class="token number">3</span><span class="token plain"> root root </span><span class="token number">31744</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">17</span><span class="token plain">:57 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># stat  /mnt/lost+found/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  File: `/mnt/lost+found/&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Size: </span><span class="token number">12288</span><span class="token plain">       Blocks: </span><span class="token number">24</span><span class="token plain">         IO Block: </span><span class="token number">1024</span><span class="token plain">   directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Device: 700h/1792d   Inode: </span><span class="token number">11</span><span class="token plain">          Links: </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Access: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">0700/drwx------</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  Uid: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">    </span><span class="token number">0</span><span class="token plain">/    root</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">   Gid: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">    </span><span class="token number">0</span><span class="token plain">/    root</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Access: </span><span class="token number">2012</span><span class="token plain">-09-01 </span><span class="token number">17</span><span class="token plain">:57:17.000000000 +0800</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Modify: </span><span class="token number">2012</span><span class="token plain">-09-01 </span><span class="token number">17</span><span class="token plain">:54:49.000000000 +0800</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Change: </span><span class="token number">2012</span><span class="token plain">-09-01 </span><span class="token number">17</span><span class="token plain">:54:49.000000000 +0800</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Birth: -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è½¯é“¾æ¥ä¸ç¡¬é“¾æ¥ä¸åŒï¼Œè‹¥æ–‡ä»¶ç”¨æˆ·æ•°æ®å—ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯å¦ä¸€æ–‡ä»¶çš„è·¯å¾„åçš„æŒ‡å‘ï¼Œåˆ™è¯¥æ–‡ä»¶å°±æ˜¯è½¯è¿æ¥ã€‚è½¯é“¾æ¥å°±æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œåªæ˜¯æ•°æ®å—å†…å®¹æœ‰ç‚¹ç‰¹æ®Šã€‚è½¯é“¾æ¥æœ‰ç€è‡ªå·±çš„ inode å·ä»¥åŠç”¨æˆ·æ•°æ®å—ï¼ˆè§ <code>å›¾ 2.</code>ï¼‰ã€‚å› æ­¤è½¯é“¾æ¥çš„åˆ›å»ºä¸ä½¿ç”¨æ²¡æœ‰ç±»ä¼¼ç¡¬é“¾æ¥çš„è¯¸å¤šé™åˆ¶ï¼š</p>
<ul>
<li>è½¯é“¾æ¥æœ‰è‡ªå·±çš„æ–‡ä»¶å±æ€§åŠæƒé™ç­‰ï¼›</li>
<li>å¯å¯¹ä¸å­˜åœ¨çš„æ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºè½¯é“¾æ¥ï¼›</li>
<li>è½¯é“¾æ¥å¯äº¤å‰æ–‡ä»¶ç³»ç»Ÿï¼›</li>
<li>è½¯é“¾æ¥å¯å¯¹æ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºï¼›</li>
<li>åˆ›å»ºè½¯é“¾æ¥æ—¶ï¼Œé“¾æ¥è®¡æ•° i_nlink ä¸ä¼šå¢åŠ ï¼›</li>
<li>åˆ é™¤è½¯é“¾æ¥å¹¶ä¸å½±å“è¢«æŒ‡å‘çš„æ–‡ä»¶ï¼Œä½†è‹¥è¢«æŒ‡å‘çš„åŸæ–‡ä»¶è¢«åˆ é™¤ï¼Œåˆ™ç›¸å…³è½¯è¿æ¥è¢«ç§°ä¸ºæ­»é“¾æ¥ï¼ˆå³ dangling linkï¼Œè‹¥è¢«æŒ‡å‘è·¯å¾„æ–‡ä»¶è¢«é‡æ–°åˆ›å»ºï¼Œæ­»é“¾æ¥å¯æ¢å¤ä¸ºæ­£å¸¸çš„è½¯é“¾æ¥ï¼‰ã€‚</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å›¾-2-è½¯é“¾æ¥çš„è®¿é—®">å›¾ 2. è½¯é“¾æ¥çš„è®¿é—®<a href="#å›¾-2-è½¯é“¾æ¥çš„è®¿é—®" class="hash-link" aria-label="Direct link to å›¾ 2. è½¯é“¾æ¥çš„è®¿é—®" title="Direct link to å›¾ 2. è½¯é“¾æ¥çš„è®¿é—®">â€‹</a></h4>
<p><img loading="lazy" src="http://120.24.251.209/content/images/2016/03/image002.jpg" alt="image" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-7-è½¯é“¾æ¥ç‰¹æ€§å±•ç¤º">æ¸…å• 7. è½¯é“¾æ¥ç‰¹æ€§å±•ç¤º<a href="#æ¸…å•-7-è½¯é“¾æ¥ç‰¹æ€§å±•ç¤º" class="hash-link" aria-label="Direct link to æ¸…å• 7. è½¯é“¾æ¥ç‰¹æ€§å±•ç¤º" title="Direct link to æ¸…å• 7. è½¯é“¾æ¥ç‰¹æ€§å±•ç¤º">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ls -li</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> total </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // å¯å¯¹ä¸å­˜åœ¨çš„æ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ln -s old.file soft.link</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ls -liF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> total </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">789467</span><span class="token plain"> lrwxrwxrwx </span><span class="token number">1</span><span class="token plain"> root root </span><span class="token number">8</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">18</span><span class="token plain">:00 soft.link -</span><span class="token operator">&gt;</span><span class="token plain"> old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // ç”±äºè¢«æŒ‡å‘çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ­¤æ—¶çš„è½¯é“¾æ¥ soft.link å°±æ˜¯æ­»é“¾æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># cat soft.link</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> cat: soft.link: No such </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> or directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // åˆ›å»ºè¢«æŒ‡å‘çš„æ–‡ä»¶ old.fileï¼Œsoft.link æ¢å¤æˆæ­£å¸¸çš„è½¯é“¾æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># echo &quot;This is an original file_A&quot; &gt;&gt; old.file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># cat soft.link</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> This is an original file_A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // å¯¹ä¸å­˜åœ¨çš„ç›®å½•åˆ›å»ºè½¯é“¾æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ln -s old.dir soft.link.dir</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># mkdir -p old.dir/test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># tree . -F --inodes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€  â”€ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token number">789497</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  old.dir/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚   â””â”€â”€ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token number">789498</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  test/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token number">789495</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token number">789495</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  soft.link -</span><span class="token operator">&gt;</span><span class="token plain"> old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â””â”€â”€ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token number">789497</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  soft.link.dir -</span><span class="token operator">&gt;</span><span class="token plain"> old.dir/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“ç„¶è½¯é“¾æ¥çš„ç”¨æˆ·æ•°æ®ä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªè½¯é“¾æ¥çš„è·¯å¾„ï¼Œå…¶è§£æè¿‡ç¨‹æ˜¯é€’å½’çš„ã€‚ä½†éœ€æ³¨æ„ï¼šè½¯é“¾æ¥åˆ›å»ºæ—¶åŸæ–‡ä»¶çš„è·¯å¾„æŒ‡å‘ä½¿ç”¨ç»å¯¹è·¯å¾„è¾ƒå¥½ã€‚ä½¿ç”¨ç›¸å¯¹è·¯å¾„åˆ›å»ºçš„è½¯é“¾æ¥è¢«ç§»åŠ¨åè¯¥è½¯é“¾æ¥æ–‡ä»¶å°†æˆä¸ºä¸€ä¸ªæ­»é“¾æ¥ï¼ˆå¦‚ä¸‹æ‰€ç¤ºçš„è½¯é“¾æ¥ a ä½¿ç”¨äº†ç›¸å¯¹è·¯å¾„ï¼Œå› æ­¤ä¸å®œè¢«ç§»åŠ¨ï¼‰ï¼Œå› ä¸ºé“¾æ¥æ•°æ®å—ä¸­è®°å½•çš„äº¦æ˜¯ç›¸å¯¹è·¯å¾„æŒ‡å‘ã€‚</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> $ </span><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-li</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> total </span><span class="token number">2136</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">656627</span><span class="token plain"> lrwxrwxrwx </span><span class="token number">1</span><span class="token plain"> harris harris       </span><span class="token number">8</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:37 a -</span><span class="token operator">&gt;</span><span class="token plain"> data.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">656662</span><span class="token plain"> lrwxrwxrwx </span><span class="token number">1</span><span class="token plain"> harris harris       </span><span class="token number">1</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:37 b -</span><span class="token operator">&gt;</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">656228</span><span class="token plain"> -rw------- </span><span class="token number">1</span><span class="token plain"> harris harris </span><span class="token number">2186738</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:37 data.txt </span><span class="token number">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é“¾æ¥ç›¸å…³çš„å‘½ä»¤">é“¾æ¥ç›¸å…³çš„å‘½ä»¤<a href="#é“¾æ¥ç›¸å…³çš„å‘½ä»¤" class="hash-link" aria-label="Direct link to é“¾æ¥ç›¸å…³çš„å‘½ä»¤" title="Direct link to é“¾æ¥ç›¸å…³çš„å‘½ä»¤">â€‹</a></h3>
<p>åœ¨ Linux ä¸­æŸ¥çœ‹å½“å‰ç³»ç»Ÿå·²æŒ‚ç€çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œé™¤ä¸Šè¿°ä½¿ç”¨çš„å‘½ä»¤ dfï¼Œè¿˜å¯ä½¿ç”¨å‘½ä»¤ mount æˆ–æŸ¥çœ‹æ–‡ä»¶ /proc/mountsã€‚</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># mount</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /dev/sda7 on / </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> ext4 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rw,errors</span><span class="token operator">=</span><span class="token plain">remount-ro</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> proc on /proc </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> proc </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rw,noexec,nosuid,nodev</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> sysfs on /sys </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> sysfs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rw,noexec,nosuid,nodev</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> none on /run/shm </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> tmpfs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rw,nosuid,nodev</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å‘½ä»¤ ls æˆ– stat å¯å¸®åŠ©æˆ‘ä»¬åŒºåˆ†è½¯é“¾æ¥ä¸å…¶ä»–æ–‡ä»¶å¹¶æŸ¥çœ‹æ–‡ä»¶ inode å·ï¼Œä½†è¾ƒå¥½çš„æ–¹å¼è¿˜æ˜¯ä½¿ç”¨ find å‘½ä»¤ï¼Œå…¶ä¸ä»…å¯æŸ¥æ‰¾æŸæ–‡ä»¶çš„è½¯é“¾æ¥ï¼Œè¿˜å¯ä»¥ç”¨äºæŸ¥æ‰¾ç›¸åŒ inode çš„æ‰€æœ‰ç¡¬é“¾æ¥ã€‚ï¼ˆè§ <code>æ¸…å• 8.</code>ï¼‰</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-8-ä½¿ç”¨å‘½ä»¤-find-æŸ¥æ‰¾è½¯é“¾æ¥ä¸ç¡¬é“¾æ¥">æ¸…å• 8. ä½¿ç”¨å‘½ä»¤ find æŸ¥æ‰¾è½¯é“¾æ¥ä¸ç¡¬é“¾æ¥<a href="#æ¸…å•-8-ä½¿ç”¨å‘½ä»¤-find-æŸ¥æ‰¾è½¯é“¾æ¥ä¸ç¡¬é“¾æ¥" class="hash-link" aria-label="Direct link to æ¸…å• 8. ä½¿ç”¨å‘½ä»¤ find æŸ¥æ‰¾è½¯é“¾æ¥ä¸ç¡¬é“¾æ¥" title="Direct link to æ¸…å• 8. ä½¿ç”¨å‘½ä»¤ find æŸ¥æ‰¾è½¯é“¾æ¥ä¸ç¡¬é“¾æ¥">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// æŸ¥æ‰¾åœ¨è·¯å¾„ /home ä¸‹çš„æ–‡ä»¶ data.txt çš„è½¯é“¾æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># find /home -lname data.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /home/harris/debug/test2/a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // æŸ¥çœ‹è·¯å¾„ /home æœ‰ç›¸åŒ inode çš„æ‰€æœ‰ç¡¬é“¾æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># find /home -samefile /home/harris/debug/test3/old.file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /home/harris/debug/test3/hard.link</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /home/harris/debug/test3/old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># find /home -inum 660650</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /home/harris/debug/test3/hard.link</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /home/harris/debug/test3/old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // åˆ—å‡ºè·¯å¾„ /home/harris/debug/ ä¸‹çš„æ‰€æœ‰è½¯é“¾æ¥æ–‡ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># find /home/harris/debug/ -type l -ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">656662</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> lrwxrwxrwx </span><span class="token number">1</span><span class="token plain"> harris harris </span><span class="token number">1</span><span class="token plain"> Sep </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:37 /home/harris/debug/test2/b -</span><span class="token operator">&gt;</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">656627</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> lrwxrwxrwx </span><span class="token number">1</span><span class="token plain"> harris harris </span><span class="token number">8</span><span class="token plain"> Sep </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">:37 /home/harris/debug/test2/a -</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> data.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">789467</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> lrwxrwxrwx </span><span class="token number">1</span><span class="token plain"> root root </span><span class="token number">8</span><span class="token plain"> Sep </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">18</span><span class="token plain">:00 /home/harris/debug/test/soft.link -</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> old.file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">789496</span><span class="token plain">    </span><span class="token number">0</span><span class="token plain"> lrwxrwxrwx   </span><span class="token number">1</span><span class="token plain"> root     root            </span><span class="token number">7</span><span class="token plain"> Sep  </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">18</span><span class="token plain">:01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> /home/harris/debug/test/soft.link.dir -</span><span class="token operator">&gt;</span><span class="token plain"> old.dir</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç³»ç»Ÿæ ¹æ®ç£ç›˜çš„å¤§å°é»˜è®¤è®¾å®šäº† inode çš„å€¼ï¼ˆè§<code>æ¸…å• 9.</code>ï¼‰ï¼Œå¦‚è‹¥å¿…è¦ï¼Œå¯åœ¨æ ¼å¼æ–‡ä»¶ç³»ç»Ÿå‰å¯¹è¯¥å€¼è¿›è¡Œä¿®æ”¹ã€‚å¦‚é”®å…¥å‘½ä»¤ mkfs -t ext4 -I 512/dev/sda4ï¼Œå°†ä½¿ç£ç›˜è®¾å¤‡ /dev/sda4 æ ¼å¼æˆ inode å¤§å°æ˜¯ 512 å­—èŠ‚çš„ ext4 æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-9-æŸ¥çœ‹ç³»ç»Ÿçš„-inode-å€¼">æ¸…å• 9. æŸ¥çœ‹ç³»ç»Ÿçš„ inode å€¼<a href="#æ¸…å•-9-æŸ¥çœ‹ç³»ç»Ÿçš„-inode-å€¼" class="hash-link" aria-label="Direct link to æ¸…å• 9. æŸ¥çœ‹ç³»ç»Ÿçš„ inode å€¼" title="Direct link to æ¸…å• 9. æŸ¥çœ‹ç³»ç»Ÿçš„ inode å€¼">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // æŸ¥çœ‹ç£ç›˜åˆ†åŒº /dev/sda7 ä¸Šçš„ inode å€¼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># dumpe2fs -h /dev/sda7 | grep &quot;Inode size&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> dumpe2fs </span><span class="token number">1.42</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">29</span><span class="token plain">-Nov-2011</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Inode size:            </span><span class="token number">256</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># tune2fs -l /dev/sda7 | grep &quot;Inode size&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Inode size:            </span><span class="token number">256</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux-vfs">Linux VFS<a href="#linux-vfs" class="hash-link" aria-label="Direct link to Linux VFS" title="Direct link to Linux VFS">â€‹</a></h3>
<p>Linux æœ‰ç€æå…¶ä¸°å¯Œçš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¤§ä½“ä¸Šå¯åˆ†å¦‚ä¸‹å‡ ç±»ï¼š</p>
<ol>
<li>ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ nfsã€cifs ç­‰ï¼›</li>
<li>ç£ç›˜æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ ext4ã€ext3 ç­‰ï¼›</li>
<li>ç‰¹æ®Šæ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ procã€sysfsã€ramfsã€tmpfs ç­‰ã€‚</li>
</ol>
<p>å®ç°ä»¥ä¸Šè¿™äº›æ–‡ä»¶ç³»ç»Ÿå¹¶åœ¨ Linux ä¸‹å…±å­˜çš„åŸºç¡€å°±æ˜¯ Linux VFSï¼ˆVirtual File System åˆç§° Virtual Filesystem Switchï¼‰ï¼Œå³è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€‚VFS ä½œä¸ºä¸€ä¸ªé€šç”¨çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒæŠ½è±¡äº†æ–‡ä»¶ç³»ç»Ÿçš„å››ä¸ªåŸº æœ¬æ¦‚å¿µï¼šæ–‡ä»¶ã€ç›®å½•é¡¹ (dentry)ã€ç´¢å¼•èŠ‚ç‚¹ (inode) åŠæŒ‚è½½ç‚¹ï¼Œå…¶åœ¨å†…æ ¸ä¸­ä¸ºç”¨æˆ·ç©ºé—´å±‚çš„æ–‡ä»¶ç³»ç»Ÿæä¾›äº†ç›¸å…³çš„æ¥å£ï¼ˆè§ <code>å›¾ 3.</code>æ‰€ç¤º VFS åœ¨ Linux ç³»ç»Ÿçš„æ¶æ„ï¼‰ã€‚VFS å®ç°äº† open()ã€read() ç­‰ç³»ç»Ÿè°ƒå¹¶ä½¿å¾— cp ç­‰ç”¨æˆ·ç©ºé—´ç¨‹åºå¯è·¨æ–‡ä»¶ç³»ç»Ÿã€‚VFS çœŸæ­£å®ç°äº†ä¸Šè¿°å†…å®¹ä¸­ï¼šåœ¨ Linux ä¸­é™¤è¿›ç¨‹ä¹‹å¤–ä¸€åˆ‡çš†æ˜¯æ–‡ä»¶ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å›¾-3-vfs-åœ¨ç³»ç»Ÿä¸­çš„æ¶æ„">å›¾ 3. VFS åœ¨ç³»ç»Ÿä¸­çš„æ¶æ„<a href="#å›¾-3-vfs-åœ¨ç³»ç»Ÿä¸­çš„æ¶æ„" class="hash-link" aria-label="Direct link to å›¾ 3. VFS åœ¨ç³»ç»Ÿä¸­çš„æ¶æ„" title="Direct link to å›¾ 3. VFS åœ¨ç³»ç»Ÿä¸­çš„æ¶æ„">â€‹</a></h4>
<p><img loading="lazy" src="http://120.24.251.209/content/images/2016/03/image003.jpg" alt="image" class="img_ev3q"></p>
<p>Linux VFS å­˜åœ¨å››ä¸ªåŸºæœ¬å¯¹è±¡ï¼šè¶…çº§å—å¯¹è±¡ (superblock object)ã€ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ (inode object)ã€ç›®å½•é¡¹å¯¹è±¡ (dentry object) åŠæ–‡ä»¶å¯¹è±¡ (file object)ã€‚è¶…çº§å—å¯¹è±¡ä»£è¡¨ä¸€ä¸ªå·²å®‰è£…çš„æ–‡ä»¶ç³»ç»Ÿï¼›ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ä»£è¡¨ä¸€ä¸ªæ–‡ä»¶ï¼›ç›®å½•é¡¹å¯¹è±¡ä»£è¡¨ä¸€ä¸ªç›®å½•é¡¹ï¼Œå¦‚è®¾å¤‡æ–‡ä»¶ event5 åœ¨è·¯å¾„ /dev/input/event5 ä¸­ï¼Œå…¶å­˜åœ¨å››ä¸ªç›®å½•é¡¹å¯¹è±¡ï¼š/ ã€dev/ ã€input/ åŠ event5ã€‚æ–‡ä»¶å¯¹è±¡ä»£è¡¨ç”±è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ã€‚è¿™å››ä¸ªå¯¹è±¡ä¸è¿›ç¨‹åŠç£ç›˜æ–‡ä»¶é—´çš„å…³ç³»å¦‚<code>å›¾ 4.</code> æ‰€ç¤ºï¼Œå…¶ä¸­ d_inode å³ä¸ºç¡¬é“¾æ¥ã€‚ä¸ºæ–‡ä»¶è·¯å¾„çš„å¿«é€Ÿè§£æï¼ŒLinux VFS è®¾è®¡äº†ç›®å½•é¡¹ç¼“å­˜ï¼ˆDirectory Entry Cacheï¼Œå³ dcacheï¼‰ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å›¾-4-vfs-çš„å¯¹è±¡ä¹‹é—´çš„å¤„ç†">å›¾ 4. VFS çš„å¯¹è±¡ä¹‹é—´çš„å¤„ç†<a href="#å›¾-4-vfs-çš„å¯¹è±¡ä¹‹é—´çš„å¤„ç†" class="hash-link" aria-label="Direct link to å›¾ 4. VFS çš„å¯¹è±¡ä¹‹é—´çš„å¤„ç†" title="Direct link to å›¾ 4. VFS çš„å¯¹è±¡ä¹‹é—´çš„å¤„ç†">â€‹</a></h4>
<p><img loading="lazy" src="http://120.24.251.209/content/images/2016/03/image004.jpg" alt="image" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux-æ–‡ä»¶ç³»ç»Ÿä¸­çš„-inode">Linux æ–‡ä»¶ç³»ç»Ÿä¸­çš„ inode<a href="#linux-æ–‡ä»¶ç³»ç»Ÿä¸­çš„-inode" class="hash-link" aria-label="Direct link to Linux æ–‡ä»¶ç³»ç»Ÿä¸­çš„ inode" title="Direct link to Linux æ–‡ä»¶ç³»ç»Ÿä¸­çš„ inode">â€‹</a></h3>
<p>åœ¨ Linux ä¸­ï¼Œç´¢å¼•èŠ‚ç‚¹ç»“æ„å­˜åœ¨äºç³»ç»Ÿå†…å­˜åŠç£ç›˜ï¼Œå…¶å¯åŒºåˆ†æˆ VFS inode ä¸å®é™…æ–‡ä»¶ç³»ç»Ÿçš„ inodeã€‚VFS inode ä½œä¸ºå®é™…æ–‡ä»¶ç³»ç»Ÿä¸­ inode çš„æŠ½è±¡ï¼Œå®šä¹‰äº†ç»“æ„ä½“ inode ä¸å…¶ç›¸å…³çš„æ“ä½œ inode_operationsï¼ˆè§å†…æ ¸æºç  include/linux/fs.hï¼‰ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-10-vfs-ä¸­çš„-inode-ä¸-inode_operations-ç»“æ„ä½“">æ¸…å• 10. VFS ä¸­çš„ inode ä¸ inode_operations ç»“æ„ä½“<a href="#æ¸…å•-10-vfs-ä¸­çš„-inode-ä¸-inode_operations-ç»“æ„ä½“" class="hash-link" aria-label="Direct link to æ¸…å• 10. VFS ä¸­çš„ inode ä¸ inode_operations ç»“æ„ä½“" title="Direct link to æ¸…å• 10. VFS ä¸­çš„ inode ä¸ inode_operations ç»“æ„ä½“">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct inode </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const struct inode_operations   *i_op</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> // ç´¢å¼•èŠ‚ç‚¹æ“ä½œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    unsigned long           i_ino</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">      // ç´¢å¼•èŠ‚ç‚¹å·</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    atomic_t                i_count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">    // å¼•ç”¨è®¡æ•°å™¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    unsigned int            i_nlink</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">    // ç¡¬é“¾æ¥æ•°ç›®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> struct inode_operations </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">*create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">struct inode*,struct dentry *,int, struct nameidata*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">*link</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">struct dentry*,struct inode *,struct dentry*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">*unlink</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">struct inode*,struct dentry *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">*symlink</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">struct inode *,struct dentry*,const char *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">*mkdir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">struct inode *,struct dentry*,int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">*rmdir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">struct inode*,struct dentry *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚<code>æ¸…å• 10.</code> æ‰€è§ï¼Œæ¯ä¸ªæ–‡ä»¶å­˜åœ¨ä¸¤ä¸ªè®¡æ•°å™¨ï¼ši_count ä¸ i_nlinkï¼Œå³å¼•ç”¨è®¡æ•°ä¸ç¡¬é“¾æ¥è®¡æ•°ã€‚ç»“æ„ä½“ inode ä¸­çš„ i_count ç”¨äºè·Ÿè¸ªæ–‡ä»¶è¢«è®¿é—®çš„æ•°é‡ï¼Œè€Œ i_nlink åˆ™æ˜¯ä¸Šè¿°ä½¿ç”¨ ls -l ç­‰å‘½ä»¤æŸ¥çœ‹åˆ°çš„æ–‡ä»¶ç¡¬é“¾æ¥æ•°ã€‚æˆ–è€…è¯´ i_count è·Ÿè¸ªæ–‡ä»¶åœ¨å†…å­˜ä¸­çš„æƒ…å†µï¼Œè€Œ i_nlink åˆ™æ˜¯ç£ç›˜è®¡æ•°å™¨ã€‚å½“æ–‡ä»¶è¢«åˆ é™¤æ—¶ï¼Œåˆ™ i_nlink å…ˆè¢«è®¾ç½®æˆ 0ã€‚æ–‡ä»¶çš„è¿™ä¸¤ä¸ªè®¡æ•°å™¨ä½¿å¾— Linux ç³»ç»Ÿå‡çº§æˆ–ç¨‹åºæ›´æ–°å˜çš„å®¹æ˜“ã€‚ç³»ç»Ÿæˆ–ç¨‹åºå¯åœ¨ä¸å…³é—­çš„æƒ…å†µä¸‹ï¼ˆå³æ–‡ä»¶ i_count ä¸ä¸º 0ï¼‰ï¼Œå°†æ–°æ–‡ä»¶ä»¥åŒæ ·çš„æ–‡ä»¶åè¿›è¡Œæ›¿æ¢ï¼Œæ–°æ–‡ä»¶æœ‰è‡ªå·±çš„ inode åŠ data blockï¼Œæ—§æ–‡ä»¶ä¼šåœ¨ç›¸å…³è¿›ç¨‹å…³é—­åè¢«å®Œæ•´çš„åˆ é™¤ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-11-æ–‡ä»¶ç³»ç»Ÿ-ext4-ä¸­çš„-inode">æ¸…å• 11. æ–‡ä»¶ç³»ç»Ÿ ext4 ä¸­çš„ inode<a href="#æ¸…å•-11-æ–‡ä»¶ç³»ç»Ÿ-ext4-ä¸­çš„-inode" class="hash-link" aria-label="Direct link to æ¸…å• 11. æ–‡ä»¶ç³»ç»Ÿ ext4 ä¸­çš„ inode" title="Direct link to æ¸…å• 11. æ–‡ä»¶ç³»ç»Ÿ ext4 ä¸­çš„ inode">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct ext4_inode </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __le32  i_atime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">        // æ–‡ä»¶å†…å®¹æœ€åä¸€æ¬¡è®¿é—®æ—¶é—´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __le32  i_ctime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">        // inode ä¿®æ”¹æ—¶é—´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __le32  i_mtime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">        // æ–‡ä»¶å†…å®¹æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __le16  i_links_count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">  // ç¡¬é“¾æ¥è®¡æ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __le32  i_blocks_lo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">    // Block è®¡æ•°</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __le32  i_block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">EXT4_N_BLOCKS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">  // æŒ‡å‘å…·ä½“çš„ block</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>æ¸…å• 12.</code>çš„é”™è¯¯ä¿¡æ¯ã€‚å› æ­¤å®é™…æ–‡ä»¶ç³»ç»Ÿçš„ inode ä¹‹é—´åŠä¸ VFS inode ç›¸è¾ƒæ˜¯æœ‰å·®å¼‚çš„ã€‚</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…å•-12-æ–‡ä»¶ç³»ç»Ÿ-ext3-ä¸­-i_links_count-çš„é™åˆ¶">æ¸…å• 12. æ–‡ä»¶ç³»ç»Ÿ ext3 ä¸­ i_links_count çš„é™åˆ¶<a href="#æ¸…å•-12-æ–‡ä»¶ç³»ç»Ÿ-ext3-ä¸­-i_links_count-çš„é™åˆ¶" class="hash-link" aria-label="Direct link to æ¸…å• 12. æ–‡ä»¶ç³»ç»Ÿ ext3 ä¸­ i_links_count çš„é™åˆ¶" title="Direct link to æ¸…å• 12. æ–‡ä»¶ç³»ç»Ÿ ext3 ä¸­ i_links_count çš„é™åˆ¶">â€‹</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ./dirtest.sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> mkdir: cannot create directory </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">dir_31999&#x27;: Too many links</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"></span><span class="token variable comment" style="color:rgb(98, 114, 164);font-style:italic"># ./linkcount.sh</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> ln: failed to create hard </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">link</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> to </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">`</span><span class="token plain">old.file&#x27;: Too many links</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç»“æŸè¯­">ç»“æŸè¯­<a href="#ç»“æŸè¯­" class="hash-link" aria-label="Direct link to ç»“æŸè¯­" title="Direct link to ç»“æŸè¯­">â€‹</a></h3>
<p>æœ¬æ–‡æœ€åˆæè¿°äº† Linux ç³»ç»Ÿä¸­æ–‡ä»¶ä¸ç›®å½•è¢«å¼•å…¥çš„åŸå› åŠ Linux å¤„ç†æ–‡ä»¶çš„æ–¹å¼ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡åŒºåˆ†ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„ä¸åŒï¼Œäº†è§£ Linux ä¸­çš„ç´¢å¼•èŠ‚ç‚¹çš„ç›¸å…³çŸ¥è¯†ï¼Œå¹¶ä»¥æ­¤å¼•å‡ºäº† inode çš„ç»“æ„ä½“ã€‚ç´¢å¼•èŠ‚ç‚¹ç»“æ„ä½“å­˜åœ¨åœ¨äº Linux VFS ä»¥åŠå®é™…æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒVFS ä½œä¸ºé€šç”¨æ–‡ä»¶æ¨¡å‹æ˜¯ Linux ä¸­â€œä¸€åˆ‡çš†æ˜¯æ–‡ä»¶â€å®ç°çš„åŸºç¡€ã€‚æ–‡ç« å¹¶æœªæ·±å…¥ Linux VFSï¼Œä¹Ÿæ²¡æ¶‰åŠå®é™…æ–‡ä»¶ç³»ç»Ÿçš„å®ç°ï¼Œæ–‡ç« åªæ˜¯ä» inode äº†è§£ Linux çš„æ–‡ä»¶ç³»ç»Ÿçš„ç›¸å…³å†…å®¹ã€‚è‹¥æƒ³æ·±å…¥æ–‡ä»¶ç³»ç»Ÿçš„å†…å®¹ï¼ŒæŸ¥çœ‹å†…æ ¸æ–‡æ¡£ Documentation/filesystems/ æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹å¼ã€‚</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/linux">Linux</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/tags/linux/page/8"><div class="pagination-nav__label">Newer Entries</div></a></nav></main></div></div></div></div>
</body>
</html>