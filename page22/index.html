
<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Blog">
  <head>
    <meta charset="utf-8">
	<link rel="manifest" href="/static/pwa/manifest.json">
	<title> Home | 船长的课记 </title>
    
		
    <meta name="author" content="船长">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="theme-color" content="#2196F3">
	<meta name="google-site-verification" content="puZt0ZyqB-t67BYdYAgLUyIPBeismG68J0dmEc01QeY" />

	
    <script>
		if ('serviceWorker' in navigator) {
			window.addEventListener('load', function () {
				navigator.serviceWorker
										.register('/sw.js')
										.then(function(registration) {
											console.log("Successfully registered service worker", registration.scope);
										}).catch(function(err) {
											console.log("Service worker registration failed: ", err);
										});
				//navigator.serviceWorker.ready always resolve
				navigator.serviceWorker.ready.then(function (registration) {
					console.log('Service worker successfully registered on scope', registration.scope);
				});
			});
		}
    </script>
	<script type="text/javascript" src="/assets/themes/evjekylltheme/jquery-3.6.0.slim.min.js"></script>

	<link href="/assets/themes/evjekylltheme/google-code-prettify/desert.css" type="text/css" rel="stylesheet" />

    <!-- Le styles -->
    <link href="/assets/themes/evjekylltheme/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/evjekylltheme/css/style.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/images/favicon.ico">

    <!-- atom & rss feed -->
    <link href="" type="application/atom+xml" rel="alternate" title="Jekyll auto generate ATOM Feed">
    <link href="" type="application/atom+xml" rel="alternate" title="Site ATOM Feed">
    <link href="" type="application/rss+xml" rel="alternate" title="Site RSS Feed">
	<link rel="stylesheet" href="/assets/themes/evjekylltheme/font-awesome-4.4.0/css/font-awesome.min.css">
	<!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-W2LDG64');</script> -->
		<!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8529425670069509"
						crossorigin="anonymous"></script> -->
	<!-- <script async src="https://cdn.splitbee.io/sb.js"></script> -->
  </head>

  <body>
	<!-- <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2LDG64"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> -->
    <div class="navbar navbar-default navbar-fixed-top">
				<div class="container">
          <div class="row mobilepadding">
					<!-- <a class="navbar-brand" href="/">船长的课记</a> -->
					<a class="navbar-brand" href="/">SAMZONG</a>
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse" id="mNavbar">
  					<ul class="nav navbar-nav">
  						
  						
  						


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/friends.html">Friends</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



						  <li class="dropdown">
							  <a class="dropdown-toggle" data-toggle="dropdown" href="#">Other</a>
							  <ul class="dropdown-menu">
									<li><a href="/about.html">About</a></li>
									<li><a href="https://yuque.com/samzong/note" target="_blank">船长的课记</a></li>
									<li><a href="https://yuque.com/samzong/ap" target="_blank">果粉日记</a></li>
									<li><a href="https://yuque.com/samzong/code" target="_blank">Code Snippet</a></li>
									<li><a href="https://www.yuque.com/samzong/mcx" target="_blank">集</a></li>
									<li><a href="https://www.yuque.com/zooka" target="_blank">藏金阁</a></li>
								</ul>
						  </li>
  					</ul>
  					<form id="search-form" class="navbar-form navbar-right" role="search">
  						<div class="form-group">
  						<input type="text" class="form-control input-sm" placeholder="Search's Bad" id="query">
  						</div>
  					</form>
  					<div class="nav-icon">
  						<a href="/feed.xml"><i class="fa fa-rss fa-2x"></i></a>
  					</div>
          </div>
				</div>
      </div>
    </div>

    <div class="container">
			<div class="row mobilepadding">
        <div class="row">
					<div class="col-md-12">
						<div class="searchresult">
						</div>
						<div id="search-loader" class="img-wrap">
						</div>
					</div>
        </div>
				<meta itemprop="image" content="https://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com/uPic/telegram-cloud-photo-size-4-5971176114485308439-x.jpg">
<div class="row">
  <div class="col-xs-12 col-md-8">
    
    
    <h1><a class="title" href="/post/2016/04/Mac-1-%E8%B0%83%E6%95%B4Launchpad%E5%9B%BE%E6%A0%87%E5%A4%A7%E5%B0%8F.html">MacTips 调整 Launchpad 图标大小</a></h1>
    <div class="post_at_index">
      <p>很多人觉得默认 Launchpad 的应用程序图标很大，空间比较拥挤，不过这个其实是可以通过调整 Launchpad 每一行和每一列图标的数量，来调整 Launchpad 图标大小。</p>

<p>默认如下图：
<img src="http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-1.jpg" alt="image" /></p>

<p>代码块：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 调整每一行显示数量为8个。</span>
➜ defaults write com.apple.dock springboard-columns <span class="nt">-int</span> 10

＃ 重启Launchpad
➜ defaults write com.apple.dock ResetLaunchPad <span class="nt">-bool</span> TRUE<span class="p">;</span>killall Dock
</code></pre></div></div>

<p>修改后如下：
<img src="http://samzong.oss-cn-shenzhen.aliyuncs.com/2016%2F04%2FQQ20160408-2.jpg" alt="image" /></p>

      
    </div>
    <br/>
    <div>
      <cite>2016-04-09</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Mac">Mac</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/04/Mac-2-%E8%A7%A3%E5%86%B3oh-my-zsh%E5%9C%A8%E7%BB%88%E7%AB%AF%E4%B8%8B%E6%89%93%E5%BC%80%E7%BC%93%E6%85%A2.html">MacTips 解决 oh-my-zsh 在 Terminal 下打开缓慢</a></h1>
    <div class="post_at_index">
      <p>升级 Mac OS X 10.11 之后，使用 CleanMyMac 3 清理 9GB 的垃圾文件，之后导致打开 iTerm 时加载主机名特别的慢，Mac 的命令行工具我使用的是 iTerm＋ohmyzsh，这个问题困扰了我快两个月，工作比较忙，所以一直用 Zoc 代替，也没有认真的研究，最近有需求用到它，实在不行，研究一下，发现，是因为我清理系统的时候把终端日志的索引文件清理掉了，所以每次打开的时候都要先加载索引导致了首次开启非常慢，解决办法是，只要把终端缓存的日志文件删除即可：</p>

<p>代码块：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 日志文件路径</span>
<span class="c"># /private/var/log/asl/*.asl</span>

➜  ~ <span class="nb">sudo du</span> <span class="nt">-sh</span> /private/var/log/asl/
Password:
2.7G /private/var/log/asl/

➜  ~ <span class="nb">sudo rm</span> <span class="nt">-rf</span> /private/var/log/asl/<span class="k">*</span>.asl
➜  ~ <span class="nb">sudo du</span> <span class="nt">-sh</span> /private/var/log/asl/
208M /private/var/log/asl/

</code></pre></div></div>

<p>关闭终端，再次打开，问题解决。</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-04-08</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Mac">Mac</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/04/%E5%A6%82%E4%BD%95%E5%9C%A8CentOS-6-%E5%AE%89%E8%A3%85%E6%9B%B4%E9%AB%98%E7%89%88%E6%9C%AC%E7%9A%84PHP.html">如何在 CentOS 6 安装更高版本的 PHP</a></h1>
    <div class="post_at_index">
      <p>CentOS 6 默认安装的 PHP 版本是 5.3，但现在很多应用对于 LAMP 中，PHP 的版本最低 5.4，所以本篇文章的主要内容是，如何升级 PHP5.3 到 5.4 以及更高版本</p>

<h2 id="实验环境centos-64">实验环境：CentOS 6.4</h2>

<p>解决办法是采用了 remi 源仓库已经适配的相应 php 版本</p>

<blockquote>
  <p>经过测试，该升级办法同样适用目前 CentOS 6.x 所有版本</p>
</blockquote>

<h3 id="安装-remi-源">安装 Remi 源</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 因为remi依赖epel源仓库，所有我们要先安装它。</span>
<span class="o">[</span>root@visionet8 ~]# yum <span class="nb">install</span> <span class="nt">-y</span> epel-release

<span class="o">[</span>root@visionet8 ~]# wget http://rpms.famillecollet.com/enterprise/remi-release-6.rpm
<span class="o">[</span>root@visionet8 ~]# rpm <span class="nt">-Uvh</span> remi-release-6.rpm
</code></pre></div></div>

<h4 id="2-我们看下-remi-的的-yum-配置文件">2. 我们看下 Remi 的的 yum 配置文件</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Repository: http://rpms.remirepo.net/</span>
<span class="c"># Blog:       http://blog.remirepo.net/</span>
<span class="c"># Forum:      http://forum.remirepo.net/</span>

<span class="o">[</span>remi]
<span class="nv">name</span><span class="o">=</span>Remi<span class="s1">'s RPM repository for Enterprise Linux 6 - $basearch
baseurl=http://rpms.remirepo.net/enterprise/6/remi/$basearch/
#mirrorlist=http://rpms.remirepo.net/enterprise/6/remi/mirror
enabled=1
gpgcheck=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi

[remi-php55]
name=Remi'</span>s PHP 5.5 RPM repository <span class="k">for </span>Enterprise Linux 6 - <span class="nv">$basearch</span>
<span class="c">#baseurl=http://rpms.remirepo.net/enterprise/6/php55/$basearch/</span>
<span class="nv">mirrorlist</span><span class="o">=</span>http://rpms.remirepo.net/enterprise/6/php55/mirror
<span class="c"># NOTICE: common dependencies are in "remi-safe"</span>
<span class="nv">enabled</span><span class="o">=</span>0
<span class="nv">gpgcheck</span><span class="o">=</span>1
<span class="nv">gpgkey</span><span class="o">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi

<span class="o">[</span>remi-php56]
<span class="nv">name</span><span class="o">=</span>Remi<span class="s1">'s PHP 5.6 RPM repository for Enterprise Linux 6 - $basearch
#baseurl=http://rpms.remirepo.net/enterprise/6/php56/$basearch/
mirrorlist=http://rpms.remirepo.net/enterprise/6/php56/mirror
# NOTICE: common dependencies are in "remi-safe"
enabled=0
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi
</span></code></pre></div></div>

<p>经过测试，启用 remi 源之后，默认情况下 php 版本为 5.4，这时我们只需要升级 php 即可。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@visionet8 html]# yum update <span class="nt">-y</span> php<span class="k">*</span>
Failed to <span class="nb">set </span>locale, defaulting to C
Loaded plugins: fastestmirror, refresh-packagekit, security
Loading mirror speeds from cached hostfile
 <span class="k">*</span> base: mirrors.163.com
 <span class="k">*</span> epel: mirrors.ustc.edu.cn
 <span class="k">*</span> extras: mirrors.aliyun.com
 <span class="k">*</span> remi-safe: mirrors.tuna.tsinghua.edu.cn
 <span class="k">*</span> updates: mirrors.cn99.com
remi                                                                               | 2.9 kB     00:00
remi/primary_db                                                                    | 1.6 MB     00:05
Setting up Update Process
Resolving Dependencies
<span class="nt">--</span><span class="o">&gt;</span> Running transaction check
<span class="nt">---</span><span class="o">&gt;</span> Package php.x86_64 0:5.3.3-48.el6_8 will be updated
<span class="nt">---</span><span class="o">&gt;</span> Package php.x86_64 0:5.4.45-12.el6.remi will be an update
<span class="nt">---</span><span class="o">&gt;</span> Package php-cli.x86_64 0:5.3.3-48.el6_8 will be updated
<span class="nt">---</span><span class="o">&gt;</span> Package php-cli.x86_64 0:5.4.45-12.el6.remi will be an update
<span class="nt">---</span><span class="o">&gt;</span> Package php-common.x86_64 0:5.3.3-48.el6_8 will be updated
<span class="nt">---</span><span class="o">&gt;</span> Package php-common.x86_64 0:5.4.45-12.el6.remi will be an update
<span class="nt">---</span><span class="o">&gt;</span> Package php-gd.x86_64 0:5.3.3-48.el6_8 will be updated
<span class="nt">---</span><span class="o">&gt;</span> Package php-gd.x86_64 0:5.4.45-12.el6.remi will be an update
<span class="nt">--</span><span class="o">&gt;</span> Processing Dependency: libt1.so.5<span class="o">()(</span>64bit<span class="o">)</span> <span class="k">for </span>package: php-gd-5.4.45-12.el6.remi.x86_64
<span class="nt">---</span><span class="o">&gt;</span> Package php-mcrypt.x86_64 0:5.3.3-4.el6 will be updated
<span class="nt">---</span><span class="o">&gt;</span> Package php-mcrypt.x86_64 0:5.4.45-12.el6.remi will be an update
<span class="nt">---</span><span class="o">&gt;</span> Package php-mysql.x86_64 0:5.3.3-48.el6_8 will be updated
<span class="nt">---</span><span class="o">&gt;</span> Package php-mysql.x86_64 0:5.4.45-12.el6.remi will be an update
<span class="nt">---</span><span class="o">&gt;</span> Package php-pdo.x86_64 0:5.3.3-48.el6_8 will be updated
<span class="nt">---</span><span class="o">&gt;</span> Package php-pdo.x86_64 0:5.4.45-12.el6.remi will be an update
<span class="nt">--</span><span class="o">&gt;</span> Running transaction check
<span class="nt">---</span><span class="o">&gt;</span> Package t1lib.x86_64 0:5.1.2-6.el6_2.1 will be installed
<span class="nt">--</span><span class="o">&gt;</span> Finished Dependency Resolution

Dependencies Resolved

<span class="o">==========================================================================================================</span>
 Package                  Arch                 Version                           Repository          Size
<span class="o">==========================================================================================================</span>
Updating:
 php                      x86_64               5.4.45-12.el6.remi                remi               2.8 M
 php-cli                  x86_64               5.4.45-12.el6.remi                remi               4.1 M
 php-common               x86_64               5.4.45-12.el6.remi                remi               968 k
 php-gd                   x86_64               5.4.45-12.el6.remi                remi               152 k
 php-mcrypt               x86_64               5.4.45-12.el6.remi                remi                60 k
 php-mysql                x86_64               5.4.45-12.el6.remi                remi               145 k
 php-pdo                  x86_64               5.4.45-12.el6.remi                remi               129 k
Installing <span class="k">for </span>dependencies:
 t1lib                    x86_64               5.1.2-6.el6_2.1                   base               160 k

Transaction Summary
<span class="o">==========================================================================================================</span>
Install       1 Package<span class="o">(</span>s<span class="o">)</span>
Upgrade       7 Package<span class="o">(</span>s<span class="o">)</span>

Total download size: 8.5 M
Downloading Packages:
<span class="o">(</span>1/8<span class="o">)</span>: php-5.4.45-12.el6.remi.x86_64.rpm                                           | 2.8 MB     00:07
<span class="o">(</span>2/8<span class="o">)</span>: php-cli-5.4.45-12.el6.remi.x86_64.rpm                                       | 4.1 MB     00:06
<span class="o">(</span>3/8<span class="o">)</span>: php-common-5.4.45-12.el6.remi.x86_64.rpm                                    | 968 kB     00:02
<span class="o">(</span>4/8<span class="o">)</span>: php-gd-5.4.45-12.el6.remi.x86_64.rpm                                        | 152 kB     00:01
<span class="o">(</span>5/8<span class="o">)</span>: php-mcrypt-5.4.45-12.el6.remi.x86_64.rpm                                    |  60 kB     00:00
<span class="o">(</span>6/8<span class="o">)</span>: php-mysql-5.4.45-12.el6.remi.x86_64.rpm                                     | 145 kB     00:00
<span class="o">(</span>7/8<span class="o">)</span>: php-pdo-5.4.45-12.el6.remi.x86_64.rpm                                       | 129 kB     00:01
<span class="o">(</span>8/8<span class="o">)</span>: t1lib-5.1.2-6.el6_2.1.x86_64.rpm                                            | 160 kB     00:00
<span class="nt">----------------------------------------------------------------------------------------------------------</span>
Total                                                                     338 kB/s | 8.5 MB     00:25
Running rpm_check_debug
Running Transaction Test
Transaction Test Succeeded
Running Transaction
Warning: RPMDB altered outside of yum.
  Updating   : php-common-5.4.45-12.el6.remi.x86_64                                                  1/15
  Updating   : php-cli-5.4.45-12.el6.remi.x86_64                                                     2/15
  Updating   : php-pdo-5.4.45-12.el6.remi.x86_64                                                     3/15
  Installing : t1lib-5.1.2-6.el6_2.1.x86_64                                                          4/15
  Updating   : php-gd-5.4.45-12.el6.remi.x86_64                                                      5/15
  Updating   : php-mysql-5.4.45-12.el6.remi.x86_64                                                   6/15
  Updating   : php-5.4.45-12.el6.remi.x86_64                                                         7/15
  Updating   : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  8/15
  Cleanup    : php-5.3.3-48.el6_8.x86_64                                                             9/15
  Cleanup    : php-mysql-5.3.3-48.el6_8.x86_64                                                      10/15
  Cleanup    : php-pdo-5.3.3-48.el6_8.x86_64                                                        11/15
  Cleanup    : php-cli-5.3.3-48.el6_8.x86_64                                                        12/15
  Cleanup    : php-gd-5.3.3-48.el6_8.x86_64                                                         13/15
  Cleanup    : php-mcrypt-5.3.3-4.el6.x86_64                                                        14/15
  Cleanup    : php-common-5.3.3-48.el6_8.x86_64                                                     15/15
  Verifying  : php-mcrypt-5.4.45-12.el6.remi.x86_64                                                  1/15
  Verifying  : t1lib-5.1.2-6.el6_2.1.x86_64                                                          2/15
  Verifying  : php-common-5.4.45-12.el6.remi.x86_64                                                  3/15
  Verifying  : php-gd-5.4.45-12.el6.remi.x86_64                                                      4/15
  Verifying  : php-cli-5.4.45-12.el6.remi.x86_64                                                     5/15
  Verifying  : php-pdo-5.4.45-12.el6.remi.x86_64                                                     6/15
  Verifying  : php-mysql-5.4.45-12.el6.remi.x86_64                                                   7/15
  Verifying  : php-5.4.45-12.el6.remi.x86_64                                                         8/15
  Verifying  : php-5.3.3-48.el6_8.x86_64                                                             9/15
  Verifying  : php-gd-5.3.3-48.el6_8.x86_64                                                         10/15
  Verifying  : php-cli-5.3.3-48.el6_8.x86_64                                                        11/15
  Verifying  : php-pdo-5.3.3-48.el6_8.x86_64                                                        12/15
  Verifying  : php-common-5.3.3-48.el6_8.x86_64                                                     13/15
  Verifying  : php-mysql-5.3.3-48.el6_8.x86_64                                                      14/15
  Verifying  : php-mcrypt-5.3.3-4.el6.x86_64                                                        15/15

Dependency Installed:
  t1lib.x86_64 0:5.1.2-6.el6_2.1

Updated:
  php.x86_64 0:5.4.45-12.el6.remi                      php-cli.x86_64 0:5.4.45-12.el6.remi
  php-common.x86_64 0:5.4.45-12.el6.remi               php-gd.x86_64 0:5.4.45-12.el6.remi
  php-mcrypt.x86_64 0:5.4.45-12.el6.remi               php-mysql.x86_64 0:5.4.45-12.el6.remi
  php-pdo.x86_64 0:5.4.45-12.el6.remi

Complete!
</code></pre></div></div>

<h4 id="测试">测试</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@visionet8 html]# php <span class="nt">-v</span>
PHP 5.4.45 <span class="o">(</span>cli<span class="o">)</span> <span class="o">(</span>built: Sep 19 2016 15:31:07<span class="o">)</span>
Copyright <span class="o">(</span>c<span class="o">)</span> 1997-2014 The PHP Group
Zend Engine v2.4.0, Copyright <span class="o">(</span>c<span class="o">)</span> 1998-2014 Zend Technologies
</code></pre></div></div>

<h4 id="php-55-和-php56">php 5.5 和 php5.6</h4>

<blockquote>
  <p>若要升级到 5.5 或 5.6，根据 remi 源的配置文件，将 php5.5 的 enable 参数设置为 1，并将默认 enable 修改为 0，然后<code class="language-plaintext highlighter-rouge">yum update php*</code>即可。</p>
</blockquote>

<h4 id="5-php-7">5. php 7</h4>

<blockquote>
  <p>安装完成之后发现，在安装 remi 源之后，在<code class="language-plaintext highlighter-rouge">/etc/yum.repos.d</code>除了<code class="language-plaintext highlighter-rouge">remi.repo</code>之外，还有<code class="language-plaintext highlighter-rouge">remi-php70.repo</code>和<code class="language-plaintext highlighter-rouge">remi-php71.repo</code>，测试下，如果要升级到 php7，可以打开相应源仓库的配置文件，之后升级即可。
<strong>以上功能在升级时，要考虑其他组件的版本兼容性，不要盲目升级。</strong></p>
</blockquote>

      
    </div>
    <br/>
    <div>
      <cite>2016-04-01</cite> <i class="icon-tag"></i>
      <a href="/tags.html#CentOS">CentOS</a>
      , 
      <a href="/tags.html#PHP">PHP</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/03/MySQL-4-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80.html">MySQL 数据库使用基础</a></h1>
    <div class="post_at_index">
      <h2 id="1-测试环境">1. 测试环境</h2>

<ul>
  <li>MacBook Pro 15’ i7 16GB</li>
  <li>VMware Fushion 8 Pro</li>
  <li>MySQL Version 5.1</li>
  <li>CentOS Linux 6.x</li>
</ul>

<h2 id="2-实验步骤">2. 实验步骤</h2>

<h3 id="21安装-mysql">2.1 安装 mysql</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@ultraera  ~]#  yum  install  mysql  mysql-server  mysql-devel

</code></pre></div></div>

<h3 id="22-启动-mysql并设置开机自启动">2.2 启动 mysql，并设置开机自启动</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@ultraera  ~]#  service  mysqld  start
<span class="o">[</span>root@ultraera  ~]#  chkconfig  mysqld  on
<span class="o">[</span>root@ultraera  ~]#  chkconfig  --list  |  grep  mysqld
mysqld 0:off  1:off  2:on  3:on  4:on  5:on  6:off

</code></pre></div></div>

<h3 id="23-相关配置">2.3 相关配置</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/etc/my.cnf         mysql配置文件
/var/lib/mysql      mysql数据库文件
port:3306           mysql默认端口

<span class="c"># Tips : MySQL 绝大对数语句都是以分号结尾，注意是英文模式下的分号。字符和字符串用 '' 引起；</span>
</code></pre></div></div>

<h3 id="24-mysql-初始化及登录">2.4 mysql 初始化及登录</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@ultraera ~]# mysql_secure_installation

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MySQL to secure it, we<span class="s1">'ll need the current
password for the root user.  If you'</span>ve just installed MySQL, and
you haven<span class="s1">'t set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none):        # 首次登陆默认为空

Setting the root password ensures that nobody can log into the MySQL
root user without the proper authorisation.

You already have a root password set, so you can safely answer '</span>n<span class="s1">'.

Set the root password? [Y/n] y            # 设置root用户密码
New password:
Re-enter new password:
Password updated successfully!
Reloading privilege tables..
 ... Success!


By default, a MySQL installation has an anonymous user, allowing anyone
to log into MySQL without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] y        # 删除匿名用户
 ... Success!

Normally, root should only be allowed to connect from '</span>localhost<span class="s1">'.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] y        # 关闭root远程登陆
 ... Success!

By default, MySQL comes with a database named '</span><span class="nb">test</span><span class="s1">' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n] y    # 删除 test 数据库
 - Dropping test database...
ERROR 1008 (HY000) at line 1: Can'</span>t drop database <span class="s1">'test'</span><span class="p">;</span> database doesn<span class="s1">'t exist
 ... Failed!  Not critical, keep moving...
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] y    # 保存这些设置
 ... Success!


All done!  If you'</span>ve completed all of the above steps, your MySQL
installation should now be secure.

Thanks <span class="k">for </span>using MySQL!

Cleaning up...
<span class="o">[</span>root@ultraera ~]#

<span class="o">[</span>root@ultraera  ~]# 
<span class="o">[</span>root@ultraera  ~]# mysql  -u  root  -p  <span class="s1">'123456'</span>
<span class="o">[</span>root@ultraera  ~]# mysql  -u  root  -p  -h  localhost “-h” 指定服务器地址
</code></pre></div></div>

<h3 id="25-创建查看及删除当前数据库">2.5 创建、查看及删除当前数据库</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">CREATE</span><span class="err">  </span><span class="k">DATABASE</span><span class="err">  </span><span class="n">ultraera</span><span class="p">;</span>
<span class="n">Query</span><span class="err">  </span><span class="n">OK</span><span class="p">,</span><span class="err">  </span><span class="mi">1</span><span class="err">  </span><span class="k">row</span><span class="err">  </span><span class="n">affected</span><span class="err">  </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="err">  </span><span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">SHOW</span><span class="err">  </span><span class="n">DATABASES</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="err">  </span><span class="k">Database</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="err">  </span><span class="n">information_schema</span><span class="err">  </span><span class="o">|</span>
<span class="o">|</span><span class="err">  </span><span class="n">mysql</span> <span class="o">|</span>
<span class="o">|</span><span class="err">  </span><span class="n">test</span> <span class="o">|</span>
<span class="o">|</span><span class="err">  </span><span class="n">ultraera</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="mi">4</span><span class="err">  </span><span class="k">rows</span><span class="err">  </span><span class="k">in</span><span class="err">  </span><span class="k">set</span><span class="err">  </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="err">  </span><span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">DROP</span><span class="err">  </span><span class="k">DATABASE</span><span class="err">  </span><span class="n">ultraera</span><span class="p">;</span>
<span class="n">Query</span><span class="err">  </span><span class="n">OK</span><span class="p">,</span><span class="err">  </span><span class="mi">0</span><span class="err">  </span><span class="k">rows</span><span class="err">  </span><span class="n">affected</span><span class="err">  </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="err">  </span><span class="n">sec</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="26-创建查看及删除当前表格">2.6 创建、查看及删除当前表格</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span><span class="err">创建表格之前要先选择数据库</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="n">use</span><span class="err">  </span><span class="n">ultraera</span><span class="p">;</span>
<span class="k">Database</span><span class="err">  </span><span class="n">changed</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">CREATE</span><span class="err">  </span><span class="k">TABLE</span><span class="err">  </span><span class="n">ultraera</span><span class="p">(</span> <span class="o">#</span><span class="k">create</span><span class="err"> 创建表格，至少</span><span class="mi">1</span><span class="err">列</span>
<span class="o">-&gt;</span><span class="err">  </span><span class="n">id</span><span class="err">  </span><span class="nb">int</span><span class="err">  </span><span class="k">NOT</span><span class="err">  </span><span class="k">NULL</span><span class="p">,</span> <span class="o">#</span><span class="k">NOT</span><span class="err">  </span><span class="k">NULL</span> <span class="err">不为空</span><span class="p">,</span><span class="nb">int</span><span class="err"> 整型</span>
<span class="o">-&gt;</span><span class="err">  </span><span class="n">name</span><span class="err">  </span><span class="nb">char</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="err">  </span><span class="k">NOT</span><span class="err">  </span><span class="k">NULL</span><span class="p">,</span> <span class="o">#</span><span class="nb">char</span><span class="p">()</span><span class="err"> 字符型  </span><span class="p">,()</span><span class="err">内定义字符长度</span>
<span class="o">-&gt;</span><span class="err">  </span><span class="n">age</span><span class="err">  </span><span class="nb">int</span><span class="err">  </span><span class="k">NOT</span><span class="err">  </span><span class="k">NULL</span>
<span class="o">-&gt;</span><span class="err">  </span><span class="p">);</span>
<span class="n">Query</span><span class="err">  </span><span class="n">OK</span><span class="p">,</span><span class="err">  </span><span class="mi">0</span><span class="err">  </span><span class="k">rows</span><span class="err">  </span><span class="n">affected</span><span class="err">  </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="err">  </span><span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">DESC</span><span class="err">  </span><span class="n">ultraera</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+----------+------+-----+---------+----------------+</span>
<span class="o">|</span><span class="err">  </span><span class="n">Field</span><span class="err">  </span><span class="o">|</span><span class="err">  </span><span class="k">Type</span> <span class="o">|</span><span class="err">  </span><span class="k">Null</span><span class="err">  </span><span class="o">|</span><span class="err">  </span><span class="k">Key</span><span class="err">  </span><span class="o">|</span><span class="err">  </span><span class="k">Default</span><span class="err">  </span><span class="o">|</span><span class="err">  </span><span class="n">Extra</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-------+----------+------+-----+---------+----------------+</span>
<span class="o">|</span><span class="err">  </span><span class="n">id</span> <span class="o">|</span><span class="err">  </span><span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="err">  </span><span class="o">|</span><span class="err">  </span><span class="k">NO</span><span class="err">  </span><span class="o">|</span> <span class="o">|</span><span class="err">  </span><span class="k">NULL</span> <span class="o">|</span> <span class="o">|</span>
<span class="o">|</span><span class="err">  </span><span class="n">name</span><span class="err">  </span><span class="o">|</span><span class="err">  </span><span class="nb">char</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="err">  </span><span class="o">|</span><span class="err">  </span><span class="k">NO</span><span class="err">  </span><span class="o">|</span> <span class="o">|</span><span class="err">  </span><span class="k">NULL</span> <span class="o">|</span> <span class="o">|</span>
<span class="o">|</span><span class="err">  </span><span class="n">age</span> <span class="o">|</span><span class="err">  </span><span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="err">  </span><span class="o">|</span><span class="err">  </span><span class="k">NO</span><span class="err">  </span><span class="o">|</span> <span class="o">|</span><span class="err">  </span><span class="k">NULL</span> <span class="o">|</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-------+----------+------+-----+---------+----------------+</span>
<span class="mi">3</span><span class="err">  </span><span class="k">rows</span><span class="err">  </span><span class="k">in</span><span class="err">  </span><span class="k">set</span><span class="err">  </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="err">  </span><span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">DROP</span><span class="err">  </span><span class="k">TABLE</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="p">;</span>
<span class="n">Query</span><span class="err">  </span><span class="n">OK</span><span class="p">,</span><span class="err">  </span><span class="mi">0</span><span class="err">  </span><span class="k">rows</span><span class="err">  </span><span class="n">affected</span><span class="err">  </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="err">  </span><span class="n">sec</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="27-修改表格信息">2.7 修改表格信息</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span><span class="p">.</span><span class="err">重命名表格</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">alter</span><span class="err">  </span><span class="k">table</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="k">rename</span><span class="err">  </span><span class="n">ultraera_org</span><span class="p">;</span>
<span class="n">b</span><span class="p">.</span><span class="err">新增列</span>
<span class="k">alter</span><span class="err">  </span><span class="k">table</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="k">add</span><span class="err">  </span><span class="n">address</span><span class="err">  </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
<span class="k">c</span><span class="p">.</span><span class="err">删除列</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">alter</span><span class="err">  </span><span class="k">table</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="k">drop</span><span class="err">  </span><span class="k">column</span><span class="err">  </span><span class="n">address</span><span class="p">;</span>
<span class="n">d</span><span class="p">.</span><span class="err">修改一个列的数据类型</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">alter</span><span class="err">  </span><span class="k">table</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="k">modify</span><span class="err">  </span><span class="n">name</span><span class="err">  </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
<span class="n">e</span><span class="p">.</span><span class="err">重命名一个列</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">alter</span><span class="err">  </span><span class="k">table</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="n">change</span><span class="err">  </span><span class="k">column</span><span class="err">  </span><span class="n">NAME</span><span class="err">  </span><span class="n">name</span><span class="err">  </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="28-向表格中插入数据">2.8 向表格中插入数据</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span><span class="p">.</span><span class="err">  全局插入</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">insert</span><span class="err">  </span><span class="k">into</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="k">values</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">'name'</span><span class="p">,</span><span class="mi">18</span><span class="p">);</span>
<span class="n">b</span><span class="p">.</span><span class="err">  根据列插入</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">insert</span><span class="err">  </span><span class="k">into</span><span class="err">  </span><span class="n">ultraera</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">age</span><span class="p">)</span><span class="err">  </span><span class="k">values</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">'john'</span><span class="p">,</span><span class="mi">19</span><span class="p">);</span>
<span class="o">###</span> <span class="mi">2</span><span class="p">.</span><span class="mi">9</span> <span class="err">查看表格中的数据：</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">select</span><span class="err">  </span><span class="o">*</span><span class="err">  </span><span class="k">from</span><span class="err">  </span><span class="n">ultraera</span><span class="p">;</span> <span class="o">#</span><span class="err">  </span><span class="o">*</span><span class="err">匹配所有列，也可以只查询单个列，</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">select</span><span class="err">  </span><span class="n">name</span><span class="err">  </span><span class="k">from</span><span class="err">  </span><span class="n">ultraera</span><span class="p">;</span>

</code></pre></div></div>

<h3 id="210-where-运算符条件判断查询查询使用方法where列运算符值">2.10 where 运算符：条件判断查询，查询使用方法：where  列  运算符  值</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">where</span><span class="err">支持的运算符：</span><span class="o">=</span><span class="err">等于；</span><span class="o">&gt;</span><span class="err">大于；</span><span class="o">&lt;</span><span class="err">小于；</span><span class="o">&lt;&gt;</span><span class="err">不等于；</span><span class="o">&gt;=</span><span class="err">大于等于；</span><span class="o">&lt;=</span><span class="err">小于等于；</span><span class="k">BETWEEN</span><span class="err">在某范围之内；</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err"> </span><span class="k">select</span><span class="err"> </span><span class="o">*</span><span class="err"> </span><span class="k">from</span><span class="err"> </span><span class="n">ultraera</span><span class="err"> </span><span class="k">where</span><span class="err"> </span><span class="n">id</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err"> </span><span class="k">select</span><span class="err"> </span><span class="o">*</span><span class="err"> </span><span class="k">from</span><span class="err"> </span><span class="n">ultraera</span><span class="err"> </span><span class="k">where</span><span class="err"> </span><span class="n">id</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err"> </span><span class="k">select</span><span class="err"> </span><span class="o">*</span><span class="err"> </span><span class="k">from</span><span class="err"> </span><span class="n">ultraera</span><span class="err"> </span><span class="k">where</span><span class="err"> </span><span class="n">id</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err"> </span><span class="k">select</span><span class="err"> </span><span class="o">*</span><span class="err"> </span><span class="k">from</span><span class="err"> </span><span class="n">ultraera</span><span class="err"> </span><span class="k">where</span><span class="err"> </span><span class="n">id</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err"> </span><span class="k">select</span><span class="err"> </span><span class="o">*</span><span class="err"> </span><span class="k">from</span><span class="err"> </span><span class="n">ultraera</span><span class="err"> </span><span class="k">where</span><span class="err"> </span><span class="n">id</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err"> </span><span class="k">select</span><span class="err"> </span><span class="o">*</span><span class="err"> </span><span class="k">from</span><span class="err"> </span><span class="n">ultraera</span><span class="err"> </span><span class="k">where</span><span class="err"> </span><span class="n">id</span><span class="err">  </span><span class="k">between</span><span class="err">  </span><span class="mi">1</span><span class="err">  </span><span class="k">and</span><span class="err">  </span><span class="mi">4</span><span class="p">;</span>

</code></pre></div></div>

<h3 id="211-删除表格中的一条记录同样可以匹配-where-运算符">2.11 删除表格中的一条记录（同样可以匹配 where 运算符）</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">delete</span><span class="err">  </span><span class="k">from</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="k">where</span><span class="err">  </span><span class="n">id</span><span class="err">  </span><span class="o">=</span><span class="err">  </span><span class="mi">4</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">delete</span><span class="err">  </span><span class="o">*</span><span class="err">  </span><span class="k">from</span><span class="err">  </span><span class="n">ultraera</span><span class="err"> ；</span> <span class="o">#</span><span class="err">清空一个表格的数据；</span>

</code></pre></div></div>

<h3 id="212-更新表中的一个数据">2.12 更新表中的一个数据</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">update</span><span class="err">  </span><span class="n">ultraera</span><span class="err">  </span><span class="k">set</span><span class="err">  </span><span class="n">age</span><span class="o">=</span><span class="mi">30</span><span class="err">  </span><span class="k">where</span><span class="err">  </span><span class="n">id</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>

</code></pre></div></div>

<h3 id="213-mysql-增加删除一个用户">2.13 MySQL 增加删除一个用户</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">create</span><span class="err">  </span><span class="k">user</span><span class="err">  </span><span class="n">user1</span><span class="err">  </span><span class="n">identified</span><span class="err">  </span><span class="k">by</span><span class="err">  </span><span class="s1">'123456'</span><span class="p">;</span> <span class="o">#</span><span class="n">user1</span><span class="err">，密码</span><span class="mi">123456</span><span class="err">，新用户没有权限，无法登录数据库</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">drop</span><span class="err">  </span><span class="k">user</span><span class="err">  </span><span class="n">user1</span><span class="p">;</span> <span class="o">#</span><span class="err">删除用户</span><span class="n">user1</span>

</code></pre></div></div>

<h3 id="214-给用户添加删除权限">2.14 给用户添加、删除权限</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">grant</span><span class="err">  </span><span class="k">all</span><span class="err">  </span><span class="k">privileges</span><span class="err">  </span><span class="k">on</span><span class="err">  </span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="err">  </span><span class="k">to</span><span class="err">  </span><span class="s1">'user1'</span><span class="o">@</span><span class="s1">'localhost'</span><span class="err">  </span><span class="n">identified</span><span class="err">  </span><span class="k">by</span><span class="err">  </span><span class="s1">'123456'</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="err">  </span><span class="k">revoke</span><span class="err">  </span><span class="k">all</span><span class="err">  </span><span class="k">privileges</span><span class="err">  </span><span class="k">from</span><span class="err">  </span><span class="n">user1</span><span class="p">;</span>

</code></pre></div></div>

<h3 id="215-使用-mysqldump-进行数据库备份">2.15 使用 mysqldump 进行数据库备份</h3>

<p>数据库重命名：mysql 不能直接对数据库重命名，所以如果想要重名数据库的话，要先导出，接着创建一个新的数据库，然后将导出的 sql 文件再导入到新的数据库中</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> mysqldump  -u  root  -p  ultraera  &gt;  ultraera.sql     <span class="c">#备份</span>
<span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> mysql  -u  root  -p  new_ultraera  &lt;  ultraera.sql     <span class="c">#恢复到指定数据库</span>

</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-03-29</cite> <i class="icon-tag"></i>
      <a href="/tags.html#MySQL">MySQL</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/03/Linux-%E4%B8%AD%E7%9A%84%E4%B8%89%E4%B8%AA%E7%89%B9%E6%AE%8A%E6%9D%83%E9%99%90.html">Linux 中的三个特殊权限</a></h1>
    <div class="post_at_index">
      <h2 id="权限介绍">权限介绍</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Linux中除了普通权限之外，还有三个特殊权限。
SUID:：以文件的所属用户执行，而非执行文件的用户，多用于可执行文件，设置suid后，在权限位中，所属用户的  最后一个权
限为变为s，添加SUID权限可用“+s”表示。
例如：passwd
<span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> which  passwd
/usr/bin/passwd
<span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> <span class="nb">ls</span>  <span class="nt">-l</span>  /usr/bin/passwd
<span class="nt">-rwsr-xr-x</span><span class="nb">.</span>  1  root  root  25980  Feb  22  2012  /usr/bin/passwd
<span class="o">[</span>adam@ultraera  ~]<span class="err">$</span>
SGID：主要针对文件夹，在设置了SGID的文件夹中创建任何新文件都继承该文件的所属组，设置sgid后，在权限位中，所属
组的最后一个权限位变为s，添加SGID权限可用“+s”表示。
例如：
<span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> <span class="nb">mkdir  </span>ultraera
<span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> <span class="nb">ls</span>  <span class="nt">-l</span>
total  4
drwxrwxr-x  2  adam  adam  4096  Nov  27  21:09  ultraera
<span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> <span class="nb">chmod  </span>g+s  ultraera/
<span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> <span class="nb">ls</span>  <span class="nt">-l</span>
total  4
drwxrwsr-x  2  adam  adam  4096  Nov  27  21:09  ultraera
<span class="o">[</span>adam@ultraera  ~]<span class="nv">$ </span> su
Password:
<span class="o">[</span>root@ultraera  adam]#  <span class="nb">mkdir</span>  <span class="nt">-p</span>  ultraera/test
<span class="o">[</span>root@ultraera  adam]#  <span class="nb">ls</span>  <span class="nt">-l</span>  ultraera/
total  4
drwxr-sr-x  2  root  adam  4096  Nov  27  21:09  <span class="nb">test</span>
<span class="o">[</span>root@ultraera  adam]#
sticky：针对文件夹，对目录拥有写权限的用户，仅可以删除其所拥有的文件，无法删除其他用户所拥有的文件，设置了sticky
之后，在权限位，other的最后一个权限位变为t,添加SGID权限可用“+t”表示。
例如：
<span class="o">[</span>root@ultraera  tmp]#  <span class="nb">mkdir  </span>ultraera
<span class="o">[</span>root@ultraera  tmp]#  <span class="nb">chmod  </span><span class="nv">a</span><span class="o">=</span>rwx,o+t  ultraera/
<span class="o">[</span>root@ultraera  tmp]#  <span class="nb">ls</span>  <span class="nt">-ld</span>  ultraera/
drwxrwxrwt  2  root  root  4096  Nov  27  21:29  ultraera/
<span class="o">[</span>root@ultraera  tmp]#  useradd  user1
<span class="o">[</span>root@ultraera  tmp]#  useradd  user2
<span class="o">[</span>root@ultraera  tmp]#  su  user1
<span class="o">[</span>user1@ultraera  tmp]<span class="nv">$ </span> <span class="nb">touch</span>  ./ultraera/test
<span class="o">[</span>user1@ultraera  tmp]<span class="nv">$ </span> <span class="nb">ls</span>  <span class="nt">-l</span>  ultraera/
total  0
<span class="nt">-rw-rw-r--</span>  1  user1  user1  0  Nov  27  21:31  <span class="nb">test</span>
<span class="o">[</span>user1@ultraera  tmp]<span class="nv">$ </span> <span class="nb">exit
exit</span>
<span class="o">[</span>root@ultraera  tmp]#  su  user2
<span class="o">[</span>user2@ultraera  tmp]<span class="nv">$ </span> <span class="nb">rm</span>  <span class="nt">-f</span>  ./ultraera/test
<span class="nb">rm</span>:  cannot  remove  <span class="sb">`</span>./ultraera/test<span class="s1">':  Operation  not  permitted
[user2@ultraera  tmp]$


同样使用chmod来设定特殊权限，与普通权限一样，特殊权限也可以用数字表示：
suid  ：  4
sgid  ：  2
sticky ：  1
chmod  4644  filename #设置文件suid权限
chmod  2755  flodername #设置文件夹sgid权限
chmod  1755  flodername #设置文件夹sticky权限

</span></code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-03-29</cite> <i class="icon-tag"></i>
      <a href="/tags.html#基础知识">基础知识</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/03/CentOS-6-1-%E4%BD%BF%E7%94%A8createrepo%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%E6%BA%90.html">CentOS 使用 createrepo 搭建本地源</a></h1>
    <div class="post_at_index">
      <blockquote>
  <p>Tips: 本地搭建本地 yum 源采用的 rpm 全部来自 CentOS-6.7-bin-DVD1&amp;DVD2</p>
</blockquote>

<h3 id="1-测试环境">1. 测试环境</h3>

<ul>
  <li>MacBook Pro 15-inch i7 16GB</li>
  <li>VMware Fushion 8 Pro</li>
  <li>CentOS-6.7-i686-minimal.iso</li>
</ul>

<p>因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。</p>

<h3 id="2-实验步骤">2. 实验步骤</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 2.1 因为配置本地yum源需要修改/目录下的文件及/etc下面的配置文件，建议更换到root用户。</span>
<span class="o">[</span>adam@ultraera ~]<span class="nv">$ </span>su -
Password:
<span class="o">[</span>root@ultraera ~]#

<span class="c"># 2.2 首先在本地创建一个存放rpm包的目录，我这里选择直接在/下创建，你可以自定义：</span>
<span class="o">[</span>root@ultraera ~]# mkdir /yumload
<span class="o">[</span>root@ultraera ~]# cd /yumload/
<span class="o">[</span>root@ultraera yumload]# pwd
/yumload
<span class="c"># 2.3 接下来把两张DVD中的Packages中的rpm包全部拷贝到/yumload:</span>
<span class="o">[</span>root@ultraera yumload]# cp /media/CentOS_6.5_Final/Packages/<span class="k">*</span> ./
<span class="o">[</span>root@ultraera yumload]# ll ./<span class="k">*</span>.rpm | wc -l

<span class="c">#两张DVD一共有的rpm包的数量:</span>
4802


<span class="c"># 2.4 然后使用createrepo指令创建本地repo，CentOS6默认不安装createrepo，需要手动安装，没关系，在我们的DVD光盘中已经集成了createrepo的包，如果报需要依赖安装其他包的使用，依次安装即可。</span>

<span class="o">[</span>root@ultraera yumload]# rpm -ivh createrepo-0.9.9-18.el6.noarch.rpm

<span class="c"># 2.5 创建yum仓库，耐心等待，可以加-v参数列出执行信息</span>
<span class="o">[</span>root@ultraera yumload]# createrepo /yumload/
Spawning worker 0 with 4802 pkgs
Workers Finished
Gathering worker results
Saving Primary metadata
Saving file lists metadata
Saving other metadata
Generating sqlite DBs
Sqlite DBs complete
<span class="o">[</span>root@ultraera yumload]#

<span class="c"># 2.6 在/etc/yum.repo.d/下创建一个repo文件，文件名可以自定义，但一定要以repo结尾，并添加一下内容：</span>
<span class="o">[</span>ultraera.org] <span class="c">#仓库名称可以自定义</span>
<span class="nv">name</span><span class="o">=</span>This is a local repo <span class="c">#描述信息</span>
<span class="nv">baseurl</span><span class="o">=</span>file:///yumload/ <span class="c">#这里填写仓库的url，注意 有三个正斜线</span>
<span class="nv">enabled</span><span class="o">=</span>1 <span class="c">#是否开启仓库，1为开启，0为关闭</span>
<span class="nv">gpgcheck</span><span class="o">=</span>0 <span class="c">#是否检查gpgkey，1为开启，0为关闭</span>

<span class="c"># 2.7 另外如果想要添加软件包group的信息，可以把DVD1中的repodata文件中的*-comps.xml文件，使用ceraterepo -g 加载本地仓库即可，代码如下：</span>
<span class="o">[</span>root@ultraera repodata]# createrepo -g [字符可能不一样，后缀正确就行]c6-i386-comps.xml /yumload/


<span class="c"># 2.8 到这里本地yum源就已经搭建完成了，接下来重新初始化yum缓存：</span>
<span class="o">[</span>root@ultraera repodata]# yum clean all
Loaded plugins: fastestmirror, refresh-packagekit, security
Cleaning repos: ultraera.org
Cleaning up Everything
Cleaning up list of fastest mirrors
<span class="o">[</span>root@ultraera repodata]# yum makecache
Loaded plugins: fastestmirror, refresh-packagekit, security
Determining fastest mirrors
ultraera.org | 2.9 kB 00:00 ...
ultraera.org/filelists_db | 4.9 MB 00:00 ...
ultraera.org/primary_db | 3.5 MB 00:00 ...
ultraera.org/other_db | 2.1 MB 00:00 ...
Metadata Cache Created

<span class="c"># 2.9 测试group信息是否添加正确可以用如下代码，只要有正确输出信息就表示成功了</span>
<span class="o">[</span>root@ultraera ~]# yum grouplist


</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-03-28</cite> <i class="icon-tag"></i>
      <a href="/tags.html#CentOS">CentOS</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/03/HowTo-Install-MongoDB-on-CentOS-6-x.html">HowTo Install MongoDB  on CentOS 6.x</a></h1>
    <div class="post_at_index">
      <h2 id="1-overiew">1. Overiew</h2>

<p>在 CentOS Linux 中安装软件的方式有很多种，我会在后续的文章中整理给大家，我比较喜欢的方式是尽量用 Yum 安装，不用自己动手去解决软件包之间的依赖关系，“能 Yum 就 Yum，不能 Yum 想着法 Yum。”  – 这是我遵循的真理；今天给大家整理的就是如何使用 Yum 来安装 Mongodb，在本文中会给出在 32 位与 64 位系统的区别，以及 Mongodb 的版本，本文适用于 CentOS 6/7 的 Linux 发行版本，所以同样适用于红帽体系的 OS，如 RedHat Enterprise Linux 6/7、Fedora。</p>

<h2 id="2-packages">2. Packages</h2>

<p>业内常用的 Mongodb 的 Yum 仓库有 Mongodb-org 与 Mongodb-10gen ,这里提供的 Mongodb-org 的 repository 仓库，支持以下软件包列表：</p>

<ul>
  <li>
    <p>2.1 mongodb-org</p>

    <p>这个是源数据包，主要是用来组织自动安装下面的 4 个软件包。</p>
  </li>
  <li>
    <p>2.2 mongodb-org-sever</p>

    <p>这个 Mongodb Server 端，包含了相关的配置和初始化脚本。</p>
  </li>
  <li>
    <p>2.3 mongodb-org-mongos</p>

    <p>这个是 Mongodb 的守护进程。</p>
  </li>
  <li>
    <p>2.4 mongodb-org-shell</p>

    <p>这个是 mongodb 的 shell 环境。</p>
  </li>
  <li>
    <p>2.5 mongodb-org-tools</p>

    <p>这个包里包含了下列 mongodb 的工具：mongoimport bsondump, mongodump, mongoexport, mongofiles, mongooplog, mongoperf, mongorestore, mongostat, and mongotop。</p>
  </li>
</ul>

<h2 id="3-添加相对应版本的-mongodb-repo-file">3. 添加相对应版本的 Mongodb repo file</h2>

<h3 id="31-mongodb-26--os-x64">3.1 Mongodb 2.6 + OS x64</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo

<span class="o">[</span>mongodb-org-2.6]
<span class="nv">name</span><span class="o">=</span>MongoDB 2.6 Repository
<span class="nv">baseurl</span><span class="o">=</span>http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/
<span class="nv">gpgcheck</span><span class="o">=</span>0
<span class="nv">enabled</span><span class="o">=</span>1

</code></pre></div></div>

<h3 id="32-mongodb-26--os-i686">3.2 Mongodb 2.6 + OS i686</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-2.6.repo

<span class="o">[</span>mongodb-org-2.6]
<span class="nv">name</span><span class="o">=</span>MongoDB 2.6 Repository
<span class="nv">baseurl</span><span class="o">=</span>http://downloads-distro.mongodb.org/repo/redhat/os/i686/
<span class="nv">gpgcheck</span><span class="o">=</span>0
<span class="nv">enabled</span><span class="o">=</span>1

</code></pre></div></div>

<h3 id="33-mongodb-32---os-x64">3.3 Mongodb 3.2  + OS x64</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo

<span class="o">[</span>mongodb-org-3.2]
<span class="nv">name</span><span class="o">=</span>MongoDB Repository
<span class="nv">baseurl</span><span class="o">=</span>https://repo.mongodb.org/yum/redhat/<span class="nv">$releasever</span>/mongodb-org/3.2/x86_64/
<span class="nv">gpgcheck</span><span class="o">=</span>0
<span class="nv">enabled</span><span class="o">=</span>1

</code></pre></div></div>

<h3 id="34-mongodb-32---os-i686">3.4 Mongodb 3.2  + OS i686</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# vim /etc/yum.repos.d/mongodb-org-3.2.repo

<span class="o">[</span>mongodb-org-3.2]
<span class="nv">name</span><span class="o">=</span>MongoDB Repository
<span class="nv">baseurl</span><span class="o">=</span>https://repo.mongodb.org/yum/redhat/<span class="nv">$releasever</span>/mongodb-org/3.2/i686/
<span class="nv">gpgcheck</span><span class="o">=</span>0
<span class="nv">enabled</span><span class="o">=</span>1

</code></pre></div></div>

<h2 id="4-install-mongodb">4. Install MongoDB</h2>

<p>安装最新版本的 Mongodb，安装都方式一样，请注意安装相对应的源保证正确安装 Mongodb，请使用如下命令：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# yum clean all
<span class="o">[</span>root@vm02 ~]# yum makecache
<span class="o">[</span>root@vm02 ~]# yum <span class="nb">install </span>mongodb-org

</code></pre></div></div>

<h2 id="5-run-mongodb">5. Run MongoDB</h2>

<h3 id="51-配置-selinux">5.1 配置 SELinux</h3>

<p>SELinux 默认为开启状态，会导致我们的 Mongodb 无法使用，解决方式有两种：</p>

<ol>
  <li><a href="http://blog.ultraera.org/centos6-x-base-settings/">关闭 SELinux</a></li>
  <li>添加 Mongodb 通过 SELinux 设定，指令如下：</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>semanage port <span class="nt">-a</span> <span class="nt">-t</span> mongod_port_t <span class="nt">-p</span> tcp 27017

</code></pre></div></div>

<blockquote>
  <p>Tips: 在 CentOS 7，SELinux 会限定你去修改 Mongodb 的 data 目录及 lib 目录。</p>
</blockquote>

<h3 id="52-start-mongodb">5.2 Start MongoDB</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# <span class="nb">sudo </span>service mongod start
Starting mongod:                                           <span class="o">[</span>  OK  <span class="o">]</span>
<span class="o">[</span>root@vm02 ~]#

</code></pre></div></div>

<h3 id="53-检查-mongodb-日志文件验证服务正常启动-varlogmongodbmongodblog">5.3 检查 MongoDB 日志文件验证服务正常启动， /var/log/mongodb/mongodb.log</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# <span class="nb">cat</span> /var/log/mongodb/mongod.log  <span class="c"># 看到如下内容表示mongodb启动成功了。</span>
2016-03-24T04:09:28.582+0800 I NETWORK  <span class="o">[</span>initandlisten] waiting <span class="k">for </span>connections on port 27017

</code></pre></div></div>

<h3 id="54-设置-mongodb-开机自启动">5.4 设置 MongoDB 开机自启动</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# chkconfig mongod on

</code></pre></div></div>

<h3 id="55-设置-mongodb-允许其他服务器访问">5.5 设置 MongoDB 允许其他服务器访问</h3>

<p>默认情况下，mongodb 只监听 127.0.0.1，但是实际生产环境中可能需要其他服务器访问，所以这里添加监听其他网络端口，修改 mongodb 的配置文件：/etc/mongodb.conf</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# vim /etc/mongodb.conf

<span class="c"># line 29 增加一行：</span>
    bindIp: 172.16.102.129

<span class="c"># 注意不要把1270.0.1 去除，这会导致本地无法使用MongoDB .</span>

</code></pre></div></div>

<h2 id="6-use-mongodb">6. Use MongoDB</h2>

<h3 id="61-检查-mongodb-状态">6.1 检查 mongodb 状态</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# service mongod status
mongod <span class="o">(</span>pid 6502<span class="o">)</span> is running...
<span class="o">[</span>root@vm02 ~]#

</code></pre></div></div>

<h3 id="62-mongodb-自带检测工具">6.2 mongodb 自带检测工具</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# mongostat
insert query update delete getmore <span class="nb">command</span> % dirty % used flushes  vsize   res qr|qw ar|aw netIn netOut conn                      <span class="nb">time</span>
    <span class="k">*</span>0    <span class="k">*</span>0     <span class="k">*</span>0     <span class="k">*</span>0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:09+08:00
    <span class="k">*</span>0    <span class="k">*</span>0     <span class="k">*</span>0     <span class="k">*</span>0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:10+08:00
    <span class="k">*</span>0    <span class="k">*</span>0     <span class="k">*</span>0     <span class="k">*</span>0       0     1|0     0.0    0.0       0 388.0M 68.0M   0|0   0|0   79b    18k    1 2016-03-24T04:25:11+08:00

</code></pre></div></div>

<h3 id="63-进入-mongodb-命令行模式">6.3 进入 mongodb 命令行模式</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# mongo
MongoDB shell version: 3.2.4
connecting to: <span class="nb">test
</span>Server has startup warnings:
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten]
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten] <span class="k">**</span> WARNING: /sys/kernel/mm/transparent_hugepage/enabled is <span class="s1">'always'</span><span class="nb">.</span>
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten] <span class="k">**</span>        We suggest setting it to <span class="s1">'never'</span>
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten]
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten] <span class="k">**</span> WARNING: /sys/kernel/mm/transparent_hugepage/defrag is <span class="s1">'always'</span><span class="nb">.</span>
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten] <span class="k">**</span>        We suggest setting it to <span class="s1">'never'</span>
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten]
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten] <span class="k">**</span> WARNING: soft rlimits too low. rlimits <span class="nb">set </span>to 1024 processes, 64000 files. Number of processes should be at least 32000 : 0.5 <span class="nb">times </span>number of files.
2016-03-24T04:09:28.577+0800 I CONTROL  <span class="o">[</span>initandlisten]
<span class="o">&gt;</span>

</code></pre></div></div>

<h2 id="7-uninstall-mongodb">7. Uninstall MongoDB</h2>

<h3 id="71-关闭-mongodb">7.1 关闭 mongodb</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# service mongod stop

</code></pre></div></div>

<h3 id="72-卸载-mongodb-软件包">7.2 卸载 mongodb 软件包</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# yum erase <span class="si">$(</span>rpm <span class="nt">-qa</span> | <span class="nb">grep </span>mongodb-org<span class="si">)</span>

</code></pre></div></div>

<h3 id="73-删除-mongodb-文件数据库文件和日志文件">7.3 删除 mongodb 文件：数据库文件和日志文件</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@vm02 ~]# <span class="nb">rm</span> <span class="nt">-rf</span> /var/log/mongodb
<span class="o">[</span>root@vm02 ~]# <span class="nb">rm</span> <span class="nt">-rf</span> /var/lib/mongo

</code></pre></div></div>

<h2 id="8-faq">8. FAQ</h2>

<p>Q : Mongodb 占用 99%CPU 并且查询速度很慢？</p>

<p>A : 数据库需要首先建立索引，类似图书的目录文件，否则当你在数据库内查找数据的时候，就类似于在整本字典一页页翻查一个字如此。</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-03-27</cite> <i class="icon-tag"></i>
      <a href="/tags.html#MongoDB">MongoDB</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/03/%E5%9C%A8CentOS%E4%B8%AD%E9%85%8D%E7%BD%AE-SFTP-%E7%8E%AF%E5%A2%83.html">在 CentOS 中配置 SFTP 环境</a></h1>
    <div class="post_at_index">
      <p>做运维工作的，应该经常会碰到这样的问题，需要新上一个 web 项目，需要上传文件到服务器上，解决方法有很多种，常见的如 sftp 和 ftp，今天讲如何使用 sftp 让系统用户用户上传项目的权限，并且实现 chroot 和无法使用 ssh 登录到系统。</p>

<p>SFTP 是指 SSH 文件传输协议（SSH File Transfer protocol）或安全文件传输协议（Secure File Transfer Protocol），它提供了可信数据流下的文件访问、文件传输以及文件管理功能。当我们为 SFTP 配置 chroot 环境后，只有被许可的用户可以访问，并被限制到他们的家目录中，换言之：被许可的用户将处于牢笼环境中，在此环境中它们甚至不能切换它们的目录。</p>

<h2 id="1-测试环境">1. 测试环境</h2>

<ul>
  <li>MacBook Pro 15-inch i7 16GB</li>
  <li>VMware Fushion 8 Pro</li>
  <li>Transmit ( SFTP tools for Mac )</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# <span class="nb">cat</span> /etc/issue
CentOS release 6.6 <span class="o">(</span>Final<span class="o">)</span>
Kernel <span class="se">\r</span> on an <span class="se">\m</span>
<span class="o">[</span>root@test ~]# rpm <span class="nt">-qa</span> | <span class="nb">grep </span>openssh-server
openssh-server-5.3p1-104.el6.i686
</code></pre></div></div>

<h2 id="2-实验步骤">2. 实验步骤</h2>

<h3 id="21-增加一个-sftpusers-用户组">2.1 增加一个 sftpusers 用户组</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# groupadd sftpusers
</code></pre></div></div>

<h3 id="22-创建一个用户-user01并分配给-sftpusers-用户组">2.2 创建一个用户 user01，并分配给 sftpusers 用户组</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# useradd <span class="nt">-g</span> sftpusers user01
</code></pre></div></div>

<h3 id="23-修改用户家目录及指定不能登录-shell">2.3 修改用户家目录及指定不能登录 shell</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# <span class="nb">mkdir</span> /sftp/
<span class="o">[</span>root@test ~]# usermod <span class="nt">-s</span> /sbin/nologin <span class="nt">-d</span> /sftp/user01 <span class="nt">-m</span> user01
</code></pre></div></div>

<h3 id="24-给用户创建密码注意密码不明文显示">2.4 给用户创建密码（注意密码不明文显示）</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# passwd user01
Changing password <span class="k">for </span>user user01.
New password:
BAD PASSWORD: it is too simplistic/systematic
BAD PASSWORD: is too simple
Retype new password:
passwd: all authentication tokens updated successfully.
<span class="o">[</span>root@test ~]#
</code></pre></div></div>

<h3 id="25-修改-ssh-的配置文件如下设置">2.5 修改 ssh 的配置文件，如下设置</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# ll /etc/ssh/sshd_config
<span class="nt">-rw-------</span><span class="nb">.</span> 1 root root 3879 Oct 15  2014 /etc/ssh/sshd_config
<span class="o">[</span>root@test ~]# vim /etc/ssh/sshd_config

<span class="c"># line 132</span>
<span class="c">#Subsystem      sftp    /usr/libexec/openssh/sftp-server    #注释</span>
Subsystem       sftp    internal-sftp        <span class="c">#修改为internal-sftp</span>

<span class="c"># add this lines at the end of file</span>
Match Group sftpusers        <span class="c">#指定一下参数仅适用的用户组sftpusers</span>
    X11Forwarding no
    AllowTcpForwarding no
    ChrootDirectory %h       <span class="c">#设置chroot将用户锁在家目录，%h=家目录</span>
    ForceCommand internal-sftp    <span class="c">#该参数强制执行内部sftp</span>
</code></pre></div></div>

<h3 id="26-重启-ssh-服务">2.6 重启 ssh 服务</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# /etc/init.d/sshd restart
Stopping sshd:                                             <span class="o">[</span>  OK  <span class="o">]</span>
Starting sshd:                                             <span class="o">[</span>  OK  <span class="o">]</span>
</code></pre></div></div>

<h3 id="27-设置用户家目录权限注意权限不能大于-0755">2.7 设置用户家目录权限，(注意权限不能大于 0755)</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# <span class="nb">chmod </span>0755 /sftp/user01/
<span class="o">[</span>root@test ~]# <span class="nb">chown </span>root /sftp/user01/
<span class="o">[</span>root@test ~]# <span class="nb">chgrp</span> <span class="nt">-R</span> sftpusers /sftp/user01/
</code></pre></div></div>

<h3 id="28-关于上传根目录无法上传文件">2.8 关于上传，根目录无法上传文件</h3>

<p>因为用户家目录属主是 root，并且权限最大 0755，所以没法写，我的解决方法是在在家目录建立一个文件夹，作为上传目录，并把属主给 user01 即可。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# <span class="nb">mkdir</span> /sftp/user01/upload
<span class="o">[</span>root@test ~]# <span class="nb">chown </span>user01:sftpusers /sftp/user01/upload/
</code></pre></div></div>

<h2 id="3-测试验证">3. 测试验证</h2>

<h3 id="31-linux-登录测试">3.1 Linux 登录测试</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@test ~]# su - user01
This account is currently not available.    <span class="c">#su - 切换失败</span>

<span class="o">[</span>root@test ~]# <span class="nb">cat</span> /etc/passwd | <span class="nb">tail</span> <span class="nt">-1</span>
user01:x:500:500::/sftp/user01:/sbin/nologin

<span class="o">[</span>root@test ~]# ssh user01@localhost
The authenticity of host <span class="s1">'localhost (::1)'</span> can<span class="s1">'t be established.
RSA key fingerprint is f3:fc:31:dc:7d:16:d5:ad:8c:bc:eb:69:8f:b2:0b:c9.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '</span>localhost<span class="s1">' (RSA) to the list of known hosts.
user01@localhost'</span>s password:
This service allows sftp connections only.    <span class="c">#ssh登录也失败，ssh设置成功</span>
Connection to localhost closed.

<span class="o">[</span>root@test ~]# sftp user01@localhost
Connecting to localhost...
user01@localhost<span class="s1">'s password:
sftp&gt; ls
upload
sftp&gt; pwd
Remote working directory: /
sftp&gt;

</span></code></pre></div></div>

<h3 id="32-sftp-工具测试">3.2 SFTP 工具测试</h3>

<p>我这里使用的是 Mac，但是传统的文件传输工具都差不多，Windows 下有 Winscp、Xftp 等。</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-03-24</cite> <i class="icon-tag"></i>
      <a href="/tags.html#SSH">SSH</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/03/MySQL-6-%E5%88%A9%E7%94%A8Linux%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5MySQL.html">利用 Linux 计划任务定时同步 MySQL</a></h1>
    <div class="post_at_index">
      <p>说下实际项目场景，公司一个应用已部署主从数据库，业务也正式上线；现在客户公司领导希望可以看到每天的业务数据报表，本设定直接到从库拿数据，然后进行数据处理，生成报表，但是 Java 同事提出需求新增用户和权限表，这样一来，如果直接使用生产库的表会导致后台系统管理人员与领导的账户和权限混淆，经过讨论决定，按照生产库的表结构新增特殊用户表和权限表；这样操作实际是可以在从库上新增表单，且不影响主从库之间的数据同步，但是从安全性的考虑，新增表单设计需要给用户 Insert 权限，为了保证从库只有利用主库同步写入数据，则只能给其他用户 select 权限。</p>

<p><strong>最终决定，因为报表系统的使用率低，直接在报表系统的服务器安装本地 mysql 数据库，通过计划任务定时到从库上同步数据。</strong></p>

<h3 id="1-测试环境">1. 测试环境</h3>

<ul>
  <li>MacBook Pro 15’ i7 16GB</li>
  <li>VMware Fushion 8 Pro</li>
  <li>MySQL Version 5.6</li>
  <li>CentOS Linux 6.x</li>
  <li>slave Server : 172.16.102.129</li>
  <li>local Server : 172.167.102.133</li>
</ul>

<h3 id="2-利用-mysqldump-导出-sql-文件">2. 利用 mysqldump 导出 sql 文件</h3>

<p>需要注意的是，mysqldump 时会锁表，需要给 mysqldump 传递“–single-transaction”参数，可以使得 mysqldump 时不锁表，如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/bin/mysqldump <span class="nt">-h</span> 172.168.102.129 <span class="nt">-u</span> dbuser <span class="nt">-pdbuser</span> <span class="nt">--single-transaction</span> slave <span class="o">&gt;</span> slave.sql
</code></pre></div></div>

<h3 id="3-使用-mysql-恢复-sql-文件到数据库中">3. 使用 mysql 恢复 sql 文件到数据库中</h3>

<p>需要注意的是，如果该 local server 的 slave 库中有数据表，当表名与 slave server 的表名相同时，数据表内的数据会被覆盖；如果 local server 的表在 slave.sql 中不存在，则不受影响，正是利用这个特性解决用户需求。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/bin/mysql <span class="nt">-u</span> dbuser <span class="nt">-pdbuser</span> report &lt; /home/.mysql/slave.sql
</code></pre></div></div>

<h3 id="4-编写脚本">4. 编写脚本</h3>

<p>首先在本地某一位置作为临时 sql 存储地址：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@report ~]# <span class="nb">mkdir</span> /home/.mysql     <span class="c"># 这个目录可以自定义</span>
</code></pre></div></div>

<p>脚本 1：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">TIME</span><span class="o">=</span><span class="sb">`</span><span class="nb">date</span> <span class="s2">"+%Y%m%d%H"</span><span class="sb">`</span>

<span class="nb">rm</span> <span class="nt">-rf</span> /home/.mysql/<span class="k">*</span>

/usr/bin/mysqldump <span class="nt">-h</span> 172.168.102.129 <span class="nt">-u</span> dbuser <span class="nt">-pdbuser</span> <span class="nt">--single-transaction</span> slave <span class="o">&gt;</span> /home/.mysql/slave_<span class="nv">$TIME</span>.sql

/usr/bin/mysql <span class="nt">-u</span> dbuser <span class="nt">-pdbuser</span> report &lt; /home/.mysql/slave_<span class="nv">$TIME</span>.sql

</code></pre></div></div>

<h3 id="5-增加邮件通知功能">5. 增加邮件通知功能</h3>

<p>因为前期同事需要得知备份的执行结果，所以希望数据同步成功后获得邮件提醒，这里使用 sendmail 实现，在 CentOS 里预装是没有安装 sendmail，所以我们需要安装 sendmail 服务，另外一个安装命令行邮件工具 mailx：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@report ~]# yum <span class="nb">install</span> <span class="nt">-y</span> sendmail mailx

......

<span class="o">[</span>root@report ~]# service sendmail start
Starting sendmail:                                         <span class="o">[</span>  OK  <span class="o">]</span>
Starting sm-client:                                        <span class="o">[</span>  OK  <span class="o">]</span>
<span class="o">[</span>root@report ~]# chkconfig sendmail on

</code></pre></div></div>

<p>完整脚本：report_sync.sh，如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">TIME</span><span class="o">=</span><span class="sb">`</span><span class="nb">date</span> <span class="s2">"+%Y%m%d%H"</span><span class="sb">`</span>

<span class="nb">rm</span> <span class="nt">-rf</span> /home/.mysql/<span class="k">*</span>

/usr/bin/mysqldump <span class="nt">-h</span> 172.168.102.129 <span class="nt">-u</span> dbuser <span class="nt">-pdbuser</span> <span class="nt">--single-transaction</span> slave <span class="o">&gt;</span> /home/.mysql/slave_<span class="nv">$TIME</span>.sql

/usr/bin/mysql <span class="nt">-u</span> dbuser <span class="nt">-pdbuser</span> report &lt; /home/.mysql/slave_<span class="nv">$TIME</span>.sql

<span class="c"># send mail to adminuser</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
<span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"report SQL sync is successfully. At time: </span><span class="sb">`</span><span class="nb">date</span><span class="sb">`</span><span class="s2"> "</span> | mail <span class="nt">-s</span> report-sync-successfully  hello@abc.cn
<span class="k">else
        </span><span class="nb">echo</span> <span class="s2">" Error Error report SQL sync is Error. At time: </span><span class="sb">`</span><span class="nb">date</span><span class="sb">`</span><span class="s2"> "</span> | mail <span class="nt">-s</span> report-sync-error  hello@abc.cn
<span class="k">fi</span>

</code></pre></div></div>

<p>查看下邮件通知：
<img src="http://blog.ultraera.org:80/content/images/2016/03/24/p01.jpg" alt="image" /></p>

<h3 id="6-计划任务-crontab">6. 计划任务 crontab</h3>

<p>和同事及客户沟通，确认每天 1、5、9、13、17、21 整时到从库拉去数据，Linux 选择使用 crontab 做计划任务，crontab 命令常见于 Unix 和类 Unix 的操作系统之中，用于设置周期性被执行的指令。该命令从标准输入设备读取指令，并将其存放于“crontab”文件中。通常，crontab 储存的指令被守护进程激活，crond 常常在后台运行，每一分钟检查是否有预定的作业需要执行。这类作业一般称为 cron jobs。</p>

<h4 id="61-安装-crontab">6.1 安装 crontab</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@report ~]# yum <span class="nb">install</span> <span class="nt">-y</span> vixie-cron
<span class="o">[</span>root@report ~]# yum <span class="nb">install</span> <span class="nt">-y</span> crontabs

说明：
vixie-cron软件包是cron的主程序；
crontabs软件包是用来安装、卸装、或列举用来驱动 crond 守护进程的表格的程序。

cron 是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务：
/sbin/service crond start <span class="c">#启动服务</span>
/sbin/service crond stop <span class="c">#关闭服务</span>
/sbin/service crond restart <span class="c">#重启服务</span>
/sbin/service crond reload <span class="c">#重新载入配置</span>

设置crond开机自启动
<span class="o">[</span>root@report ~]# chkconfig crond on

</code></pre></div></div>

<h3 id="7-添加计划任务">7. 添加计划任务</h3>

<p>将脚本 report_sync.sh 保存到/usr/bin下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@report ~]# <span class="nb">mv </span>report_sync.sh /usr/bin
</code></pre></div></div>

<p>增加计划任务：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@report ~]# crontab <span class="nt">-e</span>

<span class="c"># add this word.</span>
<span class="k">*</span> 1-21/4  <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> /usr/bin/report_sync.sh

<span class="c"># 表示在每天的1-21时间内，每4小时执行一个脚本</span>

</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-03-24</cite> <i class="icon-tag"></i>
      <a href="/tags.html#MySQL">MySQL</a>
      , 
      <a href="/tags.html#CentOS">CentOS</a>
      , 
      <a href="/tags.html#Shell">Shell</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/03/Linux-%E7%AC%94%E8%AF%95%E8%AF%95%E9%A2%98.html">Linux 笔试试题</a></h1>
    <div class="post_at_index">
      <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>一。选择题（1 题 1 分）
1. 当登录 Linux 时，一个具有唯一进程 ID 号的 shell 将被调用，这个 ID 是什么 (   )
A. NID  B. PID  C. UID  D. CID
答案:B
2. 用 vi 打开一个文件，如何用字母"new"来代替字母"old" (   )
A. :s/old/new/g　　　B. :s/old/new　　C. :1,$s/old/new/g　　　D. :r/old/new
答案:A
3. 请选择对标准的变量 PS2 正确的描述 (   )
A. 是一个主 shell 提示符变量    B. 是一个一般的 shell 提示符变量
C. 是第二主 shell 提示符变量     D. 是一个连续提示符变量
答案:B
4. 哪一个命令能用来查找文件 TESTFILE 中只包含四个字符的行？(   )
A. grep '^????$' TESTFILE    B. grep '????' TESTFILE
C. grep '^....$' TESTFILE     D. grep '....' TESTFILE
答案:C
5. 一个 bash shell 脚本的第一行是什么 (   )
A. #!/bin/bash  B. #/bin/bash  C. #/bin/csh   D. /bin/bash
答案:A
6. 用标准的输出重定向 (&gt;) 像"&gt; file01"能使文件 file01 的数据（   ）
A. 被移动  B. 被复制  C. 被打印   D. 被覆盖
答案:D
7. 下面哪个命令是用来定义 shell 的全局变量 (    )
A. exportfs  B. alias  C. exports  D. export
答案:D
8. 如果想加载一个/dev/sdb1的windows95分区到/mnt/win95目录，需要运行哪个命令(   )
A. mount -t hpfs /dev/sdb1 /mnt/win95
B. mount -t hpfs /mnt/win95 /dev/sdb1
C. mount -t vfat /dev/sdb1 /mnt/win95
D. mount -t vfat /mnt/win95 /dev/sdb1
答案:C
9. 哪个文件存放用户密码信息 (   )
A. /boot/passwd   B. /etc/shadow   C. /var/passwd  D. /dev/passwd
答案:B
10. 假定 kernel 支持 vfat 分区，下面哪一个操作是将/dev/sda1，一个 window98 分区加载到/win 目录 (   )
A. mount -s win /dev'sda1 /win
B. mount -fs=msdos /dev/sda1 /win
C. mount -t vfat /dev/sda1 /win
D. mount -t windows /win /dev/sda1
答案:C
11. 默认情况下管理员创建了一个用户，就会在 (   ) 目录下创建一个用户主目录。
A. /usr  B. /home   C. /root  D. /etc
答案:B
12. 如果要列出一个目录下的所有文件需要使用命令行 (    )。
A. ls –l  B. ls   C. ls –a   D. ls -d
答案:C
13. 利用哪个工具可以设置用户在文件系统中的空间大小 (   )。
A. turboservice  B. turbofscfg  C. turbonetcfg   D. turboxcfg
答案:B
14. 哪个命令可以将普通用户转换成超级用户 (   )
A. super  B. passwd  C. tar   D. su
答案:D
15. 哪个命令用来显示/home及其子目录下文件名(   )
A. ls -R /home  B. ls -d /home  C. ls -a /home    D. ls -l /home
答案:A
16. 在 vi 模式下，哪个命令用来删除光标处的字符 (    )
A. xd   B. x   C. dd   D. d
答案:B　　dd删除一行,x删除当前字符
17. 在一行内运行多个命令需要用什么字符隔开 (   )
A. @  B. $   C. ;  D. *
答案:C
18. 确定 myfile 的文件类型的命令是 (   )
A. whatis myfile
B. file myfile
C. type myfile
D. type -q myfile
答案:B
19. 哪些命令组合起来能统计多少用户登录系统 (    )
A. who | wc –w   B. who | wc –l   C. who | wc –c   D. who | wc
答案:BD
20. 用 "rm -i",系统会提示什么来让你确认 (   )
A. 命令行的每个选项  B. 是否真的删除  C. 是否有写的权限   D. 文件的位置
答案:B
21. Linux 启动的第一个进程 init 启动的第一个脚本程序是 (   )。
A. /etc/rc.d/init.d   B. /etc/rc.d/rc.sysinit  C. /etc/rc.d/rc5.d  D. /etc/rc.d/rc3.d
答案:B
22. 按下 (   ) 键能终止当前运行的命令
A. Ctrl-C   B. Ctrl-F   C. Ctrl-B   D. Ctrl-D
答案:a
23. 用来分离目录名和文件名的字符是 (   )
A. dash (-)  B. slash (/)  C. period (.)   D. asterisk (*)
答案:B
24. 系统的配置文件在 (  ) 目录下
A. /home   B. /dev  C. /etc   D. /usr
答案:C
25. 显示用户的主目录的命令是什么？(   )
A. echo $HOME  B. echo $USERDIR   C. echo $ENV  D. echo $ECHO
答案:A
26. 在 vi 编辑器里，哪个命令能将光标移到第 200 行 (    )
A. g200  B. G200  C. :200   D. 200g
答案:C
:200 可以，200G 也可以
27. 用"useradd jerry"命令添加一个用户，这个用户的主目录是什么？(   )
A. /etc/jerry   B. /var/jerry  C. /home/jerry   D. /bin/jerry
答案:C
28. 哪一个命令能用来删除当前目录及其子目录下名为'core'的文件 (   )
A. find . -name core -exec rm {} \ ;
B. find . -name core -exec rm ;
C. find . -name core -exec rm {} ;
D. find . -name core -exec rm {} -;
答案:A
29. 以下哪条命令在创建一个 xp 用户的时候将用户加入到 root 组中 (  )
A. useradd -g xp root  B. useradd -r root xp  C. useradd -g root xp   D. useradd root xp
答案:C
30. 不改变运行级别而重新读入 inittab 文件的命令是 (    )。
A. init s  B. init q  C. init S   D. init Q
答案:B
31. 以下哪个命令可以终止一个用户的所有进程 (   )
A. skillall   B. skill  C. kill   D. killall
答案:D
32. 通过修改哪个文件可以在创建用户的时候改变用 户主目录的路径 (   )
A. /etc/default/passwd   B. /etc/default/useradd  C. /etc/profile  D. /etc/fstab
答案:B
33. 以只读方式打开一个文件并进入 vi 编辑器的命令是 (   )
A. view -r filename   B. view filename   C. vi filename   D. vi -r filename
答案:B
34. 以下哪个命令是将缓存中的内容粘贴到光标之前 (   )
A. a   B. i   C. P   D. p
答案:C
35. 以下哪条 vi 命令能将文档 5-20 行间出现的 abc 替换成为 cba (   )
A. :1,$s/abc/cba/g　　　B. :5,20/abc/cba/g　　C. :5-20s/abc/cba/g　　　D. :5,20s/abc/cba/g
答案:D
. 在 vi 中通过哪条命令可以将 ps 命令执行的结果插入到文档中 (   )
A. :r!ps   B. :!ps   C. :!rps    D. :w!ps
答案:A
36. 以下哪个vi命令可以在当前位置插入/etc/passwd文本文件(   )
A. :r /etc/passwd   B. :i /etc/passwd  C. :w /etc/passwd   D. :s /etc/passwd
答案:A
37. vi 中复制整行的命令是 (   )
A. y1   B. yy   C. ss   D. dd
答案:B
38. 以下哪个 vi 命令可以给文档的每行加上一个编号 (    )
A. :e number   B. :set number  C. :r!date     D. :200g
答案:B
38. 以下哪些文件只有根用户才能读写 (   )
A. /etc/bashrc   B. /etc/profile   C. /etc/shadow    D. /etc/passwd
答案:BC
39. 使用 groupdel 删除一个组的时候，命令执行失败，原因可能是 (   )
A. 该组是系统组   B. 该组是空的   C. 该组中成员非空   D. 该组不存在
答案:CD
40. Linux 中文件名构成的规则比较灵活表现在 (   )
A. 文件名长度多达 256 个字符     B. 可以使用除了/符号外的所有ASCII字符
C. 不区分大小写            D. 无扩展名限制
答案:ABD
41. 对用户的口令进行加解锁的命令是 passwd，参数选项是 (   )
A. –l  B. –L  C. –u   D. -U
答案:AC
42. 如果你对文件和目录的权限不确定，则不能用 (   ) 命令来检测权限
A. ps   B. ck    C. ls –l   D. chown
答案:ABD
43. 选择对/proc文件系统不正确的描述(    )
A. 通常情况下，不提供中断、IO 端口、CPU 等信息   B. /proc 文件系统可以提供系统核心的许多参数
C. /proc 是一个虚拟的文件系统            D. 可以得到系统中运行的进程的一些信息
答案:A
44. 以下哪些符号可以用来连接多条命令 (   )
A. ||    B. &amp;&amp;   C. ;   D. |
答案:ABCD
45. 在 shell 中，下面哪些字符串当作普通字符串时候需要使用"\"来转义 (   )
A. 分号 (;)   B. 双引号 (")  C. 单引号 (')   D. 反斜杆 (\)
答案:BCD
46. Linux 中提供了几个重要的工具用来改变服务和进程的运行状态和运行级别以及初始化进程，它们是 (   )。
A. chkconfig  B. service  C. turboservice   D. ksysv
答案:ABCD
47. 在/etc/rc.d/init.d目录下的所有脚本至少支持两个运行参数,它们是(    )。
A. start   B. restart    C. stop   D. reload
答案:AC
48. Linux 一般被称为是稳定的服务器系统，它的安全性表现在 (   )
A. 网络防火墙  B. 用户管理策略 C. 系统、目录、文件的权限控制 D. 封闭源码便于及时修正漏洞等
答案:ABC
49. 在 vi 中下列哪些命令不能用来在光标前插入文本 (   )
A. p [text]　　B. i [text]　　C. o [text]　　　D. a [text]
答案:ACD
50. 在本地的文件系统中下列哪些 linux 路径结构是无效的 (   )
A. \usr/zhang/memo   B. /usr/zhang/memo   C. //usr\zhang/memo   D. \usr\zhang\memo
答案:ACD

二、简答题（1 题 3 分）

1.常见的 Linux 发行版本都有什么？你最擅长哪一个？它的官网网站是什么？说明你擅长哪一块？

2.Linux 开机启动流程详细步骤是什么？系统安装完，忘记密码如何破解？

4.某一天突然发现 Linux 系统文件只读，该怎么办呢？完整操作步骤。

5.安装一台系统使用 DVD 光盘安装，如何安装 50 台 Linux 系统如何安装呢？思考一下。

6.用虚拟机安装了一台 Linux 系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？

7.Linux 网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？

8.一般可以使用什么软件远程 linux 服务器？通过什么上传文件和下载文件？

9./mnt 目录主要用于什么？/root 目录跟 root 用户有什么关系？/根目录与/boot 目录有什么联系？

10.某一天误操作，执行了 rm  -rf  * ，会有哪些情况发生？请举例。


三、公有云题目（1 题 5 分）
1. 请解释上云的好处是什么？传统业务类型与公有云也为类型有什么区别？请举例说明。

2. 列出你用过的阿里云\AWS\Azure 服务？并讲述他们的作用？

3. 请列出你觉得阿里云\AWS\Azure 目前的特色和不成熟的地方是那些？你觉得应该如何改正。

4. 请用阿里云\AWS\Azure 设计一个视频网站的架构图并进行解释说明。

</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-03-23</cite> <i class="icon-tag"></i>
      <a href="/tags.html#基础知识">基础知识</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    

    <!-- Pagination links -->
    <nav>
      <ul class="pagination hidden-xs">
        
        
        <li>
          <a href="/page21">&laquo; Previous</a>
        </li>
        
        

        
        <li>
          <a href="/">1</a>
        </li>
        

        
          
            
            <li>
              <a href="/page2">2</a>
            </li>
            
            <li>
              <a href="/page3">3</a>
            </li>
            
            <li>
              <a href="/page4">4</a>
            </li>
            
            <li>
              <a href="/page5">5</a>
            </li>
            
            <li class="disabled"><span>...</span></li>
            <li class="active"><a>22</a></li>
          
          <li class="disabled"><span>...</span></li>
          <li><a href="/page24">24</a></li>
        

        
        

        
        <li>
          <a href="/page23">Next &raquo;</a>
        </li>
        
      </ul>
    </nav>
  </div>
  <div class="col-xs-12 col-md-4">
		<!-- <div>
			<a class="twitter-timeline" data-width="390" data-height="640" data-theme="light" href="https://twitter.com/samzong_lu?ref_src=twsrc%5Etfw">Tweets by SAMZONG</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
		</div> -->
    <div>
      <h2>传送门</h2>
      <ul>
        <li><a href="https://yuque.com/samzong">语雀-花园</a></li>
        <li><a href="https://github.com/samzong">Github</a></li>
      </ul>
    </div>
    <div class="categories">
      <h2>文章分类</h2>
      <ul class="tag_box">
        
        


  
     
    	
      <li><a href="/categories.html#故事汇">
    		故事汇 <span>23</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Linux">
    		Linux <span>22</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#前端">
    		前端 <span>5</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#数据库">
    		数据库 <span>30</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Git">
    		Git <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Mac">
    		Mac <span>16</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Tools">
    		Tools <span>7</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#OpenSource">
    		OpenSource <span>11</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Python">
    		Python <span>45</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#云平台">
    		云平台 <span>8</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#虚拟化">
    		虚拟化 <span>3</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Java">
    		Java <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Docker">
    		Docker <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Blog">
    		Blog <span>7</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#安全">
    		安全 <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#读书笔记">
    		读书笔记 <span>16</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#微服务">
    		微服务 <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Kubernetes">
    		Kubernetes <span>14</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#DaoCloud Enterprise">
    		DaoCloud Enterprise <span>2</span>
    	</a></li>
    
  



      </ul>
    </div>
    <div>
      <h2>最近文章</h2>
      <ul>
        
        <li>
          <a href="/post/2022/11/Copy-To-Markdwon.html">Copy to Markdown</a>
          背景


        </li>
        
        <li>
          <a href="/post/2022/11/Dubbo-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html">Dubbo 基础知识梳理</a>
          
  参考资料：



        </li>
        
        <li>
          <a href="/post/2022/11/Panads-fill-NaN-value-to-Zero.html">Panads fill NaN value to Zero</a>
          ```python
df = pandas.read_csv(‘somefile.txt’)


        </li>
        
        <li>
          <a href="/post/2022/10/Redash-for-Docker-%E9%83%A8%E7%BD%B2.html">Redash for Docker 部署</a>
          
  暗坑很多



        </li>
        
        <li>
          <a href="/post/2022/10/JWT-%E5%86%85%E7%BD%AE%E7%9A%84%E6%96%B9%E5%BC%8F.html">JWT 内置的方式</a>
          
  支持为 API 启用 jwt token 解码的能力 ,  读取网关的 jwt key
    
      读取请求 Header 中的 Authorization
    
  
  需要支持为网关配置多 jwt key , and 加密长度 ?
    
      解密的性能问题
      expire_time 过期时间的配置
      解密后的参数传递
    
  



        </li>
        
      </ul>
    </div>
  </div>
</div>

			</div>

		</div>

    <footer>
      <div class="container">
        <div class="row mobilepadding">
          			<hr>
      &copy; 2022 船长. Powered by <a href="http://jekyllrb.com" target="_blank" title="The simple, blog-aware, static site generator.">Jekyll</a>. Theme Creator <a href="https://github.com/einverne" target="_blank" title="Ein Verne's GitHub Repos">Ein Verne</a> . Host on <a href="https://github.com/samzong/samzong.me" target="_blank" title="Samzong's GitHub Repos">Github</a> .
      <br><br>
      </div>
    </div>
    </footer>

    




	<script async type="text/javascript" src="/assets/themes/evjekylltheme/bootstrap-3.3.5/js/bootstrap.min.js"></script>
	<script async type="text/javascript" src="/assets/themes/evjekylltheme/webcore.js"></script>

 </body>
</html>

