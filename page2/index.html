
<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Blog">
  <head>
    <meta charset="utf-8">
	<link rel="manifest" href="/static/pwa/manifest.json">
	<title> Home | 船长的课记 </title>
    
		
    <meta name="author" content="船长">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="theme-color" content="#2196F3">
	<meta name="google-site-verification" content="puZt0ZyqB-t67BYdYAgLUyIPBeismG68J0dmEc01QeY" />

	
    <script>
		if ('serviceWorker' in navigator) {
			window.addEventListener('load', function () {
				navigator.serviceWorker
										.register('/sw.js')
										.then(function(registration) {
											console.log("Successfully registered service worker", registration.scope);
										}).catch(function(err) {
											console.log("Service worker registration failed: ", err);
										});
				//navigator.serviceWorker.ready always resolve
				navigator.serviceWorker.ready.then(function (registration) {
					console.log('Service worker successfully registered on scope', registration.scope);
				});
			});
		}
    </script>
	<script type="text/javascript" src="/assets/themes/evjekylltheme/jquery-3.6.0.slim.min.js"></script>

	<link href="/assets/themes/evjekylltheme/google-code-prettify/desert.css" type="text/css" rel="stylesheet" />

    <!-- Le styles -->
    <link href="/assets/themes/evjekylltheme/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/evjekylltheme/css/style.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/images/favicon.ico">

    <!-- atom & rss feed -->
    <link href="" type="application/atom+xml" rel="alternate" title="Jekyll auto generate ATOM Feed">
    <link href="" type="application/atom+xml" rel="alternate" title="Site ATOM Feed">
    <link href="" type="application/rss+xml" rel="alternate" title="Site RSS Feed">
	<link rel="stylesheet" href="/assets/themes/evjekylltheme/font-awesome-4.4.0/css/font-awesome.min.css">
	<!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-W2LDG64');</script> -->
		<!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8529425670069509"
						crossorigin="anonymous"></script> -->
	<!-- <script async src="https://cdn.splitbee.io/sb.js"></script> -->
  </head>

  <body>
	<!-- <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2LDG64"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> -->
    <div class="navbar navbar-default navbar-fixed-top">
				<div class="container">
          <div class="row mobilepadding">
					<!-- <a class="navbar-brand" href="/">船长的课记</a> -->
					<a class="navbar-brand" href="/">SAMZONG</a>
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse" id="mNavbar">
  					<ul class="nav navbar-nav">
  						
  						
  						


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/friends.html">Friends</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



						  <li class="dropdown">
							  <a class="dropdown-toggle" data-toggle="dropdown" href="#">Other</a>
							  <ul class="dropdown-menu">
									<li><a href="/about.html">About</a></li>
									<li><a href="https://yuque.com/samzong/note" target="_blank">船长的课记</a></li>
									<li><a href="https://yuque.com/samzong/ap" target="_blank">果粉日记</a></li>
									<li><a href="https://yuque.com/samzong/code" target="_blank">Code Snippet</a></li>
									<li><a href="https://www.yuque.com/samzong/mcx" target="_blank">集</a></li>
									<li><a href="https://www.yuque.com/zooka" target="_blank">藏金阁</a></li>
								</ul>
						  </li>
  					</ul>
  					<form id="search-form" class="navbar-form navbar-right" role="search">
  						<div class="form-group">
  						<input type="text" class="form-control input-sm" placeholder="Search's Bad" id="query">
  						</div>
  					</form>
  					<div class="nav-icon">
  						<a href="/feed.xml"><i class="fa fa-rss fa-2x"></i></a>
  					</div>
          </div>
				</div>
      </div>
    </div>

    <div class="container">
			<div class="row mobilepadding">
        <div class="row">
					<div class="col-md-12">
						<div class="searchresult">
						</div>
						<div id="search-loader" class="img-wrap">
						</div>
					</div>
        </div>
				<meta itemprop="image" content="https://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com/uPic/telegram-cloud-photo-size-4-5971176114485308439-x.jpg">
<div class="row">
  <div class="col-xs-12 col-md-8">
    
    
    <h1><a class="title" href="/post/2022/11/Docker-for-Mac-%E7%BD%91%E7%BB%9C%E6%8A%80%E5%B7%A7.html">Docker for Mac 网络技巧</a></h1>
    <div class="post_at_index">
      <p>在 Windows 和 Linux 中使用 Docker ，可以通过 docker0 这个网络 IP，在容器内访问宿主机的端口及服务</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  ~ ifconfig
docker0: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:65:e2:82:de  txqueuelen 0  <span class="o">(</span>Ethernet<span class="o">)</span>
        RX packets 19240  bytes 9107695 <span class="o">(</span>8.6 MiB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 16989  bytes 9952021 <span class="o">(</span>9.4 MiB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre></div></div>

<p>但以上在 macOS 中无 docker0 端口，那我们如何在 Docker for Mac 中访问宿主机的服务呢？</p>

<blockquote>
  <p>docker.for.mac.host.internal</p>
</blockquote>

<p>可以采用以上本地域名内实现在容器内访问 宿主机的服务</p>

      
    </div>
    <br/>
    <div>
      <cite>2022-11-17</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Docker">Docker</a>
      , 
      <a href="/tags.html#Mac">Mac</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/11/Dubbo-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html">Dubbo 基础知识梳理</a></h1>
    <div class="post_at_index">
      <blockquote>
  <p>参考资料：</p>
</blockquote>

<ul>
  <li><a href="https://juejin.cn/post/7128953614403371015#heading-5">https://juejin.cn/post/7128953614403371015#heading-5</a></li>
  <li><a href="https://dubbo.apache.org/zh/docs/">https://dubbo.apache.org/zh/docs/</a></li>
</ul>

<h2 id="简介">简介</h2>

<ul>
  <li>Apache Dubbo 一款基于RPC服务开发的云原生微服务框架，与 SpringCloud 类似</li>
  <li>使用 Dubbo 开发的微服务原生具备相互之间远程地址发现(注册中心)和通信的能力</li>
  <li>Dubbo 支持丰富的服务治理特性，包含 服务发现、负载均衡、流量调度 等，高度可扩展</li>
  <li>Dubbo 由 阿里巴巴 开发，并贡献给 Apache</li>
</ul>

<h2 id="发展历程">发展历程</h2>

<h3 id="版本迭代">版本迭代</h3>

<p><img src="http://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com//uPic/20221117023215.png?x-oss-process=image/resize,w_960,m_lfit" alt="resize,w_960,m_lfit" /></p>

<h3 id="软件生态的活跃度">软件生态的活跃度</h3>

<p><img src="http://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com//uPic/8G8hZG.jpg?x-oss-process=image/resize,w_960,m_lfit" alt="resize,w_960,m_lfit" /></p>

<h2 id="与-springcloud-相比的优势">与 SpringCloud 相比的优势</h2>

<ul>
  <li>功能丰富，基于原生库即可完成大部分的微服务治理能力</li>
  <li>支持超大规模的微服务机器设计，高性能 RPC 通信协议实现</li>
  <li>高度可扩展性，支持在调用过程中对流量及协议进行拦截扩展，如 Filter、Router、LB 等</li>
  <li>支持微服务治理的扩展组件
    <ul>
      <li>Registry 注册中心： Zookeeper、Nacos</li>
      <li>Config Center 配置中心： Zookeeper、Nacos</li>
      <li>Metadata Center 元数据中心 (Dubbo3支持)</li>
    </ul>
  </li>
</ul>

<h2 id="dubbo-的基础概念介绍">Dubbo 的基础概念介绍</h2>

<ul>
  <li>RPC 通信</li>
  <li>服务发现</li>
  <li>流量治理</li>
</ul>

<h3 id="rpc-通信">RPC 通信</h3>

<ul>
  <li>Dubbo3之中， RPC 通信主要使用 Triple 协议，构建在 HTTP/2 协议之上，兼容 gRPC</li>
  <li>提供 Request Response、Request Streaming、Response Streaming、Bi-directional Streaming 通信模型</li>
  <li>支持 IDL ，基于 Triple 协议</li>
</ul>

<h3 id="服务发现">服务发现</h3>

<p>服务发现，是消费端自动发现服务地址列表的能力，是微服务框架需要具备的关键能力，借助于自动化的服务发现，微服务之间在无需感知对端部署位置与IP地址的情况下实现通信。</p>

<p>Dubbo提供的Client-Based服务发现机制，同时也需要第三方注册中心来协调服务发现过程，比如Nacos/Zookeeper等。</p>

<p><img src="http://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com//uPic/oaqyGX.jpg?x-oss-process=image/resize,w_960,m_lfit" alt="resize,w_960,m_lfit" /></p>

<h3 id="流量治理">流量治理</h3>

<ul>
  <li>Dubbo2开始，Dubbo就提供了丰富的服务治理规则，包括路由规则/动态配置等</li>
  <li>Dubbo3之中的实现
    <ul>
      <li>Dubbo Mesh : 通过对接 xDS 对接到时下流行的 Mesh 产品如 Istio 中所使用的以 VirtualService、DestinationRule 为代表的治理规则</li>
      <li>另一方面 Dubbo 正寻求设计一套自有规则以实现在不通部署场景下的流量治理，以及灵活的治理能力。</li>
    </ul>
  </li>
</ul>

<h2 id="dubbo-mesh">Dubbo Mesh</h2>

<p>Dubbo Mesh 的目标是提供适应 Dubbo 体系的完整 Mesh 解决方案，包含定制化控制面（Control Plane）、定制化数据面解决方案。Dubbo 控制面基于业界主流 Istio 扩展，支持更丰富的流量治理规则、Dubbo应用级服务发现模型等，Dubbo 数据面可以采用 Envoy Sidecar，即实现 Dubbo SDK + Envoy 的部署方案，也可以采用 Dubbo Proxyless 模式，直接实现 Dubbo 与控制面的通信。</p>

<p><img src="http://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com//uPic/vMniiR.jpg?x-oss-process=image/resize,w_960,m_lfit" alt="resize,w_960,m_lfit" /></p>

<h2 id="dubbo3">Dubbo3</h2>

<p>Dubbo 3.0 提供的新特性包括：</p>

<ul>
  <li><strong>新的地址发现模型（应用级服务发现）</strong>
    <ul>
      <li>查看<a href="https://dubbo.apache.org/zh/docs/migration/migration-service-discovery">应用级服务发现的迁移步骤</a></li>
      <li>查看应用级服务发现的使用方式</li>
      <li>查看应用级服务发现设计与实现</li>
    </ul>
  </li>
  <li><strong>下一代基于 HTTP/2 的 Triple 协议</strong>
    <ul>
      <li>查看<a href="https://dubbo.apache.org/zh/docs/migration/migration-triple">Triple 协议迁移步骤</a></li>
      <li>查看 <a href="https://dubbo.apache.org/zh/docs/references/protocols/tri">Triple 协议使用方式</a></li>
      <li>查看 Triple 协议设计与实现</li>
    </ul>
  </li>
  <li><strong>统一的路由规则。</strong>
    <ul>
      <li>查看<a href="https://dubbo.apache.org/zh/docs/migration/migration-routingrule/">统一路由规则的迁移步骤</a></li>
      <li>查看<a href="https://dubbo.apache.org/zh/docs/references/routers/">统一路由规则使用方式</a></li>
      <li>查看统一路由规则设计与实现</li>
    </ul>
  </li>
</ul>

      
    </div>
    <br/>
    <div>
      <cite>2022-11-16</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Dubbo">Dubbo</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/11/Panads-fill-NaN-value-to-Zero.html">Panads fill NaN value to Zero</a></h1>
    <div class="post_at_index">
      <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'somefile.txt'</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>


      
    </div>
    <br/>
    <div>
      <cite>2022-11-10</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Pandas">Pandas</a>
      , 
      <a href="/tags.html#Python">Python</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/10/Redash-for-Docker-%E9%83%A8%E7%BD%B2.html">Redash for Docker 部署</a></h1>
    <div class="post_at_index">
      <p><strong>暗坑很多</strong></p>

<h2 id="部署过程">部署过程</h2>

<ol>
  <li>需要自行维护一个 env 作为配置文件.</li>
</ol>

<!---->

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>REDASH_COOKIE_SECRET=a07cca441ab9f28b66c589f3118e0de48469b1bc6a5036eade7badbed305d96e
POSTGRES_HOST_AUTH_METHOD=trust
REDASH_REDIS_URL=redis://redis:6379/0
REDASH_DATABASE_URL=postgresql://postgres
</code></pre></div></div>

<ol>
  <li>需要创建一个 postgres-data 并配置 docker-compose.yml 的路径，数据库持久化</li>
  <li>需要给 postgres 容器增加 sudo 命令
    <ol>
      <li>apk add sudo</li>
    </ol>
  </li>
  <li>需要手工进入到 postgresql 容器内创建 role 和 database
    <ol>
      <li>createuser -U postgres redash</li>
      <li>createdb -U postgres redash</li>
    </ol>
  </li>
  <li>执行数据库初始化动作</li>
  <li>docker-compose run –rm server create_db</li>
  <li>然后重启 redash 全部服务即可 docker-compose down 后重启</li>
</ol>

<blockquote>
  <p>postgresql 在执行 psql 命令时，默认会读取当前系统用户作为执行 role；但 psql 默认用户是 postgres</p>
</blockquote>

<p><a href="https://redash.io/help/open-source/setup">https://redash.io/help/open-source/setup</a>
<a href="https://redash.io/help/open-source/dev-guide/docker">https://redash.io/help/open-source/dev-guide/docker</a>
<a href="https://docs.victoriametrics.com/url-examples.html#apiv1exportcsv">https://docs.victoriametrics.com/url-examples.html#apiv1exportcsv</a></p>

<p><a href="https://mp.weixin.qq.com/s?src=11\&amp;timestamp=1660629444\&amp;ver=3985\&amp;signature=verv70veamW*Ez2Sgc8e89yMJGwANIOzz4lfwbezyVV3wpWNT2d9SnGrDecUOwrbTJBR2o-Ax6ZS4Fpu2UxfX7Sy9xsk1LCXfY1wNr42ucl3tFePfJ7c536c8z*L-HOy\&amp;new=1">https://mp.weixin.qq.com/s?src=11\&amp;timestamp=1660629444\&amp;ver=3985\&amp;signature=verv70veamW<em>Ez2Sgc8e89yMJGwANIOzz4lfwbezyVV3wpWNT2d9SnGrDecUOwrbTJBR2o-Ax6ZS4Fpu2UxfX7Sy9xsk1LCXfY1wNr42ucl3tFePfJ7c536c8z</em>L-HOy\&amp;new=1</a></p>

<p><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1660682601&amp;ver=3986&amp;signature=h8m0RzEX3qWsKcUo6Ee3azdsnzLQqUf3N8FdLhyWNa52U4vAvlbEaBFUCrTZnh54tT-YS2mODfkp-6Hemmzt3n*hzGHlEmXP-HO5830W0Fzmn4MMfnsOPBKLrcjaiU0h&amp;new=1">https://mp.weixin.qq.com/s?src=11&amp;timestamp=1660682601&amp;ver=3986&amp;signature=h8m0RzEX3qWsKcUo6Ee3azdsnzLQqUf3N8FdLhyWNa52U4vAvlbEaBFUCrTZnh54tT-YS2mODfkp-6Hemmzt3n*hzGHlEmXP-HO5830W0Fzmn4MMfnsOPBKLrcjaiU0h&amp;new=1</a></p>

<ul>
  <li>redash env 配置: <a href="https://redash.io/help/open-source/admin-guide/env-vars-settings">https://redash.io/help/open-source/admin-guide/env-vars-settings</a></li>
  <li>postgres 权限问题 <a href="https://stackoverflow.com/a/25051632/5067657">https://stackoverflow.com/a/25051632/5067657</a></li>
  <li><a href="https://techoverflow.net/2021/05/07/how-to-fix-alpine-linux-ash-sudo-not-found/">https://techoverflow.net/2021/05/07/how-to-fix-alpine-linux-ash-sudo-not-found/</a></li>
  <li><a href="https://discuss.redash.io/t/error-99-connecting-to-localhost-6379-cannot-assign-requested-address/9716/7">https://discuss.redash.io/t/error-99-connecting-to-localhost-6379-cannot-assign-requested-address/9716/7</a></li>
</ul>

<h2 id="启动的服务介绍">启动的服务介绍</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>v10-redashio_adhoc_worker_1					# 执行查询任务的 worker
v10-redashio_postgres_1							# 数据库
v10-redashio_redis_1								# 缓存
v10-redashio_scheduled_worker_1			# 执行计划任务的 worker
v10-redashio_scheduler_1						# 计划任务管理 server
v10-redashio_server_1								# 主体 server
</code></pre></div></div>

<p>以上主要会设计到 3 个镜像，redis、pgsql、redash，其中核心是 redash，所以关注镜像版本也是这个</p>

<h2 id="版本升级">版本升级</h2>

<p>redash 的版本升级较为方便，更换 server 的镜像；然后升级数据库即可。</p>

<blockquote>
  <p>测试过从 v8 升级到 v10 , 和 v9 升级到 v10 ，都是 ok 的.</p>
</blockquote>

<ol>
  <li>关闭 Redash 服务
    <ol>
      <li><code class="language-plaintext highlighter-rouge">docker-compose stop server scheduler scheduled_worker adhoc_worker</code></li>
    </ol>
  </li>
  <li>更新 docker-compose.yml
    <ol>
      <li>基本上这一步，只需要更新 redash 的镜像版本即可</li>
      <li>然后执行 <code class="language-plaintext highlighter-rouge">docker-compose pull</code> 拉取新镜像版本</li>
    </ol>
  </li>
  <li>执行数据库升级
    <ol>
      <li><code class="language-plaintext highlighter-rouge">docker-compose run --rm server manage db upgrade</code></li>
    </ol>
  </li>
  <li>启动全部服务即可
    <ol>
      <li><code class="language-plaintext highlighter-rouge">docker-compse up -d</code></li>
    </ol>
  </li>
</ol>

<h2 id="解决-es-的https问题">解决 ES 的HTTPS问题</h2>

<p>由于我们的 es 地址访问地址采用 https，但为自签证书，所以在 request 之中会有些问题， 所以我在这里更新了 elasticsearch 的插件，然后将其上传到我个人的 docker hub.
<a href="https://hub.docker.com/r/samzong/redash">https://hub.docker.com/r/samzong/redash</a></p>

<blockquote>
  <p>带来的问题，页面上无法选择到 Elasticsearch 作为数据源，没时间去研究了</p>
</blockquote>

<p>看了下还是可以使用 redash 的 API 去创建的 <code class="language-plaintext highlighter-rouge">/api/data_sources</code></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"basic_auth_password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-----"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"basic_auth_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elastic"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://10.6.51.101:31001/"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"skip_tls_verification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elasticsearch"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test-es"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>创建完成后，就可以在页面上更新了。</p>

      
    </div>
    <br/>
    <div>
      <cite>2022-10-22</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Redash">Redash</a>
      , 
      <a href="/tags.html#BI">BI</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/09/GitLab-Forked-%E5%A6%82%E4%BD%95%E8%B7%9F%E9%9A%8Fupstream%E4%B8%BB%E5%BA%93.html">GitLab Forked 如何跟随upstream主库</a></h1>
    <div class="post_at_index">
      <p>:::info
通过 PR 的方式共同对主仓库进行贡献的方式，是开源项目协作的非常有效的方法；通常我们不会直接对主仓库直接提交代码。
:::</p>

<p>一般情况下，我们的操作是，在需要贡献时，Fork 一份项目，然后自己修改以 PR 的方式提交贡献请求。</p>

<p><img src="http://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com//uPic/1664330743895-9b2e0dc6-527e-4bcd-8b63-c223aa634b8f.png?x-oss-process=image/resize,w_960,m_lfit" alt="image.png" title="一份完整的 Github贡献指南" /></p>

<h2 id="github-的实现方式">Github 的实现方式</h2>

<p>熟悉 Github 的同学会发现，在 Github 上最近更新了 <code class="language-plaintext highlighter-rouge">Sync fork</code>的功能，通过简单的点击操作，即可完成对源库(upstream) 的更新同步。
<img src="http://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com//uPic/1664330528512-563a5536-1734-4fd0-b41c-9c5d121327e0.jpeg?x-oss-process=image/resize,w_960,m_lfit" alt="CleanShot 2022-09-28 at 10.01.33.jpg" title="当 upstream 超前时，提示 update branch" />
通过以上方式，我们可以方便在跟随主库的更新</p>

<blockquote>
  <p>Tips Github 的方式，仅在 Web端 和 Github CLI 官方提供的 GH 才可以使用这样的功能</p>
</blockquote>

<h2 id="no-github-when-gitlab-">No Github, When Gitlab ?</h2>

<p>Github 更多在开源项目时贡献，实际上，在我们日常的工作当中，更多会有自建的Gitlab或者其他的代码 Hub，这里以 Gitlab 为例</p>

<p><img src="http://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com//uPic/1664331575915-853554f5-c047-4f14-8e79-67e2214429bc.jpeg?x-oss-process=image/resize,w_960,m_lfit" alt="CleanShot 2022-09-28 at 10.19.20.jpg" title="gitlab 默认项目首页" />
Gitlab 并未提供 Sync fork 的功能，所以我们需要自行解决同步的需求</p>

<h2 id="为仓库添加-upstream-源仓库">为仓库添加 upstream 源仓库</h2>

<p>:::success
以下方式会在终端或本地使用<code class="language-plaintext highlighter-rouge">Sourcetree</code>更加自由，仅使用 Git 的方式协作，自由度很大
:::
基于这个方式我们可以实现，有关联的 主库到从库的同步；也可以完成跨 Hub 的同步，比如：</p>

<ul>
  <li>Github -&gt;  Gitlab</li>
  <li>Github -&gt; Github</li>
  <li>Gitlab  -&gt; Gitlab</li>
  <li>Gitlab  -&gt;  Github</li>
  <li>Gitee  -&gt;  Gitlab</li>
  <li>Gitee -&gt; Github</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>samzonglu at samzongs-MacBook-Pro <span class="k">in</span> ~/Git/daocloud/DaoCloud-docs<span class="o">(</span>main✔<span class="o">)</span>
± git remote add upstream https://github.com/DaoCloud/DaoCloud-docs.git
Alias tip: gra upstream https://github.com/DaoCloud/DaoCloud-docs.git

samzonglu at samzongs-MacBook-Pro <span class="k">in</span> ~/Git/daocloud/DaoCloud-docs<span class="o">(</span>main✔<span class="o">)</span>
± git remote
Alias tip: gr
origin
upstream

samzonglu at samzongs-MacBook-Pro <span class="k">in</span> ~/Git/daocloud/DaoCloud-docs<span class="o">(</span>main✔<span class="o">)</span>
± git fetch upstream
Alias tip: gf upstream
remote: Enumerating objects: 1268, <span class="k">done</span><span class="nb">.</span>
remote: Counting objects: 100% <span class="o">(</span>182/182<span class="o">)</span>, <span class="k">done</span><span class="nb">.</span>
remote: Compressing objects: 100% <span class="o">(</span>5/5<span class="o">)</span>, <span class="k">done</span><span class="nb">.</span>
remote: Total 1268 <span class="o">(</span>delta 177<span class="o">)</span>, reused 182 <span class="o">(</span>delta 177<span class="o">)</span>, pack-reused 1086
Receiving objects: 100% <span class="o">(</span>1268/1268<span class="o">)</span>, 1.87 MiB | 2.74 MiB/s, <span class="k">done</span><span class="nb">.</span>
Resolving deltas: 100% <span class="o">(</span>637/637<span class="o">)</span>, completed with 119 <span class="nb">local </span>objects.
From https://github.com/DaoCloud/DaoCloud-docs
 <span class="k">*</span> <span class="o">[</span>new branch]      feature/theme                            -&gt; upstream/feature/theme
 <span class="k">*</span> <span class="o">[</span>new branch]      fix-typo                                 -&gt; upstream/fix-typo
 <span class="k">*</span> <span class="o">[</span>new branch]      gh-pages                                 -&gt; upstream/gh-pages
 <span class="k">*</span> <span class="o">[</span>new branch]      main                                     -&gt; upstream/main
 <span class="k">*</span> <span class="o">[</span>new branch]      patch-new-gh-pages-01                    -&gt; upstream/patch-new-gh-pages-01
 <span class="k">*</span> <span class="o">[</span>new branch]      stash/bug-codes                          -&gt; upstream/stash/bug-codes

samzonglu at samzongs-MacBook-Pro <span class="k">in</span> ~/Git/daocloud/DaoCloud-docs<span class="o">(</span>main✔<span class="o">)</span>
± git pull upstream main
Alias tip: gl upstream main
From https://github.com/DaoCloud/DaoCloud-docs
 <span class="k">*</span> branch            main       -&gt; FETCH_HEAD
Already up to date.

samzonglu at samzongs-MacBook-Pro <span class="k">in</span> ~/Git/daocloud/DaoCloud-docs<span class="o">(</span>main✔<span class="o">)</span>
± git push origin main
Alias tip: gp origin main
Everything up-to-date
</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2022-09-28</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Git">Git</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/09/Poetry-%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0.html">Poetry 使用笔记</a></h1>
    <div class="post_at_index">
      <p>poetry 是目前比较流行的 Python 环境管理工具 和 包管理工具，对多项目开发时的环境隔离有非常大的帮助，同时集成了包管理能力。</p>

<blockquote>
  <p>官方网站  <a href="https://python-poetry.org/">https://python-poetry.org/</a>   集成了所有 Poetry 最新的使用文档，以下仅在我的环境上经过验证</p>
</blockquote>

<h3 id="安装方式">安装方式</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># In Pip
</span><span class="o">-</span> <span class="n">安装</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">poetry</span> <span class="c1"># pip3
</span><span class="o">-</span> <span class="n">更新</span> <span class="n">poetry</span> <span class="bp">self</span> <span class="n">update</span>

<span class="c1"># In my Mac
</span><span class="o">-</span> <span class="n">安装</span> <span class="n">brew</span> <span class="n">install</span> <span class="n">poetry</span>
<span class="o">-</span> <span class="n">更新</span> <span class="n">brew</span> <span class="n">upgrade</span> <span class="n">poetry</span>

<span class="c1"># In my CentOS
</span><span class="o">-</span> <span class="n">安装</span> <span class="n">curl</span> <span class="o">-</span><span class="n">sSL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">poetry</span><span class="o">/</span><span class="n">poetry</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">get</span><span class="o">-</span><span class="n">poetry</span><span class="p">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">python</span> <span class="o">-</span>
<span class="o">-</span> <span class="n">更新</span> <span class="n">poetry</span> <span class="bp">self</span> <span class="n">update</span>
</code></pre></div></div>

<h3 id="配置技巧相关">配置技巧相关</h3>

<p>在开始使用前，建议先对poetry 的配置有些了解，并调整为适合你的方式，主要是调整一下虚拟环境的安装位置
:::info
<code class="language-plaintext highlighter-rouge">poetry config</code> poetry 相关的查看和编辑的命令
:::</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">~</span> <span class="n">poetry</span> <span class="n">config</span> <span class="o">--</span><span class="nb">list</span>  <span class="c1"># 获取当前 poetry 的配置情况
</span>
<span class="n">cache</span><span class="o">-</span><span class="nb">dir</span> <span class="o">=</span> <span class="s">"/Users/$username/Library/Caches/pypoetry"</span>
<span class="n">experimental</span><span class="p">.</span><span class="n">new</span><span class="o">-</span><span class="n">installer</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">installer</span><span class="p">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">virtualenvs</span><span class="p">.</span><span class="n">create</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">virtualenvs</span><span class="p">.</span><span class="ow">in</span><span class="o">-</span><span class="n">project</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">virtualenvs</span><span class="p">.</span><span class="n">path</span> <span class="o">=</span> <span class="s">"{cache-dir}/virtualenvs"</span>  <span class="c1"># /Users/$username/Library/Caches/pypoetry/virtualenvs
</span>
</code></pre></div></div>

<p>| <strong>配置项目</strong> | <strong>配置内容</strong> | <strong>配置项说明</strong> | <strong>建议配置</strong> |
| — | — | — | — |
| cache-dir | String | 缓存目录配置，使用 poetry 安装的包源文件都会缓存到这个目录。 | 不建议更改 |
| installer.parallel | boolean | 此配置会被忽略 |  |
| virtualenvs.create | boolean | 默认为true，如果当前工程的虚拟环境不存在，就创建一个 | 不建议更改 |
| virtualenvs.in-project | boolean | None：poetry 会在系统特定目录创建一个.venv目录，由下面的 path 参数指定
true： poetry 会在项目根目录创建一个.venv目录
false： poetry 将会忽略已存在的.venv目录 | <strong>《建议修改》</strong></p>

<table>
  <tbody>
    <tr>
      <td>推荐这种方式，在项目根目录创建虚拟环境，这样就算移动目录位置也不影响虚拟环境的使用</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>virtualenvs.path</td>
      <td>string</td>
      <td>默认是{cache-dir}/virtualenvs，虚拟环境创建的目录，如果上面的 in-project 为 true，此配置就无效</td>
      <td>不建议更改</td>
    </tr>
  </tbody>
</table>

<p>:::danger
建议 在使用前 启用 virtualenvs.in-project ，这样会在每个项目下有一个.venv 方便隔离管理
:::</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># poetry 配置说明
</span><span class="n">poetry</span> <span class="n">config</span> <span class="n">virtualenvs</span><span class="p">.</span><span class="ow">in</span><span class="o">-</span><span class="n">project</span> <span class="n">true</span>
</code></pre></div></div>

<h3 id="poetry-常用指令说明">poetry 常用指令说明</h3>

<table>
  <thead>
    <tr>
      <th><strong>Poetry Command</strong></th>
      <th><strong>解释</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$ poetry –version</td>
      <td>显示您的 Poetry 安装版本。</td>
    </tr>
    <tr>
      <td>$ poetry new</td>
      <td>创建一个新的Poetry项目。</td>
    </tr>
    <tr>
      <td>$ poetry init</td>
      <td>将 Poetry 添加到现有项目中。</td>
    </tr>
    <tr>
      <td>$ poetry run</td>
      <td>使用 Poetry 执行给定的命令。</td>
    </tr>
    <tr>
      <td>$ poetry add</td>
      <td>添加一个包pyproject.toml并安装它。</td>
    </tr>
    <tr>
      <td>$ poetry update</td>
      <td>更新项目的依赖项。</td>
    </tr>
    <tr>
      <td>$ poetry install</td>
      <td>安装依赖项。</td>
    </tr>
    <tr>
      <td>$ poetry show</td>
      <td>列出已安装的软件包。</td>
    </tr>
    <tr>
      <td>$ poetry lock</td>
      <td>将最新版本的依赖项固定到poetry.lock.</td>
    </tr>
    <tr>
      <td>$ poetry lock –no-update</td>
      <td>刷新poetry.lock文件而不更新任何依赖版本。</td>
    </tr>
    <tr>
      <td>$ poetry check</td>
      <td>验证pyproject.toml。</td>
    </tr>
    <tr>
      <td>$ poetry config –list</td>
      <td>显示 Poetry 配置。</td>
    </tr>
    <tr>
      <td>$ poetry env list</td>
      <td>列出项目的虚拟环境。</td>
    </tr>
    <tr>
      <td>$ poetry export</td>
      <td>导出poetry.lock为其他格式。</td>
    </tr>
  </tbody>
</table>

<h3 id="新项目初始化流程">新项目初始化流程</h3>

<blockquote>
  <p>这里以 初始化一个  FastAPI 项目作为 实例</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  fastapi poetry new fastapi-demo
Created package fastapi_demo <span class="k">in </span>fastapi-demo
➜  fastapi <span class="nb">ls</span> <span class="nt">-lh</span> fastapi-demo
total 8
<span class="nt">-rw-r--r--</span>  1 samzonglu  staff     0B  2 15 14:28 README.rst
drwxr-xr-x  3 samzonglu  staff    96B  2 15 14:28 fastapi_demo
<span class="nt">-rw-r--r--</span>  1 samzonglu  staff   304B  2 15 14:28 pyproject.toml
drwxr-xr-x  4 samzonglu  staff   128B  2 15 14:28 tests

➜  fastapi <span class="nb">cd </span>fastapi-demo
➜  fastapi-demo poetry <span class="nb">env </span>use 3.10.2  <span class="c"># 配置项目的虚拟环境</span>

</code></pre></div></div>

<h3 id="requirementstxt-已存在项目使用poetry">requirements.txt 已存在项目使用poetry</h3>

<p>这里会遇到一个问题，已存在的项目基本都已经有了 requirements.txt， 所以 poetry 最好可以直接读取它</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>poetry add <span class="sb">`</span><span class="nb">cat </span>requirements.txt<span class="sb">`</span>
</code></pre></div></div>

<p>将项目依赖导出为  requirements.txt</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>poetry <span class="nb">export</span> <span class="nt">--output</span> requirements.txt
</code></pre></div></div>

<h2 id="更新内容">更新内容</h2>

<p>如何把项目移交给一个 not use Poetry 的人运行，对于 Python 的 环境包 依赖，上述的 ouput/input 的方式，会存在一些问题，这里进行纠正。</p>

<h3 id="问题-pip-freeze-不能用了">问题 pip freeze 不能用了</h3>

<p>:::warning
pip freeze &gt; requirements.txt
:::</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>anyio @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/cd/3f/ae/baff749ce6cb4d7985e4142650605d2d30cb92eb418e2d121868e4413d/anyio-3.6.1-py3-none-any.whl
certifi @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/b1/9b/6f/cd63ce97294ee9a1fb57e5cebf02f251fbb8f9ac48353a27ceeddc410b/certifi-2022.6.15-py3-none-any.whl
charset-normalizer @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/86/c8/3e/d878881698fbd2b72f484e4fca340588d633102920a002b66a293f9480/charset_normalizer-2.1.0-py3-none-any.whl
click @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/63/f3/4c/2270b95f4d37b9ea73cd401abe68b6e9ede30380533cd4e7118a8e3aa3/click-8.1.3-py3-none-any.whl
fastapi @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/f9/37/53/c998e9ffd7ace66218174711f5c3ef1026a0bd3cd72f5fe2908e9b949b/fastapi-0.78.0-py3-none-any.whl
h11 @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/ef/5c/a2/a6d556bc5e3493616e52726df9c880b2da2fbf9c3be5e8351c84fbfafd/h11-0.13.0-py3-none-any.whl
idna @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/90/36/8c/81eabf6ac88608721ab27f439c9a6b9a8e6a21cc58c59ebb1a42720199/idna-3.3-py3-none-any.whl
pydantic @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/c2/13/d4/b9f7dbf75702d85504b4a5f36545ff903c7e2264d4889e94ce02637276/pydantic-1.9.1-cp310-cp310-macosx_11_0_arm64.whl
requests @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/14/1f/4d/1b93db6513b8ab38db841e4ce62691288ba549a5c1b6f3ca7274a1c9fd/requests-2.28.1-py3-none-any.whl
sniffio @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/2b/1b/93/9c34d727e29f7bb11ce5b2ca7f43e77cb4e96a81ee5e07a92763951416/sniffio-1.2.0-py3-none-any.whl
starlette @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/3d/fc/74/569a1206737284325f5bb2e4f34689632c159dafbe8b7ff30bf2893c2d/starlette-0.19.1-py3-none-any.whl
typing_extensions @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/4a/aa/fe/e4680f3423fbdb5ac89a6fb2f83d9e7ff7fb48173b0fa1604786182558/typing_extensions-4.3.0-py3-none-any.whl
urllib3 @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/8a/87/ce/4a44bf6bb59a745f4af7082c6977ab23a478fca039ad4d631dfdc0185b/urllib3-1.26.10-py2.py3-none-any.whl
uvicorn @ file:///Users/samzonglu/Library/Caches/pypoetry/artifacts/62/76/ec/dcafe6bae872839618dbf982c87eb314eee97784f7df74895e07bd198a/uvicorn-0.18.2-py3-none-any.whl
</code></pre></div></div>

<p>可以看到，默认情况下<code class="language-plaintext highlighter-rouge">pip freeze</code>在输出时，携带里对应的安装路径；如果这个时候，我们把项目移交给其他人运行时，会遇到以下问题</p>

<blockquote>
  <p>ERROR: Could not install packages due to an EnvironmentError: [Errno 2] No such</p>
</blockquote>

<p>这是 pip 安装软件包的一种特殊语法（自19.1开始受支持）<a href="https://www.python.org/dev/peps/pep-0440/#direct-references">PEP404</a>，
但是该此种路径取决于环境，file:///URL 仅在本地文件系统上可用，你不能将生成的 requirements.txt 文件提供给其他人使用</p>

<h3 id="先说解决方法-01-poetry-style">先说解决方法 01 [poetry style]</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>poetry <span class="nb">export</span> <span class="nt">--without-hashes</span> <span class="nt">--format</span><span class="o">=</span>requirements.txt <span class="o">&gt;</span> requirements.txt
</code></pre></div></div>

<p>通过 poetry 自带的导出能力，会携带更多的一些信息：对于环境中python版本的依赖，虽然更加友好一些。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">anyio</span><span class="o">==</span>3.6.1<span class="p">;</span> python_full_version <span class="o">&gt;=</span> <span class="s2">"3.6.2"</span>
<span class="nv">certifi</span><span class="o">==</span>2022.6.15<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.6"</span>
charset-normalizer<span class="o">==</span>2.1.0<span class="p">;</span> python_full_version <span class="o">&gt;=</span> <span class="s2">"3.6.0"</span>
<span class="nv">click</span><span class="o">==</span>8.1.3<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.7"</span>
<span class="nv">colorama</span><span class="o">==</span>0.4.5<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.7"</span> and python_full_version &lt; <span class="s2">"3.0.0"</span> and platform_system <span class="o">==</span> <span class="s2">"Windows"</span> or platform_system <span class="o">==</span> <span class="s2">"Windows"</span> and python_version <span class="o">&gt;=</span> <span class="s2">"3.7"</span> and python_full_version <span class="o">&gt;=</span> <span class="s2">"3.5.0"</span>
<span class="nv">fastapi</span><span class="o">==</span>0.78.0<span class="p">;</span> python_full_version <span class="o">&gt;=</span> <span class="s2">"3.6.1"</span>
<span class="nv">h11</span><span class="o">==</span>0.13.0<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.6"</span>
<span class="nv">idna</span><span class="o">==</span>3.3<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.5"</span>
<span class="nv">pydantic</span><span class="o">==</span>1.9.1<span class="p">;</span> python_full_version <span class="o">&gt;=</span> <span class="s2">"3.6.1"</span>
<span class="nv">requests</span><span class="o">==</span>2.28.1<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.7"</span> and python_version &lt; <span class="s2">"4"</span>
<span class="nv">sniffio</span><span class="o">==</span>1.2.0<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.5"</span>
<span class="nv">starlette</span><span class="o">==</span>0.19.1<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.6"</span>
typing-extensions<span class="o">==</span>4.3.0<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.7"</span>
<span class="nv">urllib3</span><span class="o">==</span>1.26.10<span class="p">;</span> <span class="o">(</span>python_version <span class="o">&gt;=</span> <span class="s2">"2.7"</span> and python_full_version &lt; <span class="s2">"3.0.0"</span><span class="o">)</span> or <span class="o">(</span>python_full_version <span class="o">&gt;=</span> <span class="s2">"3.6.0"</span> and python_version &lt; <span class="s2">"4"</span><span class="o">)</span>
<span class="nv">uvicorn</span><span class="o">==</span>0.18.2<span class="p">;</span> python_version <span class="o">&gt;=</span> <span class="s2">"3.7"</span>
</code></pre></div></div>

<h3 id="再说解决方法-02">再说解决方法 02</h3>

<p>在新版的 python 中，推荐采用另外一个命令方式，<code class="language-plaintext highlighter-rouge">pip list --format=freeze</code> 这样会输出一份干净的依赖清单，我们可以通过这个方式，快速导出一份 <code class="language-plaintext highlighter-rouge">原汁原味</code> 的 requirements.txt</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>poetry run pip list <span class="nt">--format</span><span class="o">=</span>freeze
<span class="nv">anyio</span><span class="o">==</span>3.6.1
<span class="nv">certifi</span><span class="o">==</span>2022.6.15
charset-normalizer<span class="o">==</span>2.1.0
<span class="nv">click</span><span class="o">==</span>8.1.3
<span class="nv">fastapi</span><span class="o">==</span>0.78.0
<span class="nv">h11</span><span class="o">==</span>0.13.0
<span class="nv">idna</span><span class="o">==</span>3.3
<span class="nv">pip</span><span class="o">==</span>22.2
<span class="nv">pydantic</span><span class="o">==</span>1.9.1
<span class="nv">requests</span><span class="o">==</span>2.28.1
<span class="nv">setuptools</span><span class="o">==</span>62.6.0
<span class="nv">sniffio</span><span class="o">==</span>1.2.0
<span class="nv">starlette</span><span class="o">==</span>0.19.1
<span class="nv">typing_extensions</span><span class="o">==</span>4.3.0
<span class="nv">urllib3</span><span class="o">==</span>1.26.10
<span class="nv">uvicorn</span><span class="o">==</span>0.18.2
<span class="nv">wheel</span><span class="o">==</span>0.37.1
</code></pre></div></div>

<h3 id="补充安装来自于requirementstxt的方式">补充安装来自于requirements.txt的方式</h3>

<blockquote>
  <p>with poetry</p>
</blockquote>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>requirements.txt | xargs poetry add
</code></pre></div></div>

<blockquote>
  <p>without poetry</p>
</blockquote>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2022-09-22</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Python">Python</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/09/K8s%E7%B3%BB%E5%88%97-%E5%8D%97%E5%8C%97%E6%B5%81%E9%87%8F%E5%92%8C%E4%B8%9C%E8%A5%BF%E6%B5%81%E9%87%8F.html">K8s系列 南北流量和东西流量</a></h1>
    <div class="post_at_index">
      <h2 id="南北流量和东西流量-是什么意思">南北流量和东西流量 是什么意思？</h2>

<p>在Service Mesh微服务架构中，我们常常会听到东西流量和南北流量两个术语。</p>

<p>南北流量（NORTH-SOUTH traffic）和东西流量（EAST-WEST traffic）是数据中心环境中的网络流量模式。下面我们通过一个例子来理解这两个术语。</p>

<p>假设我们尝试通过浏览器访问某些Web应用。Web应用部署在位于某个数据中心的应用服务器中。在多层体系结构中，典型的数据中心不仅包含应用服务器，还包含其他服务器，如负载均衡器、数据库等，以及路由器和交换机等网络组件。假设应用服务器是负载均衡器的前端。</p>

<p>当我们访问web应用时，会发生以下类型的网络流量：</p>

<p><img src="http://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com//uPic/f9c10a68e23f6955cc25c176d2ea98f7.png?x-oss-process=image/resize,w_960,m_lfit" alt="img" style="zoom:80%;" /></p>

<p>数据中心树型拓扑图是一个典型的包含接入层、汇聚层、核心层三层的网络结构。这种结构诞生之初就是为了将外部流量引流到内部应用。</p>

<p>流量从外部穿过防火墙或者数据中心其它外围网络设备进来，对应到上⾯这张图里，流动方向为从上到下，称为南向流量（和地图一样，上北下南），而与之对应的，数据中心内部产生的，离开数据中心的流量，从下到上故称为北向流量。合起来称为南北流量。</p>

<p>在微服务化流行之前，以巨石系统（monolithic）这种单体应用为单位部署的方式，产生的是典型的南北流量。一个单体应用配有一个专门的服务器（或虚拟机），一个外部请求通常在单体应用内独立完成，除了访问数据库等必须依赖服务之外，很少会发生横向的流量。</p>

<p>但云计算机、大数据、微服务、云原生等技术的发展催生了大量的从左到右以及从右到左的流量，也被称为东西流量。</p>

<p>数据中心内部南北流量的削弱，而东西流量的井喷在硬件上要求数据中心要横向扩展以提供更宽的大二层以及容纳更多的服务器，而在软件上则要求一种新的服务编排方式以便能充分挖掘、利用现有的计算能力，从这个角度看 K8s 的出现是一种必然。</p>

<p>举两个例子：</p>

<ul>
  <li>
    <p>客户端（位于数据中心一侧的浏览器）与负载均衡器（位于数据中心）之间的网络流量</p>
  </li>
  <li>
    <p>负载均衡器、应用服务器、数据库等之间的网络流量，它们都位于数据中心。</p>
  </li>
</ul>

<p>在这个例子中，前者即即客户端和服务器之间的流量被称为南北流量。简而言之，南北流量是server-client流量。</p>

<p>第二种流量即不同服务器之间的流量与数据中心或不同数据中心之间的网络流被称为东西流量。简而言之，东西流量是 service-service 流量。</p>

<p>当下，东西流量远超南北流量，尤其是在当今的大数据生态系统中，比如Hadoop生态系统（大量server驻留在数据中心中，用map reduce处理），server-server流量远大于server-client流量。</p>

<p>大家可能会好奇，东西南北，为什么这么命名 ？</p>

<p>该命名来自于绘制典型network diagrams的习惯。在图表中，通常核心网络组件绘制在顶部（NORTH），客户端绘制在底部（SOUTH），而数据中心内的不同服务器水平（EAST-WEST）</p>


      
    </div>
    <br/>
    <div>
      <cite>2022-09-12</cite> <i class="icon-tag"></i>
      <a href="/tags.html#K8s">K8s</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/07/jq-%E5%91%BD%E4%BB%A4%E8%A1%8C-Json-%E5%A4%84%E7%90%86%E7%A5%9E%E5%99%A8.html">jq 命令行 Json 处理神器</a></h1>
    <div class="post_at_index">
      <ul>
  <li>
    <p><a href="https://mozillazg.com/2018/01/jq-use-examples-cookbook.html">https://mozillazg.com/2018/01/jq-use-examples-cookbook.htm</a>-</p>
  </li>
  <li>
    <p>jq 命令日常练习 https://jqplay.org/s/KhRuUFCP2h</p>
  </li>
</ul>

<p>一个灵活的轻量级命令行JSON处理器</p>

<h2 id="说明">说明</h2>

<p>jq 是 stedolan 开发的一个轻量级的和灵活的命令行JSON处理器，源码请参考 <a href="https://github.com/stedolan/jq">jq 项目主页</a> 。jq 用于处理JSON输入，将给定过滤器应用于其JSON文本输入并在标准输出上将过滤器的结果生成为JSON；最简单的过滤器是<code class="language-plaintext highlighter-rouge">.</code>，它将jq的输入未经修改地复制到其输出中（格式设置除外）； 请注意，jq 当前仅支持64位双精度浮点数（IEEE754）。</p>

<h2 id="安装">安装</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Debian系，如 Ubuntu</span>
<span class="nb">sudo </span>apt-get <span class="nb">install </span>jq

<span class="c"># RedHat系, 如 CentOS</span>
yum <span class="nb">install </span>jq

<span class="c"># MacOS</span>
brew <span class="nb">install </span>jq
</code></pre></div></div>

<h2 id="语法">语法</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jq <span class="o">[</span>options] &lt;jq filter&gt; <span class="o">[</span>file...]
jq <span class="o">[</span>options] <span class="nt">--args</span> &lt;jq filter&gt; <span class="o">[</span>strings...]
jq <span class="o">[</span>options] <span class="nt">--jsonargs</span> &lt;jq filter&gt; <span class="o">[</span>JSON_TEXTS...]
</code></pre></div></div>

<h2 id="选项">选项</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-c</span>               紧凑而不是漂亮的输出<span class="p">;</span>
<span class="nt">-n</span>               使用<span class="sb">`</span>null<span class="sb">`</span>作为单个输入值<span class="p">;</span>
<span class="nt">-e</span>               根据输出设置退出状态代码<span class="p">;</span>
<span class="nt">-s</span>               将所有输入读取（吸取）到数组中；应用过滤器<span class="p">;</span>
<span class="nt">-r</span>               输出原始字符串，而不是JSON文本<span class="p">;</span>
<span class="nt">-R</span>               读取原始字符串，而不是JSON文本<span class="p">;</span>
<span class="nt">-C</span>               为JSON着色<span class="p">;</span>
<span class="nt">-M</span>               单色（不要为JSON着色）<span class="p">;</span>
<span class="nt">-S</span>               在输出上排序对象的键<span class="p">;</span>
<span class="nt">--tab</span>            使用制表符进行缩进<span class="p">;</span>
<span class="nt">--arg</span> a v        将变量<span class="nv">$a</span>设置为value&lt;v&gt;<span class="p">;</span>
<span class="nt">--argjson</span> a v    将变量<span class="nv">$a</span>设置为JSON value&lt;v&gt;<span class="p">;</span>
<span class="nt">--slurpfile</span> a f  将变量<span class="nv">$a</span>设置为从&lt;f&gt;读取的JSON文本数组<span class="p">;</span>
<span class="nt">--rawfile</span> a f    将变量<span class="nv">$a</span>设置为包含&lt;f&gt;内容的字符串<span class="p">;</span>
<span class="nt">--args</span>           其余参数是字符串参数，而不是文件<span class="p">;</span>
<span class="nt">--jsonargs</span>       其余的参数是JSON参数，而不是文件<span class="p">;</span>
<span class="nt">--</span>               终止参数处理<span class="p">;</span>
</code></pre></div></div>

<h2 id="例子">例子</h2>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">.</code>: 以漂亮的方式输出</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'{ "foo": { "bar": { "baz": 123 } } }'</span> | jq <span class="s1">'.'</span>
<span class="o">{</span>
  <span class="s2">"foo"</span>: <span class="o">{</span>
    <span class="s2">"bar"</span>: <span class="o">{</span>
      <span class="s2">"baz"</span>: 123
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">.foo, .foo.bar, .foo?</code>: 获取一个键的值</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'{"foo": 42, "bar": "less interesting data"}'</span> | jq <span class="s1">'.foo'</span>
42
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">.[], .[]?, .[2], .[10:15]</code>: 数组运算</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'[{"name":"JSON", "good":true}, {"name":"XML", "good":false}]'</span> | jq <span class="s1">'.[1]'</span>
<span class="o">{</span>
  <span class="s2">"name"</span>: <span class="s2">"XML"</span>,
  <span class="s2">"good"</span>: <span class="nb">false</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">[], {}</code>: 构造一个数组/对象</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'{"user":"stedolan","titles":["JQ Primer", "More JQ"]}'</span> | jq <span class="s1">'{user, title: .titles[]}'</span>
<span class="o">{</span>
  <span class="s2">"user"</span>: <span class="s2">"stedolan"</span>,
  <span class="s2">"title"</span>: <span class="s2">"JQ Primer"</span>
<span class="o">}</span>
<span class="o">{</span>
  <span class="s2">"user"</span>: <span class="s2">"stedolan"</span>,
  <span class="s2">"title"</span>: <span class="s2">"More JQ"</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">length</code>: 计算一个值的长度</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'[[1,2], "string", {"a":2}, null]'</span> | jq <span class="s1">'.[] | length'</span>                                  
2
6
1
0
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">keys</code>: 取出数组中的键</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'{"abc": 1, "abcd": 2, "Foo": 3}'</span> | jq <span class="s1">'keys'</span>                                        
<span class="o">[</span>
  <span class="s2">"Foo"</span>,
  <span class="s2">"abc"</span>,
  <span class="s2">"abcd"</span>
<span class="o">]</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">,</code>: 使用多个过滤器</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'{ "foo": 42, "bar": "something else", "baz": true}'</span> | jq <span class="s1">'.foo, .bar'</span> 
42
<span class="s2">"something else"</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">|</code>: 通过管道将一个过滤器的输出当做下一个过滤器的输入</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'[{"name":"JSON", "good":true}, {"name":"XML", "good":false}]'</span> | jq <span class="s1">'.[] | .name'</span>                                                 
<span class="s2">"JSON"</span>
<span class="s2">"XML"</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">select(foo)</code>: 如果foo返回true，则输入保持不变</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'[1,5,3,0,7]'</span> | jq <span class="s1">'map(select(. &gt;= 2))'</span>                                                    
<span class="o">[</span>
  5,
  3,
  7
<span class="o">]</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">map(foo)</code>: 每个输入调用过滤器</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'[1,2,3]'</span> | jq <span class="s1">'map(.+1)'</span>
<span class="o">[</span>
  2,
  3,
  4
<span class="o">]</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">if-then-else-end</code>: 条件判断</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'2'</span> | jq <span class="s1">'if . == 0 then "zero" elif . == 1 then "one" else "many" end'</span>
<span class="s2">"many"</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">\(foo)</code>: 在字符串中插入值并进行运算</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'42'</span> | jq <span class="s1">'"The input was \(.), which is one less than \(.+1)"'</span>          
<span class="s2">"The input was 42, which is one less than 43"</span>
</code></pre></div></div>


      
    </div>
    <br/>
    <div>
      <cite>2022-07-22</cite> <i class="icon-tag"></i>
      <a href="/tags.html#unix command">unix command</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/07/%E9%97%AD%E5%85%B3%E5%A4%87%E6%88%98-11%E6%9C%88.html">闭关备战 11月</a></h1>
    <div class="post_at_index">
      <h2 id="目标">目标</h2>

<p>获得软考中级证书，完成落户条件准备。</p>

<p>下一次考试时间是 11 月份，</p>

<p>开始闭关。</p>

      
    </div>
    <br/>
    <div>
      <cite>2022-07-17</cite> <i class="icon-tag"></i>
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2022/06/Mac%E4%B8%8A%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E7%9A%84%E6%96%B9%E5%BC%8F.html">Mac上安装软件的方式</a></h1>
    <div class="post_at_index">
      <h2 id="写在前面的话">写在前面的话</h2>

<p>如果你第一次看到这个文档，那么，欢迎加入Mac的大家庭！</p>

<p>接下来我会带领你来初始化的刚到手还热乎的Mac，如果能对你有些帮助，那最好不过了。</p>

<h2 id="简析mac软件与windows软件的区别">简析Mac软件与Windows软件的区别</h2>

<p>首先 软件名.exe 的软件是不能在Mac运行的，并且Mac软件与Windows的生态环境不同，所以你在安装软件的时候，注意下载对应Mac版本；好在由于苹果软件生态的优势，如果你安装了Mac版本，软件的UI体验和广告体验会比Windows好很多。</p>

<h3 id="软件付费概念">软件付费概念</h3>

<p>如果同我们从Android 手机转为iPhone时竟然发现软件还需要花钱买一样，苹果有着优质软件生态，是无数开发者和Apple共同运营的结果，所以尊重知识产权，合理付费，同时也可以体验到优质的产品和服务。</p>

<blockquote>
  <p>但是Apple 目前有些收费策略的确让人搞不懂，如果你可以通过能(tao)力(bao)的方式省钱，欢迎告诉我。</p>
</blockquote>

<h2 id="mac软件安装的三种方式">Mac软件安装的三种方式</h2>

<h4 id="1-app-store">1. App Store</h4>

<p>这是苹果的官方渠道，如同iPhone的App Store，可以在这边方便下载和更新你的软件。但是由于App Store的软件审核和发布流程的繁琐，Mac版相对iPhone版，软件少的可怜，不过一些主流应用还是都可以找到的，下面列出一些常用的软件。</p>

<ul>
  <li>微信 <a href="https://apps.apple.com/cn/app/wechat/id836500024?l=en&amp;mt=12">https://apps.apple.com/cn/app/wechat/id836500024?l=en&amp;mt=12</a></li>
  <li>钉钉 <a href="https://apps.apple.com/cn/app/dingtalk/id1435447041?l=en&amp;mt=12">https://apps.apple.com/cn/app/dingtalk/id1435447041?l=en&amp;mt=12</a></li>
  <li>Maipo <a href="https://apps.apple.com/cn/app/maipo-for-weibo/id789066512?l=en&amp;mt=12">https://apps.apple.com/cn/app/maipo-for-weibo/id789066512?l=en&amp;mt=12</a></li>
  <li>QQ  <a href="https://apps.apple.com/cn/app/qq/id451108668?l=en&amp;mt=12">https://apps.apple.com/cn/app/qq/id451108668?l=en&amp;mt=12</a></li>
  <li>WPS <a href="https://apps.apple.com/cn/app/wps-office/id1443749478?l=en&amp;mt=12">https://apps.apple.com/cn/app/wps-office/id1443749478?l=en&amp;mt=12</a></li>
</ul>

<h4 id="2-软件官方网站">2. 软件官方网站</h4>

<p>注意，在Mac上目前还没成熟的第三方软件仓库管理工具，例如某安全卫士和某管家都集成Windows 软件管理仓库。所以到你需要用到的软件官网下载是一个非常保险的方式。</p>

<ul>
  <li><a href="https://bearychat.com/downloads">https://bearychat.com/downloads</a>  倍洽 - 内部沟通IM</li>
  <li><a href="https://support.logi.com/hc/zh-cn/articles/360025297893">https://support.logi.com/hc/zh-cn/articles/360025297893</a>  logitech Mouse - 公司给的M336的鼠标</li>
  <li><a href="https://www.iterm2.com/">https://www.iterm2.com/</a>  iTerm 2 - 提到Mac自带终端的Terminal工具</li>
  <li><a href="https://filezilla-project.org/">https://filezilla-project.org/</a>  Filezilla - 免费的SFTP工具</li>
</ul>

<blockquote>
  <p>Mac 版本的软件后缀名一般为.dmg 或 .pkg，注意安装过程中可能需要输入密码</p>
</blockquote>

<h4 id="3-第三方mac软件收集网站导航">3. 第三方Mac软件收集网站导航</h4>

<p>不要相信一些华军软件园等，或者CSDN上下载，这里推荐一些专门做Mac Apps收集梳理的网站，注意这里会用到百度网盘或CT网盘，下载速度会有些慢，氪金可以解决问题。</p>

<p>下面分享一下 Mac应用网站：</p>

<ul>
  <li><a href="https://xclient.info/">https://xclient.info/</a>  精品MAC应用分享</li>
  <li><a href="https://www.macw.cn">https://www.macw.cn</a>  麦克坞</li>
  <li><a href="https://sspai.com/mall">https://sspai.com/mall</a>  少数派-正版软件商店 - 要钱的</li>
  <li><a href="https://www.waitsun.com/">https://www.waitsun.com/</a> 麦氪派 - 良心网站</li>
  <li><a href="https://www.ifunmac.com/">https://www.ifunmac.com/</a>  玩转苹果</li>
  <li><a href="https://macwk.com/">https://macwk.com/</a> MacWK</li>
</ul>

<blockquote>
  <p>注意，以上网站下载软件后解压时需要输入密码，对应网站会有提示或者Google Search</p>
</blockquote>

<h4 id="4-github-软件收集仓库">4. Github 软件收集仓库</h4>

<p>我竟然关注了一堆非开发相关的东西，真是奇特的知识。（GayHub 还有非常丰富的东西），这里就直接把Github上的仓库分享出来了，喜欢的老铁请自行Star、Watch、打赏(刚出的功能)。</p>

<ul>
  <li><a href="https://github.com/serhii-londar/open-source-mac-os-apps">https://github.com/serhii-londar/open-source-mac-os-apps</a>  open-source-mac-os-apps</li>
  <li><a href="https://github.com/hzlzh/Best-App">https://github.com/hzlzh/Best-App</a>  Best-App</li>
  <li><a href="https://github.com/catofmrlu/MacApps">https://github.com/catofmrlu/MacApps</a>  MacApps</li>
</ul>

<h4 id="5-homebrew--cask">5. Homebrew &amp; Cask</h4>

<p>到了重点部分了，Mac很大的一个特色是MacOS底层的Unix衍生版本，和当前主流服务器操作系统如Redhat、Debian等一样，有这个强大的命令行模式，所以Mac在拥有非常好的软件生态的同时，也支持方便使用一些命令的指令，对开发者来讲，上手是十分友好的。</p>

<h5 id="51-安装brew">5.1 安装brew</h5>

<p>直接将下面的命令放到终端中运行，稍等片刻即可安装完成</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/bin/ruby <span class="nt">-e</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/master/install<span class="si">)</span><span class="s2">"</span>
</code></pre></div></div>

<p>安装完成后，你可以非常方便的使用<code class="language-plaintext highlighter-rouge">brew</code> 进行软件的安装和管理</p>

<p>下面是一些安装软件的演示以及一些常用指令</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 安装wget</span>
→ brew <span class="nb">install </span>wget

<span class="c"># 查找mysql</span>
→ brew search mysql
<span class="o">==&gt;</span> Formulae
automysqlbackup             mysql-client                mysql-connector-c++         mysql-utilities             mysql@5.7
mysql ✔                     mysql-cluster               mysql-sandbox               mysql@5.5 ✔                 mysqltuner
mysql++                     mysql-connector-c           mysql-search-replace        mysql@5.6 ✔

<span class="c"># 安装mysql 5.7，使用@ 来指定版本，如果无多版本直接使用软件名称即可</span>
→ brew <span class="nb">install </span>mysql@5.7

<span class="c"># 更新一个软件</span>
→ brew upgrade wget
</code></pre></div></div>

<h5 id="52-安装cask-用于安装mac图形化软件">5.2 安装Cask 用于安装Mac图形化软件</h5>

<p>有Homebrew 出现之后，丰富了Mac进行命令行工具和服务端应用的安装，但一直缺少图形化软件这一块，所以有其他开发者开发了附件的Brew-Cask插件，使得Homebrew拥有了安装图形化的能力，而作为使用者，我们只需要运行以下命令加载对应Caskroom的源即可。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew tap caskroom/cask
</code></pre></div></div>

<p>成功加载源之后，我们就可以方便的安装软件啦，因为Cask都是通过去官方的软件仓库下载和安装，所以大家在使用时大可放心，下面直接用命令展示下，经常会用到的命令。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 安装google-chrome</span>
→ brew cask <span class="nb">install </span>google-chrome   <span class="c"># 我们只需在安装时加上 cask就行</span>

<span class="c"># 查找eclipse</span>
→ brew search eclipse
<span class="o">==&gt;</span> Casks
eclipse-cpp                 eclipse-installer           eclipse-jee                 eclipse-platform            eclipse-scout
eclipse-dsl                 eclipse-java                eclipse-modeling            eclipse-ptp                 eclipse-testing
eclipse-ide                 eclipse-javascript          eclipse-php                 eclipse-rcp                 nodeclipse

<span class="c"># 查找mysql </span>
→ brew search mysql
<span class="o">==&gt;</span> Formulae  （CLI）
automysqlbackup             mysql-client                mysql-connector-c++         mysql-utilities             mysql@5.7
mysql ✔                     mysql-cluster               mysql-sandbox               mysql@5.5 ✔                 mysqltuner
mysql++                     mysql-connector-c           mysql-search-replace        mysql@5.6 ✔

<span class="o">==&gt;</span> Casks        （图形化）
mysql-connector-python                         mysql-utilities                                navicat-for-mysql
mysql-shell                                    mysqlworkbench                                 sqlpro-for-mysql

<span class="c"># 更新软件 </span>
→ brew cask upgrade google-chrome
</code></pre></div></div>

<h2 id="结束语">结束语</h2>

<p>好了，以上简单进行了Mac上安装软件的几个方法介绍，希望可以帮助到大家，也是为了自己做笔记。</p>

      
    </div>
    <br/>
    <div>
      <cite>2022-06-29</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Mac">Mac</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    

    <!-- Pagination links -->
    <nav>
      <ul class="pagination hidden-xs">
        
        
        <li>
          <a href="/">&laquo; Previous</a>
        </li>
        
        

        
        <li>
          <a href="/">1</a>
        </li>
        

        
          
            
              
                <li class="active"><a>2</a></li>
                
            
              
                <li><a href="/page3">3</a></li>
              
            
              
                <li><a href="/page4">4</a></li>
              
            
              
                <li><a href="/page5">5</a></li>
              
            
          
          <li class="disabled"><span>...</span></li>
          <li><a href="/page21">21</a></li>
        

        
        

        
        <li>
          <a href="/page3">Next &raquo;</a>
        </li>
        
      </ul>
    </nav>
  </div>
  <div class="col-xs-12 col-md-4">
		<!-- <div>
			<a class="twitter-timeline" data-width="390" data-height="640" data-theme="light" href="https://twitter.com/samzong_lu?ref_src=twsrc%5Etfw">Tweets by SAMZONG</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
		</div> -->
    <div>
      <h2>传送门</h2>
      <ul>
        <li><a href="https://yuque.com/samzong">语雀-花园</a></li>
        <li><a href="https://github.com/samzong">Github</a></li>
      </ul>
    </div>
    <div class="categories">
      <h2>文章分类</h2>
      <ul class="tag_box">
        
        


  
     
    	
      <li><a href="/categories.html#Linux">
    		Linux <span>21</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#CentOS">
    		CentOS <span>14</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Tools">
    		Tools <span>4</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#VPN">
    		VPN <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#HTML">
    		HTML <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#数据库">
    		数据库 <span>19</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#MySQL">
    		MySQL <span>15</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Git">
    		Git <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#TortoiseGit">
    		TortoiseGit <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#MongoDB">
    		MongoDB <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#PHP">
    		PHP <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Mac">
    		Mac <span>17</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#SourceTree">
    		SourceTree <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#OpenSource">
    		OpenSource <span>11</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Piwik">
    		Piwik <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Python">
    		Python <span>45</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#云服务">
    		云服务 <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Azure">
    		Azure <span>4</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#虚拟化">
    		虚拟化 <span>7</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#OpenStack">
    		OpenStack <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#CloudStack">
    		CloudStack <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Zabbix">
    		Zabbix <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Tomcat">
    		Tomcat <span>5</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Redis">
    		Redis <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Docker">
    		Docker <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Shell">
    		Shell <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Blog">
    		Blog <span>4</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Ghost">
    		Ghost <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#PostgreSQL">
    		PostgreSQL <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#AWS">
    		AWS <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Aliyun">
    		Aliyun <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Redmine">
    		Redmine <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Bigdata">
    		Bigdata <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Windows">
    		Windows <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Jmeter">
    		Jmeter <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#随笔">
    		随笔 <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#SQL">
    		SQL <span>5</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Node">
    		Node <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#BI">
    		BI <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#NaN">
    		NaN <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#微服务">
    		微服务 <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#ClickHouse">
    		ClickHouse <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#闲聊">
    		闲聊 <span>3</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Hexo">
    		Hexo <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Javascript">
    		Javascript <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Telegram">
    		Telegram <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Metabase">
    		Metabase <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#学习">
    		学习 <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Github">
    		Github <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Gitlab">
    		Gitlab <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#云原生">
    		云原生 <span>1</span>
    	</a></li>
    
  



      </ul>
    </div>
    <div>
      <h2>最近文章</h2>
      <ul>
        
        <li>
          <a href="/post/2022/11/%E9%80%9A%E8%BF%87pipreqs%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%BE%9D%E8%B5%96%E5%BA%93.html">通过pipreqs获取当前项目的依赖库</a>
          如果在开始开发一个项目时，未注意项目的依赖库隔离；可能会导致后续给项目打包时：


        </li>
        
        <li>
          <a href="/post/2022/11/python3-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86-strip()-split().html">python3 文本处理 strip() split()</a>
          
  strip() 删除字符串中的内容，删除后仍旧是str
  split() 分割字符串，根据特定的标识，分割后=list



        </li>
        
        <li>
          <a href="/post/2022/11/python3-str-%E5%8E%BB%E9%99%A4%E7%89%B9%E5%AE%9A%E5%86%85%E5%AE%B9.html">python3 str 去除特定内容</a>
          ```python
import string


        </li>
        
        <li>
          <a href="/post/2022/11/python3-setup.py-help-commands.html">python3 setup.py --help-commands</a>
          ```python
→ python3 setup.py –help-commands


        </li>
        
        <li>
          <a href="/post/2022/11/python-xlsxwriter-%E5%86%99%E5%85%A5excel.html">python xlsxwriter 写入excel</a>
          以下是使用的方法：


        </li>
        
      </ul>
    </div>
  </div>
</div>

			</div>

		</div>

    <footer>
      <div class="container">
        <div class="row mobilepadding">
          			<hr>
      &copy; 2022 船长. Powered by <a href="http://jekyllrb.com" target="_blank" title="The simple, blog-aware, static site generator.">Jekyll</a>. Theme Creator <a href="https://github.com/einverne" target="_blank" title="Ein Verne's GitHub Repos">Ein Verne</a> . Host on <a href="https://github.com/samzong/samzong.me" target="_blank" title="Samzong's GitHub Repos">Github</a> .
      <br><br>
      </div>
    </div>
    </footer>

    




	<script async type="text/javascript" src="/assets/themes/evjekylltheme/bootstrap-3.3.5/js/bootstrap.min.js"></script>
	<script async type="text/javascript" src="/assets/themes/evjekylltheme/webcore.js"></script>

 </body>
</html>

