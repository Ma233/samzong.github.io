<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Samzong | SAMZONG</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://samzong.me/page/202"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Samzong | SAMZONG"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://samzong.me/page/202"><link data-rh="true" rel="alternate" href="https://samzong.me/page/202" hreflang="en"><link data-rh="true" rel="alternate" href="https://samzong.me/page/202" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="SAMZONG RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="SAMZONG Atom Feed"><link rel="stylesheet" href="/assets/css/styles.44c5c7e5.css">
<link rel="preload" href="/assets/js/runtime~main.fd979fbe.js" as="script">
<link rel="preload" href="/assets/js/main.95d69143.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2022/05/03/tao-bao-python-sdk-you-hua-zhi-chi-python3">淘宝 Python SDK 优化支持 Python3</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-05-03T00:00:00.000Z" itemprop="datePublished">May 3, 2022</time> · <!-- -->3 min read</div></header><div class="markdown" itemprop="articleBody"><p>淘宝开放平台的 SDK，Python 的 SDK 是在 2012 年，仅支持 Python2.7 及以上，但不支持 Python3；二现在是 2102 年了，像我这样的新手都是直接从 Python3 开始的，</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-python3-int-替代了-long">1. Python3 int 替代了 long<a href="#1-python3-int-替代了-long" class="hash-link" aria-label="Direct link to 1. Python3 int 替代了 long" title="Direct link to 1. Python3 int 替代了 long">​</a></h4><p><code>P_TIMESTAMP: str(int(time.time() * 1000))</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-用-items-替代-iteritems">2. 用 items 替代 iteritems<a href="#2-用-items-替代-iteritems" class="hash-link" aria-label="Direct link to 2. 用 items 替代 iteritems" title="Direct link to 2. 用 items 替代 iteritems">​</a></h4><p><code>for key, value in application_parameter.items():</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-查阅资料发现有人说到-dict-methods-dictkeys-dictitems-and-dictvalues-returnviewsinstead-of-lists这样就显而易见知道怎么改了">3. 查阅资料，发现有人说到 dict methods dict.keys(), dict.items() and dict.values() return“views”instead of lists.这样就显而易见知道怎么改了<a href="#3-查阅资料发现有人说到-dict-methods-dictkeys-dictitems-and-dictvalues-returnviewsinstead-of-lists这样就显而易见知道怎么改了" class="hash-link" aria-label="Direct link to 3. 查阅资料，发现有人说到 dict methods dict.keys(), dict.items() and dict.values() return“views”instead of lists.这样就显而易见知道怎么改了" title="Direct link to 3. 查阅资料，发现有人说到 dict methods dict.keys(), dict.items() and dict.values() return“views”instead of lists.这样就显而易见知道怎么改了">​</a></h4><p><code>keys = sorted(keys)</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-英文意思很明确unicode-对象在哈希之前必须进行编码转换想起之前又看到过中文字符在-python-中是以-unicode-存在的所以">4. 英文意思很明确，unicode 对象在哈希之前必须进行编码转换，想起之前又看到过中文字符在 python 中是以 unicode 存在的，所以<a href="#4-英文意思很明确unicode-对象在哈希之前必须进行编码转换想起之前又看到过中文字符在-python-中是以-unicode-存在的所以" class="hash-link" aria-label="Direct link to 4. 英文意思很明确，unicode 对象在哈希之前必须进行编码转换，想起之前又看到过中文字符在 python 中是以 unicode 存在的，所以" title="Direct link to 4. 英文意思很明确，unicode 对象在哈希之前必须进行编码转换，想起之前又看到过中文字符在 python 中是以 unicode 存在的，所以">​</a></h4><p><code>sign = hashlib.md5(parameters.encode(&quot;utf-8&quot;)).hexdigest().upper()</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-这是花费时间最长的一个错误首先直接看最后错误在-soketpy-里心凉了半截难道这里的调用都不一样了再网上看又是-python-3x-的-http-模块去百度了半天也没有发现类似的错误只能自己硬着头皮去看模块功夫不负有心人其实也很简单在类-httpconnection-的初始化函数是这样定义的">5. 这是花费时间最长的一个错误。首先，直接看最后，错误在 soket.py 里，心凉了半截，难道这里的调用都不一样了，再网上看又是 python 3.X 的 http 模块，去百度了半天也没有发现类似的错误，只能自己硬着头皮去看模块，功夫不负有心人，其实也很简单，在类 HTTPConnection 的初始化函数是这样定义的<a href="#5-这是花费时间最长的一个错误首先直接看最后错误在-soketpy-里心凉了半截难道这里的调用都不一样了再网上看又是-python-3x-的-http-模块去百度了半天也没有发现类似的错误只能自己硬着头皮去看模块功夫不负有心人其实也很简单在类-httpconnection-的初始化函数是这样定义的" class="hash-link" aria-label="Direct link to 5. 这是花费时间最长的一个错误。首先，直接看最后，错误在 soket.py 里，心凉了半截，难道这里的调用都不一样了，再网上看又是 python 3.X 的 http 模块，去百度了半天也没有发现类似的错误，只能自己硬着头皮去看模块，功夫不负有心人，其实也很简单，在类 HTTPConnection 的初始化函数是这样定义的" title="Direct link to 5. 这是花费时间最长的一个错误。首先，直接看最后，错误在 soket.py 里，心凉了半截，难道这里的调用都不一样了，再网上看又是 python 3.X 的 http 模块，去百度了半天也没有发现类似的错误，只能自己硬着头皮去看模块，功夫不负有心人，其实也很简单，在类 HTTPConnection 的初始化函数是这样定义的">​</a></h4><p><code>connection = httplib.HTTPConnection(self.__domain, self.__port, timeout)</code></p><blockquote><p>比较下参数发现，python 2 比 3 多了一个参数，去掉即可，这个错误主要是是报错的地方和修改的地方不在一起，所以很难插出原因。</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-官方文档是这样解释的urllib-has-been-split-up-in-python-3-the-urlliburlencode-function-is-now-urllibparseurlencode-and-the-urlliburlopen-function-is-now-urllibrequesturlopen">6. 官方文档是这样解释的：urllib has been split up in Python 3. The urllib.urlencode() function is now urllib.parse.urlencode(), and the urllib.urlopen() function is now urllib.request.urlopen()<a href="#6-官方文档是这样解释的urllib-has-been-split-up-in-python-3-the-urlliburlencode-function-is-now-urllibparseurlencode-and-the-urlliburlopen-function-is-now-urllibrequesturlopen" class="hash-link" aria-label="Direct link to 6. 官方文档是这样解释的：urllib has been split up in Python 3. The urllib.urlencode() function is now urllib.parse.urlencode(), and the urllib.urlopen() function is now urllib.request.urlopen()" title="Direct link to 6. 官方文档是这样解释的：urllib has been split up in Python 3. The urllib.urlencode() function is now urllib.parse.urlencode(), and the urllib.urlopen() function is now urllib.request.urlopen()">​</a></h4><p><code>url = N_REST + &quot;?&quot; + urllib.parse.urlencode(sys_parameters)</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="7-这个错误是在-api-调用出异常的时候暴露出来的原因前面已经提到了稍微查了下替代的方法">7. 这个错误是在 API 调用出异常的时候暴露出来的。原因前面已经提到了，稍微查了下替代的方法<a href="#7-这个错误是在-api-调用出异常的时候暴露出来的原因前面已经提到了稍微查了下替代的方法" class="hash-link" aria-label="Direct link to 7. 这个错误是在 API 调用出异常的时候暴露出来的。原因前面已经提到了，稍微查了下替代的方法" title="Direct link to 7. 这个错误是在 API 调用出异常的时候暴露出来的。原因前面已经提到了，稍微查了下替代的方法">​</a></h4><p><code>if &quot;error_response&quot; in jsonobj:</code></p><p><code>if P_CODE in jsonobj[&quot;error_response&quot;]:</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8-在-if-需要使用反向时应该是--而不是使用-is-not这个也是-pycharm-给的建议所以在使用时所以简单调整下就好了">8. 在 if 需要使用反向时，应该是 != ，而不是使用  is not；这个也是 PyCharm 给的建议，所以在使用时，所以简单调整下就好了<a href="#8-在-if-需要使用反向时应该是--而不是使用-is-not这个也是-pycharm-给的建议所以在使用时所以简单调整下就好了" class="hash-link" aria-label="Direct link to 8. 在 if 需要使用反向时，应该是 != ，而不是使用  is not；这个也是 PyCharm 给的建议，所以在使用时，所以简单调整下就好了" title="Direct link to 8. 在 if 需要使用反向时，应该是 != ，而不是使用  is not；这个也是 PyCharm 给的建议，所以在使用时，所以简单调整下就好了">​</a></h4><p><code>if response.status != 200:</code></p><p>以上调整之后，基本就可以正常跑起来了，基本是可以支持 Python3 的使用，我试过了 Python3.6-3.9，都是 OK 的。</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/python">Python</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/page/201"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/page/203"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div></div>
<script src="/assets/js/runtime~main.fd979fbe.js"></script>
<script src="/assets/js/main.95d69143.js"></script>
</body>
</html>