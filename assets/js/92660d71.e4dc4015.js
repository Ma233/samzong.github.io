"use strict";(self.webpackChunksamzong_me=self.webpackChunksamzong_me||[]).push([[26680],{10108:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>t,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>d,toc:()=>c});var r=l(17624),i=l(4552);const o={title:"HowTo Install Redmine",tags:["Tools"],date:new Date("2017-02-22T12:30:36.000Z")},s=void 0,d={permalink:"/2017/02/22/HowTo-Install-Redmine",source:"@site/blog/2017-02-22-HowTo-Install-Redmine.md",title:"HowTo Install Redmine",description:"Runtime environment",date:"2017-02-22T12:30:36.000Z",formattedDate:"February 22, 2017",tags:[{label:"Tools",permalink:"/tags/tools"}],readingTime:3.715,hasTruncateMarker:!1,authors:[],frontMatter:{title:"HowTo Install Redmine",tags:["Tools"],date:"2017-02-22T12:30:36.000Z"},unlisted:!1,prevItem:{title:"HowTo Upgrade Your Ghost Version",permalink:"/2017/02/20/HowTo-Upgrade-Your-Ghost-Version"},nextItem:{title:"HowTo Install NextCloud",permalink:"/2017/02/27/HowTo-Install-NextCloud"}},t={authorsImageUrls:[]},c=[{value:"Runtime environment",id:"runtime-environment",level:4},{value:"\u5b89\u88c5 rvm",id:"\u5b89\u88c5-rvm",level:4},{value:"\u5bfc\u5165\u516c\u94a5",id:"\u5bfc\u5165\u516c\u94a5",level:5},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:5},{value:"\u52a0\u8f7d rvm \u73af\u5883\u5e76\u5b89\u88c5\u57fa\u7840\u4f9d\u8d56\u5305",id:"\u52a0\u8f7d-rvm-\u73af\u5883\u5e76\u5b89\u88c5\u57fa\u7840\u4f9d\u8d56\u5305",level:5},{value:"\u5b89\u88c5 ruby",id:"\u5b89\u88c5-ruby",level:4},{value:"\u5b89\u88c5 rails",id:"\u5b89\u88c5-rails",level:4},{value:"\u66f4\u6362 gem \u6e90",id:"\u66f4\u6362-gem-\u6e90",level:5},{value:"\u5b89\u88c5",id:"\u5b89\u88c5-1",level:5},{value:"\u5b89\u88c5 MySQL",id:"\u5b89\u88c5-mysql",level:4},{value:"\u5b89\u88c5 redmine",id:"\u5b89\u88c5-redmine",level:4},{value:"\u4e0b\u8f7d Redmine 3.3.2",id:"\u4e0b\u8f7d-redmine-332",level:5},{value:"\u5b89\u88c5\u7ba1\u7406 ruby \u7684\u5305\u7ba1\u7406\u5de5\u5177 bundler",id:"\u5b89\u88c5\u7ba1\u7406-ruby-\u7684\u5305\u7ba1\u7406\u5de5\u5177-bundler",level:5},{value:"\u5b89\u88c5 redmine \u8fd0\u884c\u6240\u9700\u8981\u7684\u4f9d\u8d56\u5305",id:"\u5b89\u88c5-redmine-\u8fd0\u884c\u6240\u9700\u8981\u7684\u4f9d\u8d56\u5305",level:5},{value:"\u4e3a rails \u751f\u4ea7 cookies \u79d8\u94a5",id:"\u4e3a-rails-\u751f\u4ea7-cookies-\u79d8\u94a5",level:5},{value:"\u521b\u5efa redmine \u7684\u6570\u636e\u5e93",id:"\u521b\u5efa-redmine-\u7684\u6570\u636e\u5e93",level:5},{value:"\u4fee\u6539 redmine \u7684 database.yml",id:"\u4fee\u6539-redmine-\u7684-databaseyml",level:5},{value:"\u521b\u5efa\u6570\u636e\u5e93\u7ed3\u6784",id:"\u521b\u5efa\u6570\u636e\u5e93\u7ed3\u6784",level:5},{value:"\u751f\u4ea7\u7f3a\u7701\u6570\u636e",id:"\u751f\u4ea7\u7f3a\u7701\u6570\u636e",level:5},{value:"\u6d4b\u8bd5\u662f\u5426\u5b89\u88c5\u6210\u529f",id:"\u6d4b\u8bd5\u662f\u5426\u5b89\u88c5\u6210\u529f",level:5},{value:"\u914d\u7f6e Redmine \u5728 Nginx \u4e0a\u8fd0\u884c",id:"\u914d\u7f6e-redmine-\u5728-nginx-\u4e0a\u8fd0\u884c",level:4},{value:"\u91c7\u7528 Passenger \u63d0\u4f9b\u811a\u672c\u5b89\u88c5",id:"\u91c7\u7528-passenger-\u63d0\u4f9b\u811a\u672c\u5b89\u88c5",level:5},{value:"\u91c7\u7528\u91cd\u65b0\u7f16\u8bd1 Nginx \u589e\u52a0 Passenger \u6a21\u5757",id:"\u91c7\u7528\u91cd\u65b0\u7f16\u8bd1-nginx-\u589e\u52a0-passenger-\u6a21\u5757",level:5},{value:"\u589e\u52a0 HTTP \u6a21\u5757\u5185\u4ee5\u4e0b\u914d\u7f6e",id:"\u589e\u52a0-http-\u6a21\u5757\u5185\u4ee5\u4e0b\u914d\u7f6e",level:5},{value:"\u914d\u7f6e nginx.conf \u4fee\u6539 server \u6a21\u5757\u4e2d location \u7684\u914d\u7f6e",id:"\u914d\u7f6e-nginxconf-\u4fee\u6539-server-\u6a21\u5757\u4e2d-location-\u7684\u914d\u7f6e",level:5},{value:"\u542f\u52a8 Nginx",id:"\u542f\u52a8-nginx",level:5},{value:"\u5176\u4ed6",id:"\u5176\u4ed6",level:4},{value:"7.1 Could not find gem &#39;mysql2 (~&gt; 0.3.11)&#39; in any of the gem sources listed in your Gemfile",id:"71-could-not-find-gem-mysql2--0311-in-any-of-the-gem-sources-listed-in-your-gemfile",level:5},{value:"7.2 curl-tools",id:"72-curl-tools",level:5}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h4:"h4",h5:"h5",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h4,{id:"runtime-environment",children:"Runtime environment"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"CentOS 6.x"}),"\n",(0,r.jsx)(n.li,{children:"Redmine 3.3.2"}),"\n",(0,r.jsx)(n.li,{children:"Ruby 2.2.6"}),"\n",(0,r.jsx)(n.li,{children:"rails 4.2"}),"\n",(0,r.jsx)(n.li,{children:"MySQL 5.1"}),"\n",(0,r.jsx)(n.li,{children:"Nginx 1.10"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u5b89\u88c5-rvm",children:"\u5b89\u88c5 rvm"}),"\n",(0,r.jsx)(n.h5,{id:"\u5bfc\u5165\u516c\u94a5",children:"\u5bfc\u5165\u516c\u94a5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# curl -sSL https://rvm.io/mpapis.asc | gpg --import\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# curl -L https://get.rvm.io | bash -s stable\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u52a0\u8f7d-rvm-\u73af\u5883\u5e76\u5b89\u88c5\u57fa\u7840\u4f9d\u8d56\u5305",children:"\u52a0\u8f7d rvm \u73af\u5883\u5e76\u5b89\u88c5\u57fa\u7840\u4f9d\u8d56\u5305"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# source /etc/profile.d/rvm.sh\n[root@localhost ~]# rvm requirements\n"})}),"\n",(0,r.jsx)(n.h4,{id:"\u5b89\u88c5-ruby",children:"\u5b89\u88c5 ruby"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# rvm install 2.2.6\n...\n[root@localhost ~]# rvm use 2.2.6 --default\n"})}),"\n",(0,r.jsx)(n.h4,{id:"\u5b89\u88c5-rails",children:"\u5b89\u88c5 rails"}),"\n",(0,r.jsx)(n.h5,{id:"\u66f4\u6362-gem-\u6e90",children:"\u66f4\u6362 gem \u6e90"}),"\n",(0,r.jsxs)(n.p,{children:["\u9ed8\u8ba4 gem \u7684\u6e90\u7ad9\u70b9\u662f",(0,r.jsx)(n.a,{href:"https://rubygems.org",children:"https://rubygems.org"})," \u7531\u4e8e\u56fd\u5185\u7684\u7f51\u7edc\u539f\u56e0\u5bfc\u81f4\u65e0\u6cd5\u8fde\u63a5\uff0c\u6240\u4ee5\u5bfc\u81f4\u65e0\u6cd5\u4f7f\u7528 gem \u5b89\u88c5\uff0c\u8fd9\u91cc\u6362\u6210\u56fd\u5185\u6dd8\u5b9d\u7684 gem \u955c\u50cf\u7ad9\u70b9"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# gem sources -l\n*** CURRENT SOURCES ***\n\nhttps://rubygems.org/\n[root@localhost ~]# gem sources --remove https://rubygems.org/\n[root@localhost ~]# gem sources -a https://ruby.taobao.org/\n[root@localhost ~]# gem sources -l\n*** CURRENT SOURCES ***\n\nhttps://ruby.taobao.org/\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u5b89\u88c5-1",children:"\u5b89\u88c5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# gem install rails -v=4.2\n"})}),"\n",(0,r.jsx)(n.h4,{id:"\u5b89\u88c5-mysql",children:"\u5b89\u88c5 MySQL"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# yum install -y mysql-server mysql-libs mysql-devel mysql\n[root@localhost ~]# service mysqld start\n[root@localhost ~]# mysql_secure_installation\n"})}),"\n",(0,r.jsx)(n.h4,{id:"\u5b89\u88c5-redmine",children:"\u5b89\u88c5 redmine"}),"\n",(0,r.jsx)(n.h5,{id:"\u4e0b\u8f7d-redmine-332",children:"\u4e0b\u8f7d Redmine 3.3.2"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# wget http://www.redmine.org/releases/redmine-3.3.2.tar.gz\n[root@localhost ~]# tar xf redmine-3.3.2.tar.gz\n[root@localhost ~]# mv redmine-3.3.2 /opt\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u5b89\u88c5\u7ba1\u7406-ruby-\u7684\u5305\u7ba1\u7406\u5de5\u5177-bundler",children:"\u5b89\u88c5\u7ba1\u7406 ruby \u7684\u5305\u7ba1\u7406\u5de5\u5177 bundler"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# \u6ce8\u610f\uff0c\u4e00\u5b9a\u8981\u5728redmine\u76ee\u5f55\u4e0b\u64cd\u4f5c\n[root@localhost ~]# cd /opt/redmine-3.3.2\n[root@localhost redmine-3.3.2]# gem install bundler\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u5b89\u88c5-redmine-\u8fd0\u884c\u6240\u9700\u8981\u7684\u4f9d\u8d56\u5305",children:"\u5b89\u88c5 redmine \u8fd0\u884c\u6240\u9700\u8981\u7684\u4f9d\u8d56\u5305"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost redmine-3.3.2]# bundle install --without development test rmagick\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u4e3a-rails-\u751f\u4ea7-cookies-\u79d8\u94a5",children:"\u4e3a rails \u751f\u4ea7 cookies \u79d8\u94a5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost redmine-3.3.2]# rake generate_secret_token\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u521b\u5efa-redmine-\u7684\u6570\u636e\u5e93",children:"\u521b\u5efa redmine \u7684\u6570\u636e\u5e93"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"mysql> create database redmine character set utf8;\nmysql> grant all privileges on redmine.* to 'redmine'@'localhost' identified by 'redmine_pass';\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u4fee\u6539-redmine-\u7684-databaseyml",children:"\u4fee\u6539 redmine \u7684 database.yml"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[root@localhost redmine-3.3.2]# cp config/database.yml.example config/database.yml\n[root@localhost redmine-3.3.2]# vim config/database.yml\nproduction:\n  adapter: mysql2\n  database: redmine\n  host: localhost\n  username: redmine\n  password: "redmine_pass"\n  encoding: utf8\n'})}),"\n",(0,r.jsx)(n.h5,{id:"\u521b\u5efa\u6570\u636e\u5e93\u7ed3\u6784",children:"\u521b\u5efa\u6570\u636e\u5e93\u7ed3\u6784"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake db:migrate\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u751f\u4ea7\u7f3a\u7701\u6570\u636e",children:"\u751f\u4ea7\u7f3a\u7701\u6570\u636e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost redmine-3.3.2]# RAILS_ENV=production bundle exec rake redmine:load_default_data\n# \u9009\u62e9\u9ed8\u8ba4\u8bed\u8a00\uff0c\u4e4b\u540e\u53ef\u66f4\u6539\uff0c\u521d\u59cb\u4e3aen\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u6d4b\u8bd5\u662f\u5426\u5b89\u88c5\u6210\u529f",children:"\u6d4b\u8bd5\u662f\u5426\u5b89\u88c5\u6210\u529f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost redmine-3.3.2]# bundle exec rails server webrick -e production -b 0.0.0.0\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u9ed8\u8ba4\u8fd0\u884c 3000 \u7aef\u53e3\uff0c\u9ed8\u8ba4\u7ba1\u7406\u5458 admin/admin"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u914d\u7f6e-redmine-\u5728-nginx-\u4e0a\u8fd0\u884c",children:"\u914d\u7f6e Redmine \u5728 Nginx \u4e0a\u8fd0\u884c"}),"\n",(0,r.jsx)(n.p,{children:"Redmine \u5e38\u7528\u7684\u89e3\u51b3\u529e\u6cd5\u662f\u4f7f\u7528 passenger+nginx\uff0c\u4f46\u662f Nginx \u4e0d\u652f\u6301\u88c5\u8f7d\u6a21\u5757\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u5b89\u88c5 Nginx\uff0c\u5b89\u88c5 Nginx \u7684 Passenger \u6709\u4e24\u79cd\u65b9\u5f0f"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u91c7\u7528 Passenger \u63d0\u4f9b\u7684\u811a\u672c\u8fdb\u884c\u5b89\u88c5\uff0c\u9002\u5408\u65b0\u73af\u5883"}),"\n",(0,r.jsx)(n.li,{children:"\u624b\u52a8\u7f16\u8bd1\u5b89\u88c5 Nginx \u589e\u52a0 Passenger \u6a21\u5757\uff0c\u9002\u5408\u5df2\u5b58\u5728 Nginx \u73af\u5883"}),"\n"]}),"\n",(0,r.jsx)(n.h5,{id:"\u91c7\u7528-passenger-\u63d0\u4f9b\u811a\u672c\u5b89\u88c5",children:"\u91c7\u7528 Passenger \u63d0\u4f9b\u811a\u672c\u5b89\u88c5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost redmine-3.3.2]# gem install passenger\n[root@localhost redmine-3.3.2]# passenger-install-nginx-module --auto --prefix=/opt/nginx\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u91c7\u7528\u91cd\u65b0\u7f16\u8bd1-nginx-\u589e\u52a0-passenger-\u6a21\u5757",children:"\u91c7\u7528\u91cd\u65b0\u7f16\u8bd1 Nginx \u589e\u52a0 Passenger \u6a21\u5757"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# \u83b7\u53d6passenger\u7684\u5b89\u88c5\u8def\u5f84\n[root@localhost ~]# passenger-config --root\n/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n\n# \u91cd\u65b0\u7f16\u8bd1Nginx\u5e76\u6dfb\u52a0\u6a21\u5757\n[root@localhost ~]# wget http://nginx.org/download/nginx-1.10.3.tar.gz\n[root@localhost ~]# tar xf nginx-1.10.3.tar.gz\n[root@localhost ~]# cd nginx-1.10.3\n[root@localhost nginx-1.10.3]# ./configure ... -add-module=/usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u589e\u52a0-http-\u6a21\u5757\u5185\u4ee5\u4e0b\u914d\u7f6e",children:"\u589e\u52a0 HTTP \u6a21\u5757\u5185\u4ee5\u4e0b\u914d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"passenger_root /usr/local/rvm/gems/ruby-2.2.6/gems/passenger-5.1.2\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u914d\u7f6e-nginxconf-\u4fee\u6539-server-\u6a21\u5757\u4e2d-location-\u7684\u914d\u7f6e",children:"\u914d\u7f6e nginx.conf \u4fee\u6539 server \u6a21\u5757\u4e2d location \u7684\u914d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# ...\nserver {\n  # ...\n  passenger_enabled on;\n  location / {\n    root /opt/redmine-3.3.2/public;\n    index index.html index.htm;\n  }\n}\n# ...\n"})}),"\n",(0,r.jsx)(n.h5,{id:"\u542f\u52a8-nginx",children:"\u542f\u52a8 Nginx"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost ~]# /root/nginx-1.10.3/sbin/nginx -c /root/nginx-1.10.3/conf/nginx.conf\n"})}),"\n",(0,r.jsx)(n.h4,{id:"\u5176\u4ed6",children:"\u5176\u4ed6"}),"\n",(0,r.jsx)(n.p,{children:"\u5230\u8fd9\u91cc\uff0c\u6240\u6709\u7684\u5b89\u88c5\u90fd\u5b8c\u6210\u4e86\uff0c\u8fc7\u7a0b\u4e2d\u6211\u9047\u5230\u8fd9\u4e9b\u95ee\u9898\uff0c\u4f60\u4e5f\u6ce8\u610f\u4e0b\uff1a"}),"\n",(0,r.jsx)(n.h5,{id:"71-could-not-find-gem-mysql2--0311-in-any-of-the-gem-sources-listed-in-your-gemfile",children:"7.1 Could not find gem 'mysql2 (~> 0.3.11)' in any of the gem sources listed in your Gemfile"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[root@localhost redmine-3.3.2]# rm -f Gemfile.lock\n[root@localhost redmine-3.3.2]# bundle install\n"})}),"\n",(0,r.jsx)(n.h5,{id:"72-curl-tools",children:"7.2 curl-tools"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"yum install libcurl-devel\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},4552:(e,n,l)=>{l.d(n,{I:()=>d,M:()=>s});var r=l(11504);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);