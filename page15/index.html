
<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Blog">
  <head>
    <meta charset="utf-8">
	<link rel="manifest" href="/static/pwa/manifest.json">
	<title> Home | 船长的课记 </title>
    
		
    <meta name="author" content="船长">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="theme-color" content="#2196F3">
	<meta name="google-site-verification" content="puZt0ZyqB-t67BYdYAgLUyIPBeismG68J0dmEc01QeY" />

	
    <script>
		if ('serviceWorker' in navigator) {
			window.addEventListener('load', function () {
				navigator.serviceWorker
										.register('/sw.js')
										.then(function(registration) {
											console.log("Successfully registered service worker", registration.scope);
										}).catch(function(err) {
											console.log("Service worker registration failed: ", err);
										});
				//navigator.serviceWorker.ready always resolve
				navigator.serviceWorker.ready.then(function (registration) {
					console.log('Service worker successfully registered on scope', registration.scope);
				});
			});
		}
    </script>
	<script type="text/javascript" src="/assets/themes/evjekylltheme/jquery-3.6.0.slim.min.js"></script>

	<link href="/assets/themes/evjekylltheme/google-code-prettify/desert.css" type="text/css" rel="stylesheet" />

    <!-- Le styles -->
    <link href="/assets/themes/evjekylltheme/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/evjekylltheme/css/style.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/images/favicon.ico">

    <!-- atom & rss feed -->
    <link href="" type="application/atom+xml" rel="alternate" title="Jekyll auto generate ATOM Feed">
    <link href="" type="application/atom+xml" rel="alternate" title="Site ATOM Feed">
    <link href="" type="application/rss+xml" rel="alternate" title="Site RSS Feed">
	<link rel="stylesheet" href="/assets/themes/evjekylltheme/font-awesome-4.4.0/css/font-awesome.min.css">
	<!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-W2LDG64');</script> -->
		<!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8529425670069509"
						crossorigin="anonymous"></script> -->
	<!-- <script async src="https://cdn.splitbee.io/sb.js"></script> -->
  </head>

  <body>
	<!-- <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2LDG64"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> -->
    <div class="navbar navbar-default navbar-fixed-top">
				<div class="container">
          <div class="row mobilepadding">
					<!-- <a class="navbar-brand" href="/">船长的课记</a> -->
					<a class="navbar-brand" href="/">SAMZONG</a>
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse" id="mNavbar">
  					<ul class="nav navbar-nav">
  						
  						
  						


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/friends.html">Friends</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



						  <li class="dropdown">
							  <a class="dropdown-toggle" data-toggle="dropdown" href="#">Other</a>
							  <ul class="dropdown-menu">
									<li><a href="/about.html">About</a></li>
									<li><a href="https://yuque.com/samzong/note" target="_blank">船长的课记</a></li>
									<li><a href="https://yuque.com/samzong/ap" target="_blank">果粉日记</a></li>
									<li><a href="https://yuque.com/samzong/code" target="_blank">Code Snippet</a></li>
									<li><a href="https://www.yuque.com/samzong/mcx" target="_blank">集</a></li>
									<li><a href="https://www.yuque.com/zooka" target="_blank">藏金阁</a></li>
								</ul>
						  </li>
  					</ul>
  					<form id="search-form" class="navbar-form navbar-right" role="search">
  						<div class="form-group">
  						<input type="text" class="form-control input-sm" placeholder="Search's Bad" id="query">
  						</div>
  					</form>
  					<div class="nav-icon">
  						<a href="/feed.xml"><i class="fa fa-rss fa-2x"></i></a>
  					</div>
          </div>
				</div>
      </div>
    </div>

    <div class="container">
			<div class="row mobilepadding">
        <div class="row">
					<div class="col-md-12">
						<div class="searchresult">
						</div>
						<div id="search-loader" class="img-wrap">
						</div>
					</div>
        </div>
				<meta itemprop="image" content="https://ipic-typora-samzong.oss-cn-qingdao.aliyuncs.com/uPic/telegram-cloud-photo-size-4-5971176114485308439-x.jpg">
<div class="row">
  <div class="col-xs-12 col-md-8">
    
    
    <h1><a class="title" href="/post/2016/12/HowTo-Mount-OSS-Bucket-On-ECS.html">HowTo Mount OSS Bucket On ECS</a></h1>
    <div class="post_at_index">
      <blockquote>
  <p>From <a href="https://github.com/aliyun/ossfs">阿里云官方 Github</a></p>
</blockquote>

<blockquote>
  <p>Demo: CentOS 6.8 on ECS</p>
</blockquote>

<p>ossfs 是通过磁盘挂载的形式，将 oss 存储挂载到 linux、类 unix 等操作系统，而且不仅仅可以挂载阿里云内的 ECS 上，理论上所有网络能到达 oss 的都可以挂载，但还是要以实际问题为准。</p>

<h5 id="1download--install">1.Download &amp; Install</h5>

<p><a href="https://github.com/aliyun/ossfs/releases">官方版本发布页面</a>，请根据你的系统类型进行选择，我这演示的环境是 CentOS 6.8；ossfs 目前最新的版本是 v1.79.9，您可以根据自己当时版本进行选择，建议选择最新版本。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 请先将包上传到服务器上
 sudo yum localinstall ossfs_1.79.9_centos6.5_x86_64.rpm
</code></pre></div></div>

<blockquote>
  <p>注意使用 localinstall，因为在安装过程，yum 可以很好的解决依赖关系，会节省我们很多时间</p>
</blockquote>

<h5 id="2-oss--bucket">2. OSS &amp; Bucket</h5>

<p>需要获取以下信息，在后面我们都会用到的：<br /></p>

<ol>
  <li>Bucket 名称
  <img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-0.jpg" alt="" />
  <br /></li>
  <li>Access Key ID</li>
  <li>Access Key Secret
  <img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0256A9CB-A0FA-43BC-82AF-4DE17D4852B6.png" alt="" /></li>
</ol>

<p><img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/QQ20161111-2.jpg" alt="" />
<br /></p>
<ol>
  <li>Location，这需要注意点，不要加上 Bucket 的名字，区域对应表如下，注意你的 Bucket 所在区域：</li>
</ol>
<div><table><thead><tr><th style="color:green">Region 中文名称</th><th style="text-align:left;color: green;">Region 英文表示</th><th style="text-align:left;color: green;">外网 Endpoint</th><th style="text-align:left;color: green;">ECS 访问的内网 Endpoint</th></tr></thead><tbody><tr><td>华东 1</td><td style="text-align:left">oss-cn-hangzhou</td><td style="text-align:left">oss-cn-hangzhou.aliyuncs.com</td><td style="text-align:left">oss-cn-hangzhou-internal.aliyuncs.com</td></tr><tr><td>华东 2</td><td style="text-align:left">oss-cn-shanghai</td><td style="text-align:left">oss-cn-shanghai.aliyuncs.com</td><td style="text-align:left">oss-cn-shanghai-internal.aliyuncs.com</td></tr><tr><td>华北 1</td><td style="text-align:left">oss-cn-qingdao</td><td style="text-align:left">oss-cn-qingdao.aliyuncs.com</td><td style="text-align:left">oss-cn-qingdao-internal.aliyuncs.com</td></tr><tr><td>华北 2</td><td style="text-align:left">oss-cn-beijing</td><td style="text-align:left">oss-cn-beijing.aliyuncs.com</td><td style="text-align:left">oss-cn-beijing-internal.aliyuncs.com</td></tr><tr><td>华南 1</td><td style="text-align:left">oss-cn-shenzhen</td><td style="text-align:left">oss-cn-shenzhen.aliyuncs.com</td><td style="text-align:left">oss-cn-shenzhen-internal.aliyuncs.com</td></tr><tr><td>香港数据中心</td><td style="text-align:left">oss-cn-hongkong</td><td style="text-align:left">oss-cn-hongkong.aliyuncs.com</td><td style="text-align:left">oss-cn-hongkong-internal.aliyuncs.com</td></tr><tr><td>美国硅谷数据中心</td><td style="text-align:left">oss-us-west-1</td><td style="text-align:left">oss-us-west-1.aliyuncs.com</td><td style="text-align:left">oss-us-west-1-internal.aliyuncs.com</td></tr><tr><td>美国弗吉尼亚数据中心</td><td style="text-align:left">oss-us-east-1</td><td style="text-align:left">oss-us-east-1.aliyuncs.com</td><td style="text-align:left">oss-us-east-1-internal.aliyuncs.com</td></tr><tr><td>亚太（新加坡）数据中心</td><td style="text-align:left">oss-ap-southeast-1</td><td style="text-align:left">oss-ap-southeast-1.aliyuncs.com</td><td style="text-align:left">oss-ap-southeast-1-internal.aliyuncs.com</td></tr><tr><td>亚太东北 1（日本）数据中心</td><td style="text-align:left">oss-ap-northeast-1</td><td style="text-align:left">oss-ap-northeast-1.aliyuncs.com</td><td style="text-align:left">oss-ap-northeast-1-internal.aliyuncs.com</td></tr></tbody></table></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 设置bucket/access key/id的信息，将其存放在/etc/passwd-ossfs 文件中
# 注意这个文件的权限必须正确设置，建议设为640
sudo echo my-bucket:my-access-key-id:my-access-key-secret &gt; /etc/passwd-ossfs
sudo chmod 640 /etc/passwd-ossfs
</code></pre></div></div>
<p><br /></p>
<h5 id="3-mount--uasge">3. Mount &amp; Uasge</h5>
<p>将 oss bucket mount 到指定目录：</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 我碰到安装后找不到ossfs命令，查看下因为ossfs没有x权限，目录路径为/usr/local/bin，如果您也碰到这个问题，可以增加x权限后再测试
sudo ossfs my-bucket /mnt/ossdir -ourl=http://oss-location.aliyuncs.com

# 如果使用ossfs的机器是阿里云ECS，可以使用内网域名来避免流量收费和 提高速度

sudo ossfs my-bucket /tmp/ossfs -ourl=&lt;http://oss-location-internal.aliyuncs.com&gt;

</code></pre></div></div>
<p>磁盘空间达到上百 T：
<img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/2016/11/0B78E099-5488-4839-AE48-09A074E7415D.png" alt="" />
<br /></p>

<p>umount：</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
# 注意用户身份

umount /tmp/ossfs # root user
sudo fusermount -u /tmp/ossfs # non-root user

</code></pre></div></div>
<p><br /></p>
<h5 id="4-debug--faq">4. Debug &amp; FAQ</h5>
<p>当遇到错误的时候，可以试着打开 Debug 日志信息，然后分析问题原因：</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
# 使用 -o dbglevel=debug -f -d参数打印日志信息

sudo ossfs my-bucket /tmp/ossfs -ourl=&lt;http://oss-location-internal.aliyuncs.com&gt; -o dbglevel=debug -f -d &gt; /mnt/ossfs.log 2&gt;&amp;1

</code></pre></div></div>

<p>更多的问题，请移步查看<a href="https://github.com/aliyun/ossfs/wiki/FAQ">官方的 FAQ 文档</a>。</p>

<p><br /></p>
<h5 id="5-about">5. About</h5>
<p>ossfs 提供的功能和性能和本地文件系统相比，具有一些局限性。具体包括：</p>

<ul>
  <li>随机或者追加写文件会导致整个文件的重写。</li>
  <li>元数据操作，例如 list directory，性能较差，因为需要远程访问 oss 服务器。</li>
  <li>文件/文件夹的rename操作不是原子的。</li>
  <li>多个客户端挂载同一个 oss bucket 时，依赖用户自行协调各个客户端的行为。例如避免多个客户端写同一个文件等等。</li>
  <li>不支持 hard link。</li>
  <li>不适合用在高并发读/写的场景，这样会让系统的load升高</li>
</ul>

<blockquote>
  <p>另外，ossfs 的稳定性很大一部分依赖于网络环境，建议的使用场景更多是作为临时数据迁移或定期备份，虽然 ossfs 挂载到系统中会有着几百 TB 的空间，但是稳定性并不高。</p>
</blockquote>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-20</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Aliyun">Aliyun</a>
      , 
      <a href="/tags.html#CentOS">CentOS</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/%E4%B8%8A%E6%B5%B7%E5%A4%A9%E5%86%B7%E4%BA%86.html">上海天冷了</a></h1>
    <div class="post_at_index">
      <p>上海天冷了啊！上海天冷了啊啊！！上海天冷了啊啊！！！</p>

<p>重要的事情说三遍，这是一个好习惯，有了冬天的感觉，早上起床的时候有感觉，下班路上有感觉，现在坐在键盘前打字也很有感觉；前几天在微博上写了几句话：如今算是最好的季节，褪去夏日的燥热与汗渍，又不像冬日那么干冷凛冽，穿的衣服也是刚刚好，单条牛仔裤加个风衣或冲锋衣既藏住身上的赘肉，又不失潇洒，正是装逼好时节，而最最好的是这个季节的女子，美丽更胜其它季节。朋友嘲笑说其实想看黑丝，哈哈！谁知才过几天，就感受到了那种“干冷凛冽”。但是，我喜欢这种感觉，就像我喜欢这座城市，我说我喜欢冬天，自小就喜欢，我说我喜欢这座城市，就像自小就喜欢；我说不出来为什么喜欢，就像很多说不出来为什么喜欢，就像有些人，就像有些事，就像有些讨厌，人终是要顺了自己的心意，不然不会开心，但是要懂事，不懂事就不可爱了。</p>

<!-- more -->

<p>最近一直比较忙，弄得心烦意乱。</p>

<p>生活上，最近外公有生病，母亲十分挂念，原本外公外婆年岁已高且身体不好，家里几位舅父却又不有作为，也令母亲十分苦恼，本来她身体也有不好，我却不能帮上她一二，内心也是颇为着急挂念，只能尽力安慰。说起外公外婆，也是难过不已，近两年，因些事每年都要回去两三趟，而又匆忙，故无多时间陪陪他们，外婆已多年卧病在床，起居生活全有外公照顾，我一次尝试想搀扶外婆起床，是异常艰难，可外公 80 多岁老人一扶就是 8 年多。有时，自己也想，若是自己到了这般年纪，该如何处置，想想也难过不已，想二位老人，到了这个年纪，早已不在乎吃穿用度如何如何，多年孤苦在家，更想要的子女多多陪伴，所以每次母亲打电话回去都哭泣不止；最怕“子欲养而亲不待”的事，我也劝说母亲有空就多多回老家陪陪，而母亲却担心我的婚娶生活，更令我难过不已，暗恨自己无用；昨今两日，父母又相继回老家，也希望外公身体早日恢复。</p>

<p>工作上，自从去年与领导夸下豪言便一直不敢懈怠，但实际做下来的确是要比想象中困难许多，本来自己就不是聪明，这段时间做项目需求，改了许多稿总算通过，开心，感叹领导是好性格，如此耐心指导我；而前段时间，这个项目好几处也是几近失控，和其他公司的人沟通协调处理等一团糟，还好如今都渐回正轨；第一项目还未做完，就打退堂鼓，幸亏领导的指导，同事的帮助，当然还有我的好妹妹，每次感觉扛不住的找她聊聊发发牢骚，都能耐心听并给我加油打气。感谢这些人，当然也感谢自己，总有各种办法给自己恢复元气，今早，用思维导图把最近的烦心事要做的事全部写出来，然后一条一条的分析处理，最后恢复了好心情，又一如既往的工作生活。</p>

<p>又 23 点过半了，要抓紧早睡了，调整正常作息才能更充沛的工作生活，记录走出了这一段不好的日子，恢复元气的自己，但是不能懈怠，毕竟“革命尚未成功，同志仍需努力”。</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-17</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Zero">Zero</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/%E5%91%8A%E5%88%AB.html">告别</a></h1>
    <div class="post_at_index">
      <p>你们一起看过很多风景</p>

<p>走过很多路</p>

<p>因为小事争吵</p>

<p>为了让对方委曲求全过</p>

<p>你们花光了所有力气</p>

<p>竟还是没有逃过分开的命运</p>

<p>于是从此以后</p>

<p>你走那条路都会想起当时的嬉笑怒骂</p>

<p>你经过街角的那间咖啡馆会记得甜得发腻的糖霜</p>

<p>可是人啊</p>

<p>总要学会告别</p>

<p>无论如何</p>

<p>我们的生命中</p>

<p>都逃脱不了</p>

<p>永无休止的告别</p>

<p><img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/pk6qu.JPG" alt="img" /></p>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-17</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Zero">Zero</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/%E8%A1%80%E6%88%98%E9%92%A2%E9%94%AF%E5%B2%AD.html">血战钢锯岭</a></h1>
    <div class="post_at_index">
      <p>历史才是最好的教科书，我们从一段又一段历史中汲取经验和教训，尽量让人生走得不去更加艰难，而这毫无疑问战争是最好的老师，最残酷的史实，人类从千百的历史中依然没能学会和平，战争，让这个世界变得满目疮痍。</p>

<p>今天去看了《血战钢锯岭》，有多久没有感动到流下眼泪，很好，前半段在讲述道斯如何与军队抗争，坚守自己的信仰，信仰是个好东西，但愿你我都有。后半段战争的场面极其的血腥暴力，电影尚是如此，真实又怎样想象，人生从来没有 NG，因为真实，才最有力量；我们都喜欢甜美的故事，我也为了道斯的爱情而感动，也因战争的残酷而愤怒。</p>

<p><img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/gjt1b.jpg" alt="道斯和妻子吻别" />
<img src="https://samzong.oss-cn-shenzhen.aliyuncs.com/blog/w4nzi.jpg" alt="道斯冒着枪林弹雨拯救受伤的士兵" /></p>

<p>这是我最喜欢的电影了，最让我感动的话是在军事法庭上道斯说：世界已经分崩离析，我要把它拼成原来的样子。看到这里心都碎了，这个世界上总有些人，哪怕与所有人为敌，所有人不信任，经受磨难羞辱，也坚持自己的信仰，这才是英雄；放下枪的人才是勇敢，他教会我们，我们应该成为怎样的人，不能忘记历史带给我们的伤痛，不能忘记而不是去恨，珍惜美好生活，不要战争。</p>

<p>在这段时期，同样想起的是南京大屠杀，同样是二战时期日军留下的暴行，他们是魔鬼，他们终将会受到应有的惩罚；首先，我们都不能忘记，这是我们的伤痛，真实的历史远比想象的更加残酷，哪些被迫害的人，哪些南京大屠杀纪念馆的人名册，这些人是多么的绝望啊，数以千万计的道斯奋战的美好世界，怎能让战争败类去迫害，我不喜欢战争，任何一个国家。</p>

<p>同样的选择给我，我会选择拿起枪，鲁迅先生说过：学医是救不了中国的，我终于不是道斯，看到咫尺近前的战友被日本人用刺刀刺死，却选择不拿起枪，我做不到；实际上，我也是一个有信仰的人，我的信仰的是我在乎的人，我愿意为了他们奋不顾身直到死亡，因为，他们是我的逆鳞啊！</p>

<p>小时候，常听老人家说，要忆苦思甜，实际上应该是要铭记战争带给我们的伤痛，要铭记那段时期，勇敢的坚持的信仰，更加重要的是珍惜现在的美好。</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-11</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Zero">Zero</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/HowTo-Install-Python3-on-CentOS-6-x.html">HowTo Install Python3 on CentOS 6.x</a></h1>
    <div class="post_at_index">
      <p>接触过 Python2.x 与 Python3.x 的应该知道，它们二者的区别也是蛮大的，而随着 Python3.x 的盛行，越来越多的应用运行与 Python3.x 的环境之上，但是我们的 CentOS 的系列，目前都默认安装时 Python2.x（CentOS 7.x 也是），所以不得不我们需要自己行动手安装 Python 3.x 的环境。</p>

<p>Mirosoft 平台与 Mac 平台，不在考虑范围，他们都有相应的软件包与图形化安装工具，可以很好的解决这个问题，所以今天我们的环境是在 CentOS 6.x 系列上进行。</p>

<blockquote>
  <p>Demo : CentOS 6.8</p>
</blockquote>

<h4 id="method-1-build--install-from-source-file">Method 1. Build &amp; Install From Source-File</h4>

<ol>
  <li>Python3.x 源码文件下载，请选择适合的版本。 <a href="https://www.python.org/ftp/python/">下载页面</a></li>
  <li>我这里使用版本 Python 3.5</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[cent@demo ~]$ wget https://www.python.org/ftp/python/3.5.0/Python-3.5.0.tgz
</code></pre></div></div>

<ol>
  <li>安装系统基本工具：</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum-utils
[cent@demo ~]$ sudo yum install -y yum-utils

# 构建python 编译环境
[cent@demo ~]$ sudo yum-builddep python
</code></pre></div></div>

<ol>
  <li>开始编译 &amp; 安装
并且源码安装的同时，会将 pip3 与 setuptools 一同安装。</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[cent@demo ~]$ tar xf Python-3.5.0.tgz
[cent@demo ~]$ cd Python-3.5.0
[cent@demo ~]$ ./configure
[cent@demo ~]$ make
[cent@demo ~]$ sudo make install
</code></pre></div></div>

<ol>
  <li>检查版本</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[cent@demo ~]$ python3 -V
Python 3.5.0

# 如果希望系统默认为Python3
[cent@demo ~]$ alias python='usr/bin/python3.5'
</code></pre></div></div>

<h4 id="method-2-install-from-epel-repos">Method 2. Install From EPEL repos</h4>

<p>也许有的同学会说，编译安装，那是上古时期的做法了，yum 在线安装才是王道，当然这种说法也有可取之处，所以接下来讲下如何使用 yum 安装，需要注意的是 yum 安装是需要时间测试和增加到相应的源仓库，一般会稍慢于源码安装的方式，这里采用 EPEL 源，这是一个非常棒的第三方源仓库，之前的文章中也多次提到，这里就不做过多描述，请看下面的命令：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[cent@demo ~]$ sudo yum install -y epel-release
[cent@demo ~]$ sudo yum install -y python34

# 因为yum安装时没能同时安装pip与setuptools，所以我们要手动安装，这里采用拿第三方包解决问题

[cent@demo ~]$ curl -O https://bootstrap.pypa.io/get-pip.py
[cent@demo ~]$ sudo python3 get-pip.py

[cent@demo ~]$  python3 -V
Python 3.4.3
</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-08</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Python">Python</a>
      , 
      <a href="/tags.html#CentOS">CentOS</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/HowTo-Reset-MySQL-Root-Password.html">HowTo Reset MySQL Root Password</a></h1>
    <div class="post_at_index">
      <h4 id="1-处理的状态">1. 处理的状态</h4>

<p>首先确认服务器出于安全的状态，也就是没有人能够任意地连接 MySQL 数据库。
因为在重新设置 MySQL 的 root 密码的期间，MySQL 数据库完全出于没有密码保护的
状态下，其他的用户也可以任意地登录和修改 MySQL 的信息。可以采用将 MySQL 对
外的端口封闭，并且停止 Apache 以及所有的用户进程的方法实现服务器的准安全
状态。最安全的状态是到服务器的 Console 上面操作，并且拔掉网线。</p>

<h4 id="2-重置密码">2. 重置密码</h4>

<ol>
  <li>修改 mysql 配置文件，增加 skip-grant-tables</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@demo ~]# vim /etc/my.cnf
[mysqld]
skip-grant-tables
</code></pre></div></div>

<ol>
  <li>重启 mysqld</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@demo ~]# service mysqld restart
Stopping mysqld:                                           [  OK  ]
Starting mysqld:                                           [  OK  ]
</code></pre></div></div>

<ol>
  <li>登录 mysql，并修改 root 密码。</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@demo ~]# mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 3
Server version: 5.5.53 MySQL Community Server (GPL)

Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; use mysql
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; update user set password=password('new-pass') where user='root';
Query OK, 5 rows affected (0.00 sec)
Rows matched: 5  Changed: 5  Warnings: 0
</code></pre></div></div>

<ol>
  <li>配置文件去除 skip-grant-tables，并重启服务器。</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@demo ~]# vim /etc/my.cnf
[root@demo ~]# service mysqld restart
</code></pre></div></div>

<ol>
  <li>使用新密码登录到 mysql</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@demo ~]# mysql -h localhost -u root -p
</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-04</cite> <i class="icon-tag"></i>
      <a href="/tags.html#MySQL">MySQL</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/12/Tomcat-2-%E5%88%A9%E7%94%A8JDK%E8%87%AA%E8%BA%ABkeytool%E5%AE%9E%E7%8E%B0HTTPS.html">Tomcat 利用 JDK 自身 keytool 实现 HTTPS</a></h1>
    <div class="post_at_index">
      <p>因为一个偶然机会，想把自己的 webserver 通过 https 加密访问，这里就采用 JDK 自带的 keytool 工具实现，tomcat 官方也推荐这种方式，英文好的同学走这里：<a href="https://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html">官方配置</a></p>

<blockquote>
  <p>demo: CentOS 6.6 &amp; Tomcat 7 &amp; JDK 1.7</p>
</blockquote>

<h4 id="1-生成-keystore">1. 生成 keystore</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@test conf]# keytool -genkey -v -alias tomcat -keyalg RSA -keystore mykeystore
Enter keystore password:              #设置密码
Re-enter new password:                #重复一次
What is your first and last name?
  [Unknown]:  Alex Lu                #随便填
What is the name of your organizational unit?
  [Unknown]:  visionet                #随便填
What is the name of your organization?
  [Unknown]:  visionet                #随便填
What is the name of your City or Locality?
  [Unknown]:  SH                #随便填
What is the name of your State or Province?
  [Unknown]:  SH                #随便填
What is the two-letter country code for this unit?
  [Unknown]:  ZH                #随便填
Is CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH correct?
  [no]:  Y                    #这里要Y，确认前面信息。

Generating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA) with a validity of 90 days
    for: CN=Alex Lu, OU=visionet, O=visionet, L=SH, ST=SH, C=ZH
Enter key password for &lt;tomcat&gt;
    (RETURN if same as keystore password):        #默认回车即可，不需要设置太多密码
[Storing mykeystore]
[root@test conf]# ls
Catalina  catalina.policy  catalina.properties  context.xml  logging.properties  mykeystore  server.xml  tomcat-users.xml  web.xml
</code></pre></div></div>

<blockquote>
  <p>注意：-keystore 是用来指定 keystore 保存位置，如果不加参数默认保存的当前用户家目录为~/.keystore
       -validity 可以用来指定证书有效期，单位为天，缺省值为 90 天。</p>
</blockquote>

<h4 id="2-备份tomcatdirconfserverxml">2. 备份$tomcatdir/conf/server.xml</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp $tomcatdir/conf/server.xml $tomcatdir/conf/server.xml
</code></pre></div></div>

<h4 id="3-修改-serverxml">3. 修改 server.xml</h4>

<h6 id="a-注释以下tomcat-注释用---xxxx----如何也想保留-http-访问可以不注释">a. 注释以下：（tomcat 注释用：&lt;!-- XXXX --&gt; ）,如何也想保留 http 访问，可以不注释</h6>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!--
&lt;Connector executor="tomcatThreadPool"
                port="80" protocol="HTTP/1.1"
                connectionTimeout="20000"
                redirectPort="8443" /&gt;
--&gt;
</code></pre></div></div>

<h6 id="b-取消下面注释">b. 取消下面注释</h6>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Connector port="443" protocol="HTTP/1.1" SSLEnabled="true"
                maxThreads="150" scheme="https" secure="true"
                clientAuth="false" sslProtocol="TLS" /&gt;
</code></pre></div></div>

<h6 id="c-增加-keystorefile-和-keystorepass">c. 增加 keystoreFile 和 keystorePass</h6>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Connector port="443" protocol="HTTP/1.1" SSLEnabled="true"
               maxThreads="150" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS"
               keystoreFile="conf/mykeystore" keystorePass="123456"/&gt;
</code></pre></div></div>

<blockquote>
  <p>keystoreFile=跟 keystore 文件位置
keystorePass=跟当时 keytool 命令执行时输入的密码</p>
</blockquote>

<h4 id="4-重启-tomcat">4. 重启 tomcat</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@test conf]# ../bin/catalina.sh stop &amp;&amp; ../bin/catalina.sh start
Using CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44
Using CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44
Using CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp
Using JRE_HOME:        /home/pms/jdk1.7.0_65
Using CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar
Using CATALINA_BASE:   /home/pms/apache-tomcat-6.0.44
Using CATALINA_HOME:   /home/pms/apache-tomcat-6.0.44
Using CATALINA_TMPDIR: /home/pms/apache-tomcat-6.0.44/temp
Using JRE_HOME:        /home/pms/jdk1.7.0_65
Using CLASSPATH:       /home/pms/apache-tomcat-6.0.44/bin/bootstrap.jar
[root@test conf]# netstat -ntlup | grep -e "80\|443"
tcp        0      0 0.0.0.0:80         0.0.0.0:*          LISTEN      21960/java
tcp        0      0 0.0.0.0:443        0.0.0.0:*          LISTEN      21960/java
tcp        0      0 127.0.0.1:8005     0.0.0.0:*          LISTEN      21960/java
tcp        0      0 0.0.0.0:8009       0.0.0.0:*          LISTEN      21960/java
[root@test conf]#
</code></pre></div></div>

<p>OK !</p>

      
    </div>
    <br/>
    <div>
      <cite>2016-12-03</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Tomcat">Tomcat</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/11/AWS-Use-s3cmd%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%A1%E7%90%86S3%E5%AD%98%E5%82%A8.html">AWS Use s3cmd 命令行管理 S3 存储</a></h1>
    <div class="post_at_index">
      <p>S3 是 AWS 公有云服务提供的云存储服务，提供海量数据存储服务，同时基于 AWS S3 提供的一系列网络服务接口，也有大量已经开发完成的工具供我们使用，以利用起 AWS 庞大的存储资源，这篇文章的目录选取了其中一个用 Linux 命令行工具<a href="http://s3tools.org">s3cmd</a>来管理 AWS S3 云存储其中的数据。</p>

<p>s3cmd 是非常优秀的 S3 命令行管理工具，用 python 编写，支持 python 2.6 &amp; 2.7，但是尚不支持 python3，但是目前绝大多数的 Linux 发行版默认都是 python2.x 系列。</p>

<blockquote>
  <p>Demo CentOS 6.x</p>
</blockquote>

<h2 id="install-s3cmd"><strong>Install s3cmd</strong></h2>

<h3 id="1-无论是-denbian-系还是-rehat-系列软件仓库内已经加入了-s3cmd">1. 无论是 Denbian 系还是 Rehat 系列，软件仓库内已经加入了 s3cmd</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 1.1 Ubuntu &amp; Debian
$ sudo apt-get install -y s3cmd

# 1.2 RHEL &amp; CentOS
$ sudo yum install s3cmd
</code></pre></div></div>

<h3 id="2-如果您的系统比较特殊软件仓库内找不到-s3cmd还有-s3cmd-的-github-上去获取相关安装信息链接">2. 如果您的系统比较特殊，软件仓库内找不到 s3cmd，还有 s3cmd 的 Github 上去获取相关安装信息：<a href="https://github.com/s3tools/s3cmd">链接</a></h3>

<h2 id="configure-s3cmd"><strong>Configure s3cmd</strong></h2>

<h3 id="1-第一次运行-s3cmd-需要首先预配置相关-s3-信息">1. 第一次运行 s3cmd 需要首先预配置相关 s3 信息</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s3cmd --configure
</code></pre></div></div>

<p>它会问你一系列问题：</p>

<ul>
  <li>AWS S3 中 IAM 账户的 Access Key 以及 Secret Key (建议单独创建 IAM)</li>
  <li>对 AWS S3 双向传输的加密密码（自行设定不要忘记）</li>
  <li>为加密数据设定 GPG 程序的路径（默认即可）</li>
  <li>是否使用 https 协议（默认即可）</li>
  <li>如果不是 https 协议，需要设定名字和端口
配置完成之后，配置信息以普通文本保存在~/.s3cfg</li>
</ul>

<h3 id="2-china-与-global-的区别">2. China 与 Global 的区别</h3>

<p>笔者在第一次运行时，始终无法添加成功，报错信息如下：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ERROR: Test failed: 403 (InvalidAccessKeyId): The AWS Accecc Key Id you provided does not exist in our records.
</code></pre></div></div>

<p>起初以为是 Access Key 不对，在经过多次测试之后，才发现问题，这是因为 s3cmd 内置 s3 的 Domain 为 Global 的信息，而中国与 Global 是独立存在的所以查找不到我们的 Access Key。所以，如果你使用的 Global AWS 那么上面一步应该已经配置好了你的 s3cmd，如果你是 AWS China 的用户，那么你要做以下操作。</p>

<ul>
  <li>在 Retry configuration? [Y/n]选择“n”</li>
  <li>Save settings? [y/N] 选择“y”</li>
  <li>保存设置之后，编辑配置文件（~/.s3cfg ) 修改其中的如下字段，并将其中%(bucket)s 用您实际的某一个存储桶名字代替掉</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bucket_location = %(location)
host_base = s3.cn-north-1.amazonaws.com.cn
host_bucket = %(bucket)s.s3.cn-north-1.amazonaws.com.cn
website_endpoint = http://%(bucket)s.s3-website-%(location)s.amazonaws.com.cn/
</code></pre></div></div>

<p>例如，你的存储桶的名字为 s3chinatest: 地域为北京。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bucket_location = cn-north-1
host_base = s3.cn-north-1.amazonaws.com.cn
host_bucket = s3chinatest.s3.cn-north-1.amazonaws.com.cn
website_endpoint = http://s3chinatest.s3-website.amazonaws.com.cn/
</code></pre></div></div>

<h3 id="3-保存配置文件然后用命令测试一下确认-s3cmd-可以正常工作">3. 保存配置文件，然后用命令测试一下，确认 s3cmd 可以正常工作</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd ls
2016-11-18 22:30 s3://s3chinatest
2016-10-29 00:14 s3://bucket2
</code></pre></div></div>

<h2 id="s3cmd-的基本使用"><strong>s3cmd 的基本使用</strong></h2>

<h3 id="1-查看当前账户下所有现有的桶-bucket">1. 查看当前账户下所有现有的桶 (bucket)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd ls
2016-11-18 22:30 s3://s3chinatest
2016-10-29 00:14 s3://bucket2
</code></pre></div></div>

<h3 id="2-创建新的-bucket">2. 创建新的 bucket</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd mb s3://s3chinatest2

Bucket ’s3://s3chinatest2/’ created
</code></pre></div></div>

<h3 id="3-上传文件到-bucket">3. 上传文件到 bucket</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd put file1.txt file2.txt file3.txt s3://s3chinatest2
upload: 'file1.txt' -&gt; 's3://s3chinatest2/file1.txt'  [1 of 3]
 2432 of 2432   100% in    0s    43.27 kB/s  done
upload: 'file2.txt' -&gt; 's3://s3chinatest2/file2.txt'  [2 of 3]
 2432 of 2432   100% in    0s    59.83 kB/s  done
upload: 'file3.txt' -&gt; 's3://s3chinatest2/file3.txt'  [3 of 3]
 2432 of 2432   100% in    0s    58.93 kB/s  done

 $ s3cmd ls s3://s3chinatest2
 2016-11-18 15:11      2432   s3://s3chinatest2/file1.txt
2016-11-18 15:11      2432   s3://s3chinatest2/file2.txt
2016-11-18 15:11      2432   s3://s3chinatest2/file3.txt
</code></pre></div></div>

<p>上传的文件默认访问权限为私有 (private)，只能用户自己可以访问，使用正确的访问和安全密码即可。<br />
如果要上传公开访问权限的文件，需要添加 –acl-public 参数。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd put  --acl-public file4.txt s3://s3chinatest2
upload: 'file4.txt' -&gt; 's3://s3chinatest2/file1.txt'  [1 of 1]
 2432 of 2432   100% in    0s    43.27 kB/s  done
</code></pre></div></div>

<h3 id="4-下载-bucket-内的文件">4. 下载 bucket 内的文件</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd get s3://s3chinatest2/file1.txt
download: 's3://s3chinatest2/file1.txt' -&gt; './file1.txt'  [1 of 1]
 2432 of 2432   100% in    0s    27.65 kB/s  done

 # 支持 " * "匹配任意字符
 $ s3cmd get s3://s3chinatest2/file*.txt
download: 's3://s3chinatest2/file1.txt' -&gt; './file1.txt'  [1 of 3]
 2432 of 2432   100% in    0s    48.11 kB/s  done
download: 's3://s3chinatest2/file2.txt' -&gt; './file2.txt'  [2 of 3]
 2432 of 2432   100% in    0s    84.76 kB/s  done
download: 's3://s3chinatest2/file3.txt' -&gt; './file3.txt'  [3 of 3]
 2432 of 2432   100% in    0s    75.28 kB/s  done
</code></pre></div></div>

<blockquote>
  <p>注意若当前目录有相同文件时，可以使用–skip-existing 参数跳过这些文件。</p>
</blockquote>

<h3 id="5-删除-bucket-内的文件">5. 删除 bucket 内的文件</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># del 与 rm 都可以使用.
$ s3cmd del s3://s3chinatest2/file1.txt
delete: 's3://s3chinatest2/file1.txt'
</code></pre></div></div>

<h3 id="6-获取当前-bucket-信息">6. 获取当前 bucket 信息</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># bucket的存储位置及访问权限设置
s3cmd info s3://s3chinatest2
s3://s3chinatest2/ (bucket):
   Location:  cn-north-1
   Payer:     BucketOwner
   Expiration Rule: none
   policy:    none
   cors:      none
   ACL:       2fe63da8137b85d9868d240869945287b285a58b5d7e07e21ac813b486dcabea: FULL_CONTROL
</code></pre></div></div>

<h3 id="7-上传文件到-bucket-时加密">7. 上传文件到 bucket 时加密</h3>

<p>当用 s3cmd 下载一个加密过的文件时，它会自动检测加密并在下载过程解密，因此下载和访问加密文件时，就像通常所做的一样</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd -e put t_result.java s3://s3chinatest2
upload: '/tmp/tmpfile-S9lUXERAEUdnNaz5zHba' -&gt; 's3://s3chinatest2/t_result.java'  [1 of 1]
 3355 of 3355   100% in    0s    39.25 kB/s  done
</code></pre></div></div>

<h3 id="8-查看-bucket-使用情况">8. 查看 bucket 使用情况</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd du s3://s3chinatest2
8219     3 objects s3://s3chinatest2/
</code></pre></div></div>

<h3 id="9-删除一个-bucket">9. 删除一个 bucket</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ s3cmd rb s3://s3chinatest2
ERROR: S3 error: 409 (BucketNotEmpty): The bucket you tried to delete is not empty
# 默认不能删除非空的bucket，所以要先清空存储桶内数据

$ s3cmd rm s3://s3chinatest2/*
delete: 's3://s3chinatest2/file2.txt'
delete: 's3://s3chinatest2/file3.txt'
delete: 's3://s3chinatest2/t_result.java'

$ s3cmd rb s3://s3chinatest2
Bucket 's3://s3chinatest2/' removed
</code></pre></div></div>

<h2 id="other"><em>Other</em></h2>

<ol>
  <li>关于 s3cmd 还有非常多的功能，这里只是列举简单的一部分，有兴趣的同学，可以使用 man s3cmd 查看详细的帮助文档。</li>
  <li>s3cmd 适用的场景主要利用脚本做 cron 任务，例如定时备份，然后推送到 s3，降低成本，持久保存。</li>
  <li>Windows 平台也支持 s3cmd 哦，有兴趣的同学可以去研究下。</li>
</ol>

      
    </div>
    <br/>
    <div>
      <cite>2016-11-30</cite> <i class="icon-tag"></i>
      <a href="/tags.html#AWS">AWS</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/11/Tomcat-1-java-lang-OutOfMemoryError.html">Tomcat java.lang.OutOfMemoryError</a></h1>
    <div class="post_at_index">
      <h3 id="1-什么是-permgen-space-">1. 什么是 <em>PermGen space</em> ?</h3>

<p>PermGen space 的全称是 Permanent Generation space，是指内存的永久保存区域，这块内存主要是被 JVM 存放 Class 和 Meta 信息的，Class 在被 Loader 时就会被放到 PermGen space 中，它和存放类实例 (Instance) 的 Heap 区域不同，GC(Garbage Collection) 不会在主程序运行期对 PermGen space 进行清理，所以如果你的应用中有很 CLASS 的话，就很可能出现 PermGen space 错误，这种错误常见在 web 服务器对 JSP 进行 pre compile 的时候。如果你的 WEB APP 下都用了大量的第三方 jar，其大小超过了 jvm 默认的大小 (4M) 那么就会产生此错误信息了。</p>

<h3 id="2-解决方法">2. 解决方法</h3>

<h5 id="21-手动设置-maxpermsize-大小">2.1 手动设置 MaxPermSize 大小</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 修改$TOMCAT_HOME/bin/catalina.sh，在“echo "Using CATALINA_BASE:   $CATALINA_BASE"”上面加入以下行：
JAVA_OPTS="-server -Xms256m -Xmx512m -XX:PermSize=64M -XX:MaxPermSize=128m"
</code></pre></div></div>

<h3 id="3-java-heap-space">3. Java heap space</h3>

<h4 id="解释">解释</h4>

<p>Heap size 设置
JVM 堆的设置是指 java 程序运行过程中 JVM 可以调配使用的内存空间的设置.JVM 在启动的时候会自动设置 Heap size 的值，其初始空间 (即-Xms) 是物理内存的 1/64，最大空间 (-Xmx) 是物理内存的 1/4。可以利用 JVM 提供的-Xmn -Xms -Xmx 等选项可进行设置。Heap size 的大小是 Young Generation 和 Tenured Generaion 之和。</p>

<ul>
  <li>提示：在 JVM 中如果 98％的时间是用于 GC 且可用的 Heap size 不足 2％的时候将抛出此异常信息。</li>
  <li>提示：Heap Size 最大不要超过可用物理内存的 80％，一般的要将-Xms 和-Xmx 选项设置为相同，而-Xmn 为 1/4 的-Xmx 值。</li>
</ul>

<blockquote>
  <p>修改设置方法如 PermGen space</p>
</blockquote>

      
    </div>
    <br/>
    <div>
      <cite>2016-11-28</cite> <i class="icon-tag"></i>
      <a href="/tags.html#Tomcat">Tomcat</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    
    
    <h1><a class="title" href="/post/2016/11/HowTo-Install-LNMP-on-CentOS-6-x.html">HowTo Install LNMP on CentOS 6.x</a></h1>
    <div class="post_at_index">
      <blockquote>
  <table>
    <tbody>
      <tr>
        <td>egrep -v “^ *#</td>
        <td>^*$”     去除所有以#号开头的文件</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h4 id="demo-system">Demo system</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Alex@Test01 ~]$ uname -a
Linux Test01 2.6.32-504.el6.x86_64 #1 SMP Wed Oct 15 04:27:16 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
[Alex@Test01 ~]$ ip addr | grep eth0
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    inet 10.0.2.128/24 brd 10.0.2.255 scope global eth0
</code></pre></div></div>

<h4 id="install-httpd">Install httpd</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Alex@Test01 yum.repos.d]$ sudo yum install -y httpd
[Alex@Test01 ~]$ rpm -qa | grep httpd
httpd-2.2.15-39.el6.centos.x86_64
httpd-tools-2.2.15-39.el6.centos.x86_64

# remove welcome page
[Alex@Test01 yum.repos.d]$ sudo rm -f /etc/httpd/conf.d/welcome.conf
# remove default error page
[Alex@Test01 yum.repos.d]$ sudo rm -f /var/www/error/noindex.html
</code></pre></div></div>

<h4 id="configure-httpd--replace-the-server-name-to-you-own-one">Configure httpd . Replace the server name to you own one</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Alex@Test01 ~]# sudo vi /etc/httpd/conf/httpd.conf
# line 44: change
 ServerTokens Prod
# line 76: change to ON
 KeepAlive On
# line 262: Admin's address
 ServerAdmin luchuanjia@msn.com
# line 338: change
 AllowOverride All
# line 276: change to your server's name
 ServerName www.ultraera.org:80
# line 402: add file name that it can access only with directory's name
 DirectoryIndex index.html index.htm
# line 536: change
 ServerSignature Off
# line 759: comment out
# AddDefaultCharset UTF-8
[Alex@Test01 ~]# sudo /etc/init.d/httpd start
 Starting httpd:[  OK  ]
[Alex@Test01 ~]# sudo chkconfig httpd on     # set httpd start with system.
</code></pre></div></div>

<h4 id="create-a-html-test-page">create a HTML test page</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Alex@Test01 ~]# sudo vi /var/www/html/index.html
it's ok.
</code></pre></div></div>

<p><img src="http://s3.51cto.com/wyfs02/M00/70/DE/wKioL1XAUfuQoFfwAACC5LJWQgg039.jpg" alt="" /></p>

<h4 id="install-php">Install PHP</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Alex@Test01 ~]$ sudo yum install -y php php-mbstring php-pear
[Alex@Test01 ~]$ rpm -qa | grep php
php-common-5.3.3-46.el6_6.x86_64
php-5.3.3-46.el6_6.x86_64
php-mbstring-5.3.3-46.el6_6.x86_64
php-cli-5.3.3-46.el6_6.x86_64
php-pear-1.9.4-4.el6.noarch

[Alex@Test01 ~]$ sudo vi /etc/httpd/conf/httpd.conf
# line 402 add file name that it can access only with directory's name
  DirectoryIndex index.html index.htm index.php
[Alex@Test01 ~]$ sudo vi /etc/php.ini
# line 946 set your timezone
date.timezone = "Asia/Shanghai"
[Alex@Test01 ~]$ sudo /etc/init.d/httpd restart
 Stopping httpd:[  OK  ]
 Starting httpd:[  OK  ]
</code></pre></div></div>

<h4 id="create-a-php-test-page">create a php test page</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Alex@Test01 ~]# sudo vi /var/www/html/index.php

&lt;?php
    phpinfo();
?&gt;
</code></pre></div></div>

<p><img src="http://s3.51cto.com/wyfs02/M02/70/DE/wKioL1XAUguwJCl2AARE16t4hyw682.jpg" alt="" /></p>

<h4 id="install-mysql">Install MySQL</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Alex@Test01 ~]$ sudo -y install mysql-server
[Alex@Test01 ~]$ rpm -qa | grep mysql-server
mysql-server-5.1.73-5.el6_6.x86_64

[Alex@Test01 ~]$ sudo vi /etc/my.cnf
[mysqld]
datadir=/var/lib/mysql
socket=/var/lib/mysql/mysql.sock
user=mysql
# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0
# add
character-set-server=utf8

[Alex@Test01 ~]$ sudo /etc/rc.d/init.d/mysqld start

Initializing MySQL database:  WARNING: The host 'www.ultraera.org' could not be looked up with resolveip.
This probably means that your libc libraries are not 100 % compatible
with this binary MySQL version. The MySQL daemon, mysqld, should work
normally with the exception that host name resolving will not work.
This means that you should use IP addresses instead of hostnames
when specifying MySQL privileges !
Installing MySQL system tables...
OK
Filling help tables...
OK
...
...
...
You can test the MySQL daemon with mysql-test-run.pl
cd /usr/mysql-test ; perl mysql-test-run.pl

Please report any problems with the /usr/bin/mysqlbug script!

                                              [  OK  ]
Starting mysqld:                      [  OK  ]
[Alex@Test01 ~]$ sudo chkconfig mysqld on
</code></pre></div></div>

<h4 id="initial-settings-for-mysql">Initial settings for MySQL</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@www ~]#mysql_secure_installation
NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MySQL to secure it, we'll need the current
password for the root user.  If you've just installed MySQL, and
you haven't set the root password yet, the password will be blank,
so you should just press enter here.

# Enter
 Enter current password for root (enter for none):
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into the MySQL
root user without the proper authorisation.

# set root password
 Set root password? [Y/n]y
 New password:    # input any password
 Re-enter new password:
Password updated successfully!
Reloading privilege tables..
 ... Success!

By default, a MySQL installation has an anonymous user, allowing anyone
to log into MySQL without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

# remove anonymous users
 Remove anonymous users? [Y/n]y

 ... Success!

Normally, root should only be allowed to connect from 'localhost'.  This
ensures that someone cannot guess at the root password from the network.

# disallow root login remotely
 Disallow root login remotely? [Y/n]y

 ... Success!

By default, MySQL comes with a database named 'test' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

# remove test database
 Remove test database and access to it? [Y/n]y

 - Dropping test database...
 ... Success!
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

# reload privilege tables
 Reload privilege tables now? [Y/n]y

 ... Success!

Cleaning up...

All done!  If you've completed all of the above steps, your MySQL
installation should now be secure.

Thanks for using MySQL!

# try to connect with root
 [root@www ~]#mysql -u root -p
 Enter password:# MySQL root password
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 10
Server version: 5.1.73 Source distribution

Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

# display user list
 mysql&gt;select user,host,password from mysql.user;
+------+-----------+-------------------------------------------+
| user | host      | password                                  |
+------+-----------+-------------------------------------------+
| root | localhost | ***************************************** |
| root | 127.0.0.1 | ***************************************** |
+------+-----------+-------------------------------------------+
2 rows in set (0.00 sec)

# display database list
 mysql&gt;show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
+--------------------+
2 rows in set (0.00 sec)
mysql&gt;exit
Bye
</code></pre></div></div>

      
    </div>
    <br/>
    <div>
      <cite>2016-11-28</cite> <i class="icon-tag"></i>
      <a href="/tags.html#LNMP">LNMP</a>
      
      
      
    </div>
    <div style="clear: both;"></div>
    <hr/>
    

    <!-- Pagination links -->
    <nav>
      <ul class="pagination hidden-xs">
        
        
        <li>
          <a href="/page14">&laquo; Previous</a>
        </li>
        
        

        
        <li>
          <a href="/">1</a>
        </li>
        

        
          
            
            <li>
              <a href="/page2">2</a>
            </li>
            
            <li>
              <a href="/page3">3</a>
            </li>
            
            <li>
              <a href="/page4">4</a>
            </li>
            
            <li>
              <a href="/page5">5</a>
            </li>
            
            <li class="disabled"><span>...</span></li>
            <li class="active"><a>15</a></li>
          
          <li class="disabled"><span>...</span></li>
          <li><a href="/page23">23</a></li>
        

        
        

        
        <li>
          <a href="/page16">Next &raquo;</a>
        </li>
        
      </ul>
    </nav>
  </div>
  <div class="col-xs-12 col-md-4">
		<!-- <div>
			<a class="twitter-timeline" data-width="390" data-height="640" data-theme="light" href="https://twitter.com/samzong_lu?ref_src=twsrc%5Etfw">Tweets by SAMZONG</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
		</div> -->
    <div>
      <h2>传送门</h2>
      <ul>
        <li><a href="https://yuque.com/samzong">语雀-花园</a></li>
        <li><a href="https://github.com/samzong">Github</a></li>
      </ul>
    </div>
    <div class="categories">
      <h2>文章分类</h2>
      <ul class="tag_box">
        
        


  
     
    	
      <li><a href="/categories.html#Linux">
    		Linux <span>21</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#CentOS">
    		CentOS <span>14</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#HTML">
    		HTML <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#数据库">
    		数据库 <span>19</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#MySQL">
    		MySQL <span>15</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Git">
    		Git <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#TortoiseGit">
    		TortoiseGit <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#MongoDB">
    		MongoDB <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#PHP">
    		PHP <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Mac">
    		Mac <span>17</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#SourceTree">
    		SourceTree <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#OpenSource">
    		OpenSource <span>11</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Piwik">
    		Piwik <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Python">
    		Python <span>45</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#云服务">
    		云服务 <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Azure">
    		Azure <span>4</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#虚拟化">
    		虚拟化 <span>7</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#OpenStack">
    		OpenStack <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#CloudStack">
    		CloudStack <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Zabbix">
    		Zabbix <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Tomcat">
    		Tomcat <span>5</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Redis">
    		Redis <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Docker">
    		Docker <span>6</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Shell">
    		Shell <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Blog">
    		Blog <span>4</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Ghost">
    		Ghost <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#PostgreSQL">
    		PostgreSQL <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#AWS">
    		AWS <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Aliyun">
    		Aliyun <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Redmine">
    		Redmine <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Bigdata">
    		Bigdata <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Tools">
    		Tools <span>4</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#VPN">
    		VPN <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Windows">
    		Windows <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Jmeter">
    		Jmeter <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#随笔">
    		随笔 <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#读书笔记">
    		读书笔记 <span>16</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#SQL">
    		SQL <span>5</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Node">
    		Node <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#BI">
    		BI <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#NaN">
    		NaN <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#微服务">
    		微服务 <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#ClickHouse">
    		ClickHouse <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#闲聊">
    		闲聊 <span>3</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Hexo">
    		Hexo <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Javascript">
    		Javascript <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Telegram">
    		Telegram <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Metabase">
    		Metabase <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#学习">
    		学习 <span>2</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Github">
    		Github <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#Gitlab">
    		Gitlab <span>1</span>
    	</a></li>
     
    	
      <li><a href="/categories.html#云原生">
    		云原生 <span>1</span>
    	</a></li>
    
  



      </ul>
    </div>
    <div>
      <h2>最近文章</h2>
      <ul>
        
        <li>
          <a href="/post/2022/11/Dubbo-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html">Dubbo 基础知识梳理</a>
          
  参考资料：



        </li>
        
        <li>
          <a href="/post/2022/11/Panads-fill-NaN-value-to-Zero.html">Panads fill NaN value to Zero</a>
          ```python
df = pandas.read_csv(‘somefile.txt’)


        </li>
        
        <li>
          <a href="/post/2022/10/Redash-for-Docker-%E9%83%A8%E7%BD%B2.html">Redash for Docker 部署</a>
          暗坑很多


        </li>
        
        <li>
          <a href="/post/2022/10/%E5%94%A7%E5%94%A7%E5%A4%8D%E5%94%A7%E5%94%A7.html">唧唧复唧唧</a>
          王路
12 highlights


        </li>
        
        <li>
          <a href="/post/2022/10/%E8%87%AA%E5%8D%91%E4%B8%8E%E8%B6%85%E8%B6%8A.html">自卑与超越</a>
          【奥】阿尔弗雷德··阿德勒


        </li>
        
      </ul>
    </div>
  </div>
</div>

			</div>

		</div>

    <footer>
      <div class="container">
        <div class="row mobilepadding">
          			<hr>
      &copy; 2022 船长. Powered by <a href="http://jekyllrb.com" target="_blank" title="The simple, blog-aware, static site generator.">Jekyll</a>. Theme Creator <a href="https://github.com/einverne" target="_blank" title="Ein Verne's GitHub Repos">Ein Verne</a> . Host on <a href="https://github.com/samzong/samzong.me" target="_blank" title="Samzong's GitHub Repos">Github</a> .
      <br><br>
      </div>
    </div>
    </footer>

    




	<script async type="text/javascript" src="/assets/themes/evjekylltheme/bootstrap-3.3.5/js/bootstrap.min.js"></script>
	<script async type="text/javascript" src="/assets/themes/evjekylltheme/webcore.js"></script>

 </body>
</html>

