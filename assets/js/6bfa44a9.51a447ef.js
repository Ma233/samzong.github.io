"use strict";(self.webpackChunksamzong_me=self.webpackChunksamzong_me||[]).push([[85236],{30920:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var s=r(17624),t=r(4552);const a={title:"HowTo Install KVM Manage Server webvirtmgr",tags:["KVM"],date:new Date("2016-07-27T17:34:01.000Z")},i=void 0,l={permalink:"/2016/07/27/HowTo-Install-KVM-Manage-Server-webvirtmgr",source:"@site/blog/2016-07-27-HowTo-Install-KVM-Manage-Server-webvirtmgr.md",title:"HowTo Install KVM Manage Server webvirtmgr",description:"\u751f\u4ea7\u73af\u5883\u7684 KVM \u5bbf\u4e3b\u673a\u8d8a\u6765\u8d8a\u591a\uff0c\u9700\u8981\u5bf9\u5bbf\u4e3b\u673a\u7684\u72b6\u6001\u8fdb\u884c\u8c03\u63a7\u3002\u8fd9\u91cc\u7528 webvirtmgr \u8fdb\u884c\u7ba1\u7406\u3002\u56fe\u5f62\u5316\u7684 WEB\uff0c\u8ba9\u4eba\u80fd\u66f4\u65b9\u4fbf\u7684\u67e5\u770b kvm \u5bbf\u4e3b\u673a\u7684\u60c5\u51b5\u548c\u64cd\u4f5c\u3002",date:"2016-07-27T17:34:01.000Z",formattedDate:"July 27, 2016",tags:[{label:"KVM",permalink:"/tags/kvm"}],hasTruncateMarker:!1,authors:[],frontMatter:{title:"HowTo Install KVM Manage Server webvirtmgr",tags:["KVM"],date:"2016-07-27T17:34:01.000Z"},unlisted:!1,prevItem:{title:"HowTo Trun Off IPv6 in CentOS 6.x",permalink:"/2016/07/29/HowTo-Trun-Off-IPv6-in-CentOS-6-x"},nextItem:{title:"Yum \u4e2d$releasever \u548c$basearch \u7684\u53d6\u503c",permalink:"/2016/07/27/yum-zhong-releasever-he-basearch-de-qu-zhi"}},o={authorsImageUrls:[]},c=[{value:"Install",id:"install",level:3},{value:"\u5b89\u88c5\u652f\u6301\u7684\u8f6f\u4ef6\u6e90",id:"\u5b89\u88c5\u652f\u6301\u7684\u8f6f\u4ef6\u6e90",level:4},{value:"\u5b89\u88c5\u76f8\u5173\u8f6f\u4ef6",id:"\u5b89\u88c5\u76f8\u5173\u8f6f\u4ef6",level:4},{value:"\u4ece git-hub \u4e2d\u4e0b\u8f7d\u76f8\u5173\u7684 webvirtmgr \u4ee3\u7801",id:"\u4ece-git-hub-\u4e2d\u4e0b\u8f7d\u76f8\u5173\u7684-webvirtmgr-\u4ee3\u7801",level:4},{value:"\u5b89\u88c5 webvirtmgr",id:"\u5b89\u88c5-webvirtmgr",level:4},{value:"\u5b89\u88c5\u6570\u636e\u5e93",id:"\u5b89\u88c5\u6570\u636e\u5e93",level:4},{value:"\u5bf9 django \u8fdb\u884c\u73af\u5883\u914d\u7f6e",id:"\u5bf9-django-\u8fdb\u884c\u73af\u5883\u914d\u7f6e",level:4},{value:"\u62f7\u8d1d web \u5230 \u76f8\u5173\u76ee\u5f55",id:"\u62f7\u8d1d-web-\u5230-\u76f8\u5173\u76ee\u5f55",level:4},{value:"\u8bbe\u7f6e ssh",id:"\u8bbe\u7f6e-ssh",level:4},{value:"\u7f16\u8f91 nginx \u914d\u7f6e\u6587\u4ef6",id:"\u7f16\u8f91-nginx-\u914d\u7f6e\u6587\u4ef6",level:4},{value:"\u542f\u52a8 nginx",id:"\u542f\u52a8-nginx",level:4},{value:"\u4fee\u6539\u9632\u706b\u5899\u89c4\u5219 ( \u5982\u679c\u5173\u95ed selinux\uff0c\u6b64\u6b65\u53ef\u7701\u7565)",id:"\u4fee\u6539\u9632\u706b\u5899\u89c4\u5219--\u5982\u679c\u5173\u95ed-selinux\u6b64\u6b65\u53ef\u7701\u7565",level:4},{value:"\u8bbe\u7f6e supervisor",id:"\u8bbe\u7f6e-supervisor",level:4},{value:"\u8bbe\u7f6e\u5f00\u673a\u542f\u52a8",id:"\u8bbe\u7f6e\u5f00\u673a\u542f\u52a8",level:4},{value:"\u542f\u52a8\u8fdb\u7a0b",id:"\u542f\u52a8\u8fdb\u7a0b",level:4},{value:"\u8bbf\u95ee",id:"\u8bbf\u95ee",level:4}];function d(e){const n={a:"a",code:"code",em:"em",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,t.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"\u751f\u4ea7\u73af\u5883\u7684 KVM \u5bbf\u4e3b\u673a\u8d8a\u6765\u8d8a\u591a\uff0c\u9700\u8981\u5bf9\u5bbf\u4e3b\u673a\u7684\u72b6\u6001\u8fdb\u884c\u8c03\u63a7\u3002\u8fd9\u91cc\u7528 webvirtmgr \u8fdb\u884c\u7ba1\u7406\u3002\u56fe\u5f62\u5316\u7684 WEB\uff0c\u8ba9\u4eba\u80fd\u66f4\u65b9\u4fbf\u7684\u67e5\u770b kvm \u5bbf\u4e3b\u673a\u7684\u60c5\u51b5\u548c\u64cd\u4f5c\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"https://github.com/retspen/webvirtmgr",children:"GitHub Project."})})})}),"\n",(0,s.jsx)(n.h3,{id:"install",children:"Install"}),"\n",(0,s.jsx)(n.h4,{id:"\u5b89\u88c5\u652f\u6301\u7684\u8f6f\u4ef6\u6e90",children:"\u5b89\u88c5\u652f\u6301\u7684\u8f6f\u4ef6\u6e90"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yum install -y epel-release\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u5b89\u88c5\u76f8\u5173\u8f6f\u4ef6",children:"\u5b89\u88c5\u76f8\u5173\u8f6f\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yum -y install git python-pip libvirt-python libxml2-python python-websockify supervisor nginx\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u4ece-git-hub-\u4e2d\u4e0b\u8f7d\u76f8\u5173\u7684-webvirtmgr-\u4ee3\u7801",children:"\u4ece git-hub \u4e2d\u4e0b\u8f7d\u76f8\u5173\u7684 webvirtmgr \u4ee3\u7801"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd /usr/local/src/\ngit clone git://github.com/retspen/webvirtmgr.git\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u5b89\u88c5-webvirtmgr",children:"\u5b89\u88c5 webvirtmgr"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd webvirtmgr/\npip install -r requirements.txt\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u5b89\u88c5\u6570\u636e\u5e93",children:"\u5b89\u88c5\u6570\u636e\u5e93"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yum install python-sqlite2\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u5bf9-django-\u8fdb\u884c\u73af\u5883\u914d\u7f6e",children:"\u5bf9 django \u8fdb\u884c\u73af\u5883\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"./manage.py syncdb\n\nYou just installed Django's auth system, which means you don't have any superusers defined.\nWould you like to create one now? (yes/no): yes\nUsername (leave blank to use 'root'): admin\nEmail address: luchuanjia@msn.com\nPassword:*********\nPassword (again):*********\n\n./manage.py collectstatic #\u751f\u6210\u914d\u7f6e\u6587\u4ef6\n./manage.py createsuperuser #\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u62f7\u8d1d-web-\u5230-\u76f8\u5173\u76ee\u5f55",children:"\u62f7\u8d1d web \u5230 \u76f8\u5173\u76ee\u5f55"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd ..\nrm -rf /var/www\nmkdir -pv /var/www\ncp -Rv webvirtmgr /var/www/webvirtmgr\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u8bbe\u7f6e-ssh",children:"\u8bbe\u7f6e ssh"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ssh-keygen\nssh-copy-id 192.168.2.32\nssh 192.168.2.32 -L localhost:8000:localhost:8000 -L localhost:6080:localhost:6080\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u7f16\u8f91-nginx-\u914d\u7f6e\u6587\u4ef6",children:"\u7f16\u8f91 nginx \u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak\nvim /etc/nginx/conf.d/webvirtmgr.conf  #\u6dfb\u52a0\u4e0b\u9762\u5185\u5bb9\u5230\u6587\u4ef6\u4e2d\n\nserver {\n    listen 80 default_server;\n\n    server_name $hostname;\n    #access_log /var/log/nginx/webvirtmgr_access_log;\n\n    location /static/ {\n        root /var/www/webvirtmgr/webvirtmgr; # or /srv instead of /var\n        expires max;\n    }\n\n    location / {\n        proxy_pass http://127.0.0.1:8000;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-for $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host:$server_port;\n        proxy_set_header X-Forwarded-Proto $remote_addr;\n        proxy_connect_timeout 600;\n        proxy_read_timeout 600;\n        proxy_send_timeout 600;\n        client_max_body_size 1024M; # Set higher depending on your needs\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u542f\u52a8-nginx",children:"\u542f\u52a8 nginx"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"service nginx start\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u4fee\u6539\u9632\u706b\u5899\u89c4\u5219--\u5982\u679c\u5173\u95ed-selinux\u6b64\u6b65\u53ef\u7701\u7565",children:"\u4fee\u6539\u9632\u706b\u5899\u89c4\u5219 ( \u5982\u679c\u5173\u95ed selinux\uff0c\u6b64\u6b65\u53ef\u7701\u7565)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/usr/sbin/setsebool httpd_can_network_connect true\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u8bbe\u7f6e-supervisor",children:"\u8bbe\u7f6e supervisor"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'chown -R nginx:nginx /var/www/webvirtmgr\nvim /etc/supervisord.conf #\u5728\u6587\u4ef6\u672b\u5c3e\u6dfb\u52a0\n\n[program:webvirtmgr]\ncommand=/usr/bin/python /var/www/webvirtmgr/manage.py run_gunicorn -c /var/www/webvirtmgr/conf/gunicorn.conf.py\ndirectory=/var/www/webvirtmgr\nautostart=true\nautorestart=true\nlogfile=/var/log/supervisor/webvirtmgr.log\nlog_stderr=true\nuser=nginx\n\n[program:webvirtmgr-console]\ncommand=/usr/bin/python /var/www/webvirtmgr/console/webvirtmgr-console\ndirectory=/var/www/webvirtmgr\nautostart=true\nautorestart=true\nstdout_logfile=/var/log/supervisor/webvirtmgr-console.log\nredirect_stderr=true\nuser=nginx\n\n\u4fee\u6539/var/www/webvirtmgr/conf/gunicorn.conf.py\nbind = "0:8000"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"\u8bbe\u7f6e\u5f00\u673a\u542f\u52a8",children:"\u8bbe\u7f6e\u5f00\u673a\u542f\u52a8"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"chkconfig supervisord on\nchkconfig nginx on\nvim /etc/rc.local\n      /usr/sbin/setsebool httpd_can_network_connect true\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u542f\u52a8\u8fdb\u7a0b",children:"\u542f\u52a8\u8fdb\u7a0b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"service nginx start\nservice supervisord start\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u8bbf\u95ee",children:"\u8bbf\u95ee"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"http://$server_ip/login/\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},4552:(e,n,r)=>{r.d(n,{I:()=>l,M:()=>i});var s=r(11504);const t={},a=s.createContext(t);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);